Search.setIndex({"docnames": ["distributed_training_and_pytorch/distributed_training/index", "distributed_training_and_pytorch/index", "distributed_training_and_pytorch/pytorch/ddp_under_the_hood", "distributed_training_and_pytorch/pytorch/device_mesh", "distributed_training_and_pytorch/pytorch/distributed_data_parallel", "distributed_training_and_pytorch/pytorch/dp_ddp", "distributed_training_and_pytorch/pytorch/fsdp", "distributed_training_and_pytorch/pytorch/index", "distributed_training_and_pytorch/pytorch/mixed_precision", "distributed_training_and_pytorch/pytorch/pipeline_parallelism", "distributed_training_and_pytorch/pytorch/state_dict", "distributed_training_and_pytorch/pytorch/tensor_parallelism", "index", "nlp/index", "nlp/rnn", "nlp/word2vec", "past_experiences/adas", "past_experiences/ecom", "past_experiences/index", "past_experiences/iot", "system_design/dns", "vision/image_segmentation", "vision/index"], "filenames": ["distributed_training_and_pytorch/distributed_training/index.md", "distributed_training_and_pytorch/index.md", "distributed_training_and_pytorch/pytorch/ddp_under_the_hood.md", "distributed_training_and_pytorch/pytorch/device_mesh.md", "distributed_training_and_pytorch/pytorch/distributed_data_parallel.md", "distributed_training_and_pytorch/pytorch/dp_ddp.md", "distributed_training_and_pytorch/pytorch/fsdp.md", "distributed_training_and_pytorch/pytorch/index.md", "distributed_training_and_pytorch/pytorch/mixed_precision.md", "distributed_training_and_pytorch/pytorch/pipeline_parallelism.md", "distributed_training_and_pytorch/pytorch/state_dict.md", "distributed_training_and_pytorch/pytorch/tensor_parallelism.md", "index.md", "nlp/index.md", "nlp/rnn.md", "nlp/word2vec.md", "past_experiences/adas.md", "past_experiences/ecom.md", "past_experiences/index.md", "past_experiences/iot.md", "system_design/dns.md", "vision/image_segmentation.rst", "vision/index.md"], "titles": ["Distributed Training", "Distributed Training and PyTorch", "DDP: Under the Hood", "Device Mesh", "Distributed Data Parallel", "DP vs DDP", "FSDP", "Pytorch", "Mixed Precision", "Pipeline Parallelism", "state_dict", "Tensor parallelism", "Home", "Natural Language Processing", "Recurrent Neural Networks", "Word2Vec", "ADAS", "Ecom", "Past Experiences", "Predictive Analytics in IoT", "Domain name system", "Image Segmentation", "Computer Vision"], "terms": {"read": [0, 20], "pytorch": [0, 2, 3, 4, 6, 8, 9, 10, 11], "trace": [0, 9], "what": [0, 15], "realli": 0, "happen": [0, 4, 11], "when": [0, 2, 3, 5, 6, 8, 15, 20], "you": [0, 2, 4, 8, 9, 20], "call": [0, 4, 8, 11, 20], "forward": [0, 2, 3, 4, 6, 8, 9, 11, 20], "backward": [0, 2, 4, 6, 8, 9, 11], "step": [0, 2, 4, 6, 8, 14, 15], "us": [0, 2, 5, 6, 8, 10, 11, 14, 20], "profil": 0, "w": [0, 4, 14, 15], "b": 0, "i": [0, 2, 5, 6, 10, 11, 14, 15, 19], "techniqu": [0, 4, 9, 11, 15], "trade": 0, "comput": [0, 2, 6, 8, 11, 14, 15, 20], "memori": [0, 4, 6, 8, 11], "instead": [0, 4, 15], "keep": [0, 4, 6, 11], "tensor": [0, 2, 4, 8, 9, 10], "need": [0, 3, 4, 6, 8, 9, 11, 15, 20], "aliv": 0, "until": [0, 2], "thei": [0, 2, 4, 8, 10, 15, 20], "ar": [0, 2, 4, 6, 8, 9, 10, 11, 15, 20], "gradient": [0, 2, 4, 6, 9, 11, 14], "dure": [0, 4, 6, 11], "region": [0, 4, 8, 20], "omit": 0, "save": [0, 6, 10, 11, 14], "recomput": [0, 4], "them": [0, 2, 8, 11, 20], "pass": [0, 2, 4, 6, 8, 9, 11], "can": [0, 2, 3, 4, 6, 9, 10, 11, 15, 20], "appli": [0, 2, 3, 4, 8], "ani": [0, 2, 3, 4, 8, 14, 15, 20], "part": [0, 9, 20], "model": [0, 2, 3, 5, 6, 8, 10], "make": [0, 4, 6, 8, 11, 15, 19, 20], "code": [0, 2, 3, 11, 20], "run": [0, 2, 3, 6, 8, 9, 11, 14, 20], "faster": [0, 8, 20], "jit": 0, "optim": [0, 2, 4, 6, 8, 10, 11], "kernel": 0, "all": [0, 2, 4, 5, 6, 8, 11, 14, 15, 19, 20], "while": [0, 5, 6, 8, 9, 15], "requir": [0, 2, 3, 4, 8, 9, 11, 20], "minim": 0, "chang": [0, 2, 8, 9, 11, 15, 20], "arbitrari": [0, 15], "python": [0, 4, 10], "function": [0, 4, 9, 11, 15, 20], "callabl": 0, "we": [0, 2, 3, 4, 6, 9, 11, 14, 15], "return": [0, 3, 4, 8, 9, 11, 14, 20], "place": [0, 2, 4, 8], "origin": [0, 9, 11, 20], "opt_func": 0, "func": 0, "decor": 0, "nn": [0, 3, 4, 8, 9, 10, 11, 14], "modul": [0, 3, 4, 9, 10, 11], "instanc": [0, 4, 6, 8, 9, 20], "thi": [0, 2, 4, 5, 6, 8, 9, 11, 14, 15, 19, 20], "compiled_model": 0, "hold": 0, "refer": [0, 4], "more": [0, 2, 4, 6, 11, 15, 20], "version": [0, 2, 6, 19, 20], "three": [0, 2, 4, 11, 20], "acquisit": 0, "lower": [0, 4, 8, 20], "imag": [0, 3, 4], "sourc": [0, 2, 4, 11, 20], "2": [0, 2, 3, 4, 8, 11, 14, 15, 20], "x": [0, 3, 4, 9, 11, 14, 15], "AND": 0, "AS": 0, "dynam": [0, 8, 20], "ever": 0, "take": [0, 4, 8, 9, 11, 15], "lot": [0, 8], "longer": [0, 20], "complet": [0, 8], "compar": [0, 11], "eager": 0, "becaus": [0, 4, 8, 9, 10, 20], "execut": [0, 2, 8], "If": [0, 2, 4, 8, 9, 15, 20], "structur": [0, 9, 20], "doesn": 0, "t": [0, 8, 14, 15], "so": [0, 2, 4, 6, 8, 9, 11, 15, 20], "recompil": 0, "sever": [0, 15], "time": [0, 4, 5, 8, 14, 15], "signific": [0, 8], "improv": [0, 4, 6, 8, 11, 15], "speedup": 0, "mainli": [0, 4], "come": [0, 2, 4, 6, 9, 11], "from": [0, 2, 3, 4, 6, 8, 9, 11, 14, 15, 20], "reduc": [0, 2, 4, 6, 8, 11, 15], "overhead": [0, 4, 5, 6, 11], "write": [0, 2, 4, 9, 15], "observ": [0, 8, 15], "mai": [0, 8, 11], "vari": 0, "factor": [0, 8, 15, 20], "architectur": [0, 8, 20], "batch": [0, 2, 4, 6, 8, 9, 11], "size": [0, 2, 4, 6, 8, 11, 14, 15], "For": [0, 2, 3, 4, 11, 14, 15, 20], "exampl": [0, 2, 3, 4, 8, 9, 11, 20], "": [0, 2, 3, 4, 6, 8, 10, 11, 15, 20], "simpl": [0, 2, 3, 4, 9, 15, 20], "amount": [0, 11, 20], "larg": [0, 2, 6, 8, 9, 11], "bottleneck": [0, 11], "would": [0, 3, 5, 8, 9, 11, 15], "less": 0, "The": [0, 2, 3, 4, 6, 8, 9, 11, 15, 19, 20], "mode": [0, 4], "cuda": [0, 2, 3, 4, 11], "further": [0, 6, 11, 15], "second": [0, 9, 20], "significantli": [0, 11, 15], "slower": [0, 5, 9], "than": [0, 5, 6, 15, 20], "other": [0, 2, 3, 4, 8, 9, 15, 20], "although": 0, "much": [0, 8, 15, 20], "first": [0, 2, 8, 9, 11, 15, 20], "few": [0, 4, 8], "warm": 0, "up": [0, 3, 6, 8, 9, 11, 20], "iter": [0, 4, 5, 8, 14, 15, 20], "respons": [0, 9, 11, 20], "which": [0, 3, 4, 6, 8, 9, 10, 11, 14, 15, 19, 20], "extract": 0, "analyz": [0, 4], "bytecod": 0, "runtim": [0, 9, 11], "detect": 0, "oper": [0, 2, 4, 6, 8, 9, 11], "torchinductor": 0, "anoth": [0, 9, 20], "compon": [0, 14], "allow": [0, 2, 3, 4, 6, 8, 9, 11, 20], "differ": [0, 2, 3, 4, 6, 8, 9, 15, 20], "backend": [0, 4], "encount": 0, "unsupport": 0, "featur": [0, 9], "depend": [0, 9, 11], "control": [0, 2, 4], "flow": [0, 8, 9], "break": [0, 4], "let": [0, 2, 3, 4, 11, 15, 20], "default": [0, 2, 4, 11, 20], "interpret": 0, "handl": [0, 9], "resum": [0, 4], "captur": [0, 9], "highlight": 0, "major": 0, "between": [0, 4, 9, 15, 20], "previou": [0, 14, 20], "solut": [0, 3], "either": [0, 4, 20], "rais": [0, 11, 14], "an": [0, 2, 3, 6, 8, 9, 11, 14, 20], "error": 0, "silent": 0, "fail": [0, 8], "hand": 0, "some": [0, 4, 6, 20], "To": [0, 2, 3, 4, 6, 8, 9, 11, 15], "your": [0, 2, 3, 4, 8, 19], "pronounc": 0, "nickel": 0, "stand": [0, 9], "alon": [0, 11], "librari": [0, 4, 15], "standard": [0, 2], "commun": [0, 3, 6, 9, 11, 20], "routin": 0, "implement": [0, 2, 6, 8, 11, 14, 15, 20], "gather": [0, 2, 5, 6, 11], "broadcast": [0, 2, 4], "scatter": [0, 2, 5, 6], "well": [0, 10], "send": [0, 2, 4, 8, 9, 20], "receiv": [0, 2, 20], "base": [0, 4, 9, 15, 20], "pattern": [0, 2, 11], "It": [0, 2, 3, 4, 9, 11, 15, 20], "ha": [0, 2, 4, 6, 8, 11, 14, 20], "been": [0, 2, 8, 9], "achiev": [0, 2], "high": [0, 2, 6, 11, 14, 15], "bandwidth": [0, 9], "platform": 0, "pcie": 0, "nvlink": [0, 11], "nvswitch": 0, "network": [0, 4, 8, 20], "infiniband": 0, "verb": 0, "tcp": [0, 2, 20], "ip": [0, 2, 4, 20], "socket": 0, "support": [0, 2, 4, 6, 9, 20], "number": [0, 2, 11, 14, 15, 20], "instal": 0, "node": [0, 3], "across": [0, 2, 3, 4, 5, 6, 9, 11, 14], "multi": [0, 3, 4, 5, 11], "process": [0, 2, 3, 4, 5, 6, 14, 15, 20], "e": [0, 3, 8, 9, 10, 11, 20], "g": [0, 8, 9, 20], "applic": [0, 2, 4, 15], "collect": [0, 4, 5, 6, 8, 11], "algorithm": [0, 2, 11], "machin": [0, 2, 4, 5, 14, 15], "These": [0, 4, 8, 15, 20], "includ": [0, 2, 9, 11, 19, 20], "barrier": [0, 2, 4], "allreduc": [0, 4, 11], "messag": [0, 2], "interfac": [0, 2, 4], "portabl": 0, "api": [0, 2, 3, 4, 6, 11], "via": [0, 2, 3, 11], "both": [0, 3, 5, 8, 11, 15, 20], "point": [0, 4, 8, 9, 11], "frequent": 0, "hpc": 0, "build": [0, 2, 15], "scale": [0, 2, 6, 9, 11, 15], "cluster": [0, 2, 6, 9], "In": [0, 2, 4, 6, 8, 9, 10, 11, 14, 15, 20], "most": [0, 2, 15, 20], "directli": [0, 4, 9], "c": [0, 4, 15], "fortran": 0, "languag": [0, 11, 15], "abl": [0, 2], "doc": [2, 4, 8, 9, 11], "packag": [2, 4, 8, 9], "torch": [2, 3, 10, 11], "enabl": [2, 4, 8, 11, 15, 20], "research": 2, "practition": 2, "easili": [2, 3, 4, 10, 11], "parallel": [2, 3, 5, 6], "do": [2, 8, 9, 11, 15], "leverag": [2, 3, 11], "semant": 2, "each": [2, 3, 4, 5, 6, 8, 9, 10, 11, 14, 15, 20], "data": [2, 3, 5, 6, 8, 9, 11, 14, 15, 20], "As": [2, 11, 15], "oppos": 2, "multiprocess": [2, 4], "restrict": 2, "being": [2, 8, 11, 15], "same": [2, 4, 8, 11, 15, 20], "init_process": 2, "ensur": [2, 6], "everi": [2, 4, 11], "coordin": 2, "through": [2, 8, 9, 14, 20], "master": 2, "address": [2, 4, 15, 20], "port": 2, "def": [2, 3, 4, 8, 9, 11, 14], "rank": [2, 3, 4, 6, 9], "fn": 2, "gloo": [2, 4], "environ": [2, 4, 9, 11], "o": [2, 4, 15, 20], "master_addr": [2, 4], "127": 2, "0": [2, 4, 8, 9, 11, 14, 15, 20], "1": [2, 4, 6, 8, 11, 14, 15, 20], "master_port": 2, "29500": [2, 4], "dist": [2, 4, 8], "init_process_group": [2, 4], "world_siz": [2, 4], "__name__": [2, 4], "__main__": [2, 4], "mp": [2, 4], "set_start_method": 2, "spawn": [2, 4], "rang": [2, 4, 8, 14, 20], "p": [2, 14, 15], "target": [2, 4, 8, 15], "arg": [2, 4], "start": [2, 4, 15, 20], "append": [2, 8, 14], "join": [2, 4], "want": [2, 11, 15, 20], "fine": 2, "grain": 2, "over": [2, 6, 8, 9, 11, 14], "our": [2, 6, 9, 15], "fanci": 2, "one": [2, 4, 9, 11, 14, 15, 20], "baidu": 2, "deepspeech": 2, "facebook": 2, "experi": [2, 6], "zero": [2, 8, 14, 15], "dst": 2, "block": [2, 4, 11, 20], "req": 2, "isend": 2, "non": [2, 15, 20], "els": [2, 8, 9], "recv": [2, 9], "src": 2, "irecv": 2, "wait": [2, 4], "after": [2, 4, 6, 8, 9, 11], "guarante": 2, "took": 2, "print": [2, 4, 8, 9], "communc": 2, "group": [2, 3, 4, 9], "A": [2, 4, 8, 9, 10, 20], "subset": 2, "creat": [2, 3, 4, 8, 9, 11, 20], "list": 2, "new_group": 2, "By": [2, 11], "also": [2, 3, 4, 8, 9, 10, 11, 15], "known": [2, 11], "world": [2, 4, 11, 20], "order": [2, 4, 15], "obtain": [2, 20], "sum": [2, 4, 6, 8, 14, 15], "all_reduc": 2, "op": [2, 4, 9], "4": [2, 3, 4, 9], "work": [2, 3, 5, 8, 20], "element": 2, "wise": [2, 11], "level": [2, 3, 4, 6, 9, 11, 14, 15, 20], "reduceop": 2, "product": 2, "max": [2, 8, 14], "min": 2, "ones": [2, 15], "There": [2, 15, 20], "total": [2, 4, 8, 15], "6": 2, "current": [2, 14, 15, 20], "copi": [2, 6, 14, 20], "store": [2, 15, 20], "result": [2, 8, 11, 20], "scatter_list": 2, "ith": 2, "gather_list": 2, "all_gath": [2, 6], "tensor_list": 2, "enter": [2, 20], "stochast": 2, "descent": [2, 14], "script": [2, 8], "averag": [2, 4], "split": [2, 20], "dataset": [2, 4, 15], "similar": [2, 11, 15], "converg": [2, 8, 11], "have": [2, 4, 8, 9, 10, 11, 15, 20], "partit": [2, 9], "assum": 2, "n": [2, 4, 8, 15], "replica": [2, 4, 6], "num_train_sampl": 2, "sampl": [2, 14], "divid": [2, 9, 20], "maintain": [2, 6, 8, 20], "overal": [2, 9], "given": [2, 4, 8, 9, 15, 20], "synchron": [2, 4, 8], "sgd": [2, 4, 8, 14, 15], "manual_se": 2, "1234": 2, "train_set": [2, 4], "bsz": 2, "partition_dataset": 2, "net": [2, 8, 20], "paramet": [2, 4, 6, 8, 9, 10, 11, 14, 15], "lr": [2, 4, 8], "01": 2, "momentum": 2, "5": [2, 3, 4, 9, 14], "num_batch": [2, 8], "ceil": 2, "len": [2, 4, 14], "float": [2, 8, 11], "epoch": [2, 4, 8, 14, 15], "10": [2, 3, 4, 14], "epoch_loss": 2, "zero_grad": [2, 4, 8], "output": [2, 4, 5, 8, 9, 11, 14], "loss": [2, 4, 15], "f": [2, 4, 11], "nll_loss": [2, 8], "item": [2, 8], "average_gradi": 2, "get_rank": [2, 4], "get_world_s": 2, "param": [2, 4], "grad": [2, 4, 8, 14], "One": [2, 4, 6, 11, 15], "eleg": 2, "aspect": [2, 9], "its": [2, 3, 4, 6, 8, 9, 10, 11, 20], "abil": [2, 11], "abstract": [2, 3, 4, 11], "top": [2, 11, 15, 19, 20], "mention": [2, 11], "befor": [2, 3, 4, 8, 9, 11], "nccl": [2, 3, 4, 11], "mpi": 2, "cpu": [2, 4, 6, 8], "gpu": [2, 4, 6, 8, 11], "provid": [2, 4, 8, 9, 11, 20], "tool": [2, 4, 9], "field": [2, 4], "perform": [2, 3, 4, 6, 8, 11, 20], "wa": [2, 11, 15], "main": [2, 4], "inspir": 2, "advantag": [2, 4], "li": 2, "wide": [2, 19], "avail": 2, "against": 2, "onli": [2, 4, 5, 6, 8, 9, 11, 14, 15, 20], "consid": [2, 9, 20], "best": [2, 20], "class": [2, 3, 4, 9, 14], "pre": [2, 11], "built": [2, 4], "binari": 2, "variabl": [2, 14, 20], "set": [2, 3, 11, 14, 15, 19, 20], "follow": [2, 3, 6, 8, 9, 11, 14, 15, 20], "four": 2, "properli": [2, 4], "connect": [2, 3, 11, 20], "inform": [2, 10, 15, 20], "about": [2, 3, 10, 20], "final": [2, 6, 11], "handshak": 2, "free": 2, "host": [2, 3, 4, 9, 11, 20], "know": [2, 9, 20], "how": [2, 15], "mani": [2, 8, 11], "worker": [2, 4, 6], "whether": 2, "share": [2, 4], "file": [2, 4, 19, 20], "system": [2, 15], "filesystem": 2, "access": [2, 3, 9, 10], "mean": [2, 4, 8, 11, 14, 15], "open": [2, 20], "everybodi": 2, "did": 2, "readili": 2, "reachabl": 2, "here": [2, 4, 8, 11, 15], "exchang": 2, "reach": [2, 6, 20], "higher": 3, "manag": [3, 4, 8, 9, 11, 20], "processgroup": [3, 11], "user": [3, 4, 9, 11, 20], "effortlessli": 3, "inter": [3, 4, 11], "intra": [3, 4, 11], "without": [3, 8, 11, 14, 15, 20], "worri": 3, "correctli": [3, 9], "sub": [3, 11], "underli": 3, "process_group": 3, "dimension": [3, 11, 15], "3": [3, 4, 8], "d": [3, 4, 11, 15], "where": [3, 4, 8, 9, 11, 15], "compos": [3, 9], "within": [3, 11, 14, 15, 20], "abov": [3, 4, 11, 15], "show": [3, 4, 8, 14, 20], "2d": 3, "counterpart": 3, "homogen": 3, "setup": [3, 4, 15], "manual": [3, 8], "could": [3, 6, 11, 15], "quit": 3, "complic": 3, "With": [3, 6, 11, 15, 20], "help": [3, 4, 8], "init_device_mesh": [3, 11], "accomplish": 3, "just": [3, 4, 6, 11], "two": [3, 4, 9, 15, 20], "line": 3, "still": 3, "distribut": [3, 8, 11, 15, 20], "device_mesh": [3, 11], "import": [3, 4, 8, 9, 11, 15, 19, 20], "mesh_2d": [3, 11], "mesh_dim_nam": 3, "replic": [3, 4, 5, 6, 11], "shard": [3, 4, 6, 11], "thru": 3, "get_group": 3, "replicate_group": 3, "mesh_dim": 3, "shard_group": 3, "snippet": 3, "elast": [3, 4, 20], "torchrun": 3, "nproc_per_nod": [3, 4], "8": [3, 4, 8, 11], "2d_setup_with_device_mesh": 3, "py": [3, 4, 19], "hybrid": 3, "strategi": [3, 4], "fsdp": [3, 4, 9], "ddp": [3, 9, 11], "see": [3, 4, 8, 9, 15], "assist": 3, "toymodel": [3, 4], "__init__": [3, 4, 14], "self": [3, 4, 9, 11, 14], "super": [3, 4], "net1": [3, 4], "linear": [3, 4, 8, 10, 11], "relu": [3, 4, 8, 14], "net2": [3, 4], "meshshap": 3, "sharding_strategi": 3, "shardingstrategi": 3, "hybrid_shard": 3, "Then": [3, 4, 6, 9], "command": [3, 4], "tutori": [4, 11], "should": [4, 8, 15], "singl": [4, 5, 6, 9, 11, 14, 20], "per": [4, 5, 6, 9], "buffer": [4, 9, 10], "specif": [4, 6, 9, 11, 15, 20], "regist": [4, 10, 11, 20], "autograd": [4, 8], "fire": 4, "correspond": [4, 6, 8, 15, 20], "signal": 4, "trigger": 4, "pleas": 4, "design": 4, "note": [4, 15, 20], "detail": 4, "recommend": [4, 8], "wai": [4, 6, 11, 15, 20], "span": 4, "devic": [4, 6, 8, 9, 11], "cannot": [4, 20], "wrap": [4, 6, 9], "clean": 4, "were": 4, "local": [4, 11, 20], "alreadi": [4, 11], "contain": [4, 8, 10, 20], "basic": [4, 11], "case": [4, 8, 15], "loc": 4, "advanc": 4, "caveat": 4, "caution": 4, "construct": [4, 8, 9], "ddp_model": 4, "device_id": 4, "defin": [4, 9, 15, 20], "loss_fn": [4, 8], "mseloss": [4, 8], "001": [4, 8], "randn": [4, 8, 9], "20": 4, "label": [4, 14, 20], "updat": [4, 6, 8, 10, 14, 15, 20], "nproc": 4, "true": [4, 8, 11, 14, 15], "wrapper": 4, "compil": 4, "graph": [4, 9], "bucket": [4, 20], "reli": 4, "c10d": 4, "henc": 4, "must": [4, 8, 9, 20], "constructor": [4, 6, 8], "state_dict": 4, "sure": [4, 8, 11], "exact": 4, "state": [4, 6, 10, 14], "later": [4, 9], "care": 4, "effici": [4, 6, 11], "organ": 4, "bucket_cap_mb": 4, "argument": [4, 8, 9], "map": [4, 10, 20], "determin": [4, 9, 11, 20], "limit": [4, 9, 11, 14, 20], "alloc": [4, 9], "roughli": 4, "revers": [4, 14], "reason": 4, "expect": [4, 8, 15, 20], "becom": [4, 11], "readi": 4, "approxim": 4, "besid": 4, "input": [4, 5, 9, 11, 14], "find_unused_paramet": 4, "subgraph": 4, "find": [4, 20], "out": [4, 11], "involv": [4, 14, 15], "travers": 4, "mark": [4, 11], "unus": 4, "reduct": [4, 8], "invok": [4, 8], "accumul": [4, 14], "kick": 4, "off": 4, "asynchron": 4, "calcul": [4, 14, 15], "finish": 4, "done": [4, 9, 11, 19], "written": 4, "perspect": 4, "sync": [4, 6], "hpp": 4, "box": 4, "name": [4, 11], "processgroupgloo": 4, "processgroupnccl": 4, "processgroupmpi": 4, "entri": [4, 10, 20], "Its": [4, 6], "_sync_param": 4, "cpp": 4, "comm": 4, "h": [4, 11], "coalesc": [4, 8], "helper": [4, 9], "core": [4, 8, 11], "autograd_hook": 4, "engin": 4, "prepare_for_backward": 4, "end": [4, 8, 9, 11, 14, 15, 20], "aotautograd": 4, "prevent": [4, 8, 20], "whole": [4, 9], "logic": 4, "boundari": 4, "goal": 4, "simplest": [4, 15], "section": [4, 15], "schedul": 4, "common": 4, "recov": [4, 6, 8], "correct": 4, "valu": [4, 8, 15, 19, 20], "demo_checkpoint": 4, "checkpoint_path": 4, "tempfil": 4, "gettempdir": 4, "random": [4, 14, 15, 20], "therefor": [4, 8], "suffici": 4, "map_loc": 4, "load_state_dict": 4, "Not": 4, "necessari": [4, 11], "guard": 4, "delet": [4, 9], "below": [4, 8, 11, 20], "serv": [4, 8, 20], "remov": 4, "cleanup": 4, "output_devic": 4, "NOT": 4, "proper": [4, 11], "method": [4, 8, 9, 14, 15, 20], "toympmodel": 4, "dev0": 4, "dev1": 4, "demo_model_parallel": 4, "mp_model": 4, "ddp_mp_model": 4, "n_gpu": 4, "device_count": 4, "assert": [4, 8, 9], "least": [4, 15], "got": 4, "run_demo": 4, "demo_bas": 4, "gener": [4, 9, 11, 15, 20], "overrid": 4, "vanilla": 4, "loop": [4, 9], "register_comm_hook": 4, "flexibl": 4, "increas": [4, 6, 8, 11], "move": 4, "id": 4, "destroy_process_group": 4, "nnode": 4, "rdzv_id": 4, "100": 4, "rdzv_backend": 4, "rdzv_endpoint": 4, "29400": 4, "elastic_ddp": 4, "aka": [4, 19], "16": 4, "like": [4, 6, 8, 9, 11, 15, 20], "actual": [4, 15, 20], "export": [4, 9], "scontrol": 4, "hostnam": 4, "slurm_nodelist": 4, "head": [4, 11], "srun": 4, "torchrun_script": 4, "sh": 4, "typic": [4, 9, 11, 20], "footprint": [4, 6], "consist": [4, 9, 11, 20], "weight": [4, 6, 9, 10, 14, 20], "activ": [4, 6, 11, 20], "sinc": [4, 8, 11, 15], "capac": 4, "accomod": 4, "full": [4, 6, 8, 9], "grow": [4, 20], "larger": [4, 6, 8, 11, 15], "aggress": 4, "might": [4, 20], "intermedi": [4, 9, 14], "approach": 4, "fulli": [4, 6, 11], "multinod": 4, "util": [4, 8, 9, 11, 20], "dataload": 4, "datautil": 4, "mytraindataset": 4, "distributedsampl": 4, "ddp_setup": 4, "set_devic": 4, "int": [4, 14], "local_rank": 4, "trainer": 4, "train_data": 4, "save_everi": 4, "snapshot_path": 4, "str": 4, "none": [4, 8, 9, 14], "global_rank": 4, "epochs_run": 4, "path": [4, 6], "exist": 4, "snapshot": 4, "_load_snapshot": 4, "model_st": 4, "_run_batch": 4, "cross_entropi": [4, 8], "_run_epoch": 4, "b_sz": 4, "next": [4, 6, 8, 11, 15], "batchsiz": 4, "sampler": 4, "set_epoch": 4, "_save_snapshot": 4, "max_epoch": 4, "load_train_obj": 4, "2048": 4, "1e": [4, 14], "prepare_dataload": 4, "batch_siz": [4, 8, 9, 11, 14], "pin_memori": 4, "shuffl": 4, "fals": [4, 8, 11, 14], "total_epoch": 4, "pt": 4, "argpars": 4, "parser": 4, "argumentpars": 4, "descript": 4, "add_argu": 4, "type": [4, 6, 11], "often": [4, 8, 9, 11, 20], "32": 4, "parse_arg": 4, "u": [4, 11, 14, 15, 20], "east": 4, "ubuntu1804": 4, "sharedstorag": 4, "mountdir": 4, "storagetyp": 4, "fsxlustr": 4, "fsxlustreset": 4, "storagecapac": 4, "1200": 4, "deploymenttyp": 4, "scratch_1": 4, "ssd": 4, "headnod": 4, "instancetyp": 4, "c5": 4, "xlarg": 4, "subnetid": 4, "subnet": [4, 20], "xxxxxxx": 4, "ssh": 4, "keynam": 4, "slurmqueu": 4, "computeresourc": 4, "p32xlarg": 4, "p3": 4, "2xlarg": 4, "mincount": 4, "maxcount": 4, "bin": 4, "bash": 4, "sbatch": 4, "ntask": 4, "task": [4, 8], "slurm_job_nodelist": 4, "nodes_arrai": 4, "head_nod": 4, "head_node_ip": 4, "echo": 4, "loglevel": 4, "info": [4, 15, 20], "multinode_torchrun": 4, "50": [4, 8], "real": 4, "mingpt": 4, "1t": [4, 6], "dataparallel": 5, "thread": 5, "distributeddataparallel": [5, 6], "train": [5, 6, 9, 11, 15], "usual": [5, 6, 8, 11, 20], "even": [5, 11, 15], "due": [5, 11], "gil": 5, "content": [5, 20], "addit": [5, 6, 9, 11, 20], "introduc": [5, 6, 15], "doe": [5, 8, 15], "combin": [5, 6, 8, 11, 15], "mar": 6, "2022": 6, "11": 6, "re": 6, "ad": [6, 9, 10, 15, 19, 20], "nativ": [6, 11], "heavili": 6, "borrow": 6, "fairscal": 6, "bring": [6, 20], "streamlin": 6, "realiz": 6, "84": 6, "tflop": 6, "a100": 6, "gpt": [6, 9], "159": 6, "175b": 6, "aw": 6, "unlik": 6, "tradit": 6, "option": [6, 8, 20], "offload": 6, "layer": [6, 8, 9, 10], "nest": 6, "freed": 6, "immedi": [6, 8], "peak": 6, "thu": 6, "maxim": 6, "own": [6, 20], "smaller": [6, 11, 15], "veri": [6, 11, 15], "feasibl": 6, "fit": 6, "cost": [6, 11], "volum": 6, "intern": [6, 20], "overlap": 6, "At": [6, 11, 14, 15], "unit": [6, 14], "discard": [6, 20], "reduce_scatt": [6, 11], "view": 6, "decompos": 6, "possess": 6, "subsequ": 6, "conveni": 8, "datatyp": 8, "lower_precision_fp": 8, "half": 8, "bfloat16": 8, "tri": [8, 20], "match": 8, "appropri": [8, 14], "convolut": [8, 10], "primarili": 8, "benefit": 8, "volta": 8, "ture": 8, "amper": 8, "recip": 8, "3x": 8, "those": [8, 9, 11, 15], "On": 8, "earlier": [8, 15], "kepler": 8, "maxwel": 8, "pascal": 8, "modest": 8, "greatest": 8, "satur": 8, "small": [8, 15], "bound": 8, "won": 8, "chosen": 8, "particip": 8, "dimens": [8, 11, 14, 15], "multipl": [8, 9, 11, 14, 15, 20], "permit": 8, "usag": 8, "capabl": [8, 11], "in_siz": 8, "out_siz": 8, "num_lay": 8, "enough": 8, "particular": [8, 15], "produc": 8, "magnitud": 8, "represent": [8, 15], "flush": 8, "underflow": 8, "lost": 8, "multipli": [8, 15], "word": 8, "don": 8, "attribut": 8, "unscal": 8, "interfer": 8, "learn": [8, 9, 14, 20], "rate": [8, 15], "matmul": [8, 11, 14], "addbmm": 8, "bmm": 8, "chain_matmul": 8, "multi_dot": 8, "conv1d": 8, "conv2d": 8, "conv3d": 8, "grucel": 8, "lstmcell": 8, "mm": 8, "mv": 8, "prelu": 8, "rnncell": 8, "binary_cross_entropy_with_logit": 8, "cosine_similar": 8, "cumsum": 8, "l1_loss": 8, "layer_norm": 8, "log": [8, 14, 15], "log_softmax": 8, "mse_loss": 8, "norm": [8, 9, 11], "normal": 8, "pow": 8, "prod": [8, 14], "soft_margin_loss": 8, "softmax": 8, "softmin": 8, "softplu": 8, "dtype": 8, "stabil": 8, "cast": 8, "addcdiv": 8, "addcmul": 8, "bilinear": 8, "cross": [8, 9, 11, 15], "dot": [8, 20], "grid_sampl": 8, "scatter_add": 8, "tensordot": 8, "gc": 8, "start_tim": 8, "measur": 8, "report": 8, "wherea": [8, 15], "yet": [8, 9], "pick": 8, "avoid": [8, 11, 15, 20], "synchronis": 8, "global": [8, 11, 20], "empty_cach": 8, "reset_max_memory_alloc": 8, "end_timer_and_print": 8, "local_msg": 8, "end_tim": 8, "3f": 8, "sec": 8, "format": 8, "byte": 8, "max_memory_alloc": 8, "make_model": 8, "_": 8, "sequenti": 8, "tupl": 8, "512": [8, 14], "try": 8, "128": [8, 11], "256": [8, 11, 20], "513": 8, "4096": 8, "is_avail": 8, "set_default_devic": 8, "trial": 8, "opt": 8, "zip": 8, "set_to_non": 8, "modestli": 8, "context": 8, "accuraci": [8, 14, 20], "under": [8, 11], "device_typ": 8, "exit": 8, "chose": 8, "scaler": 8, "onc": 8, "begin": [8, 9, 15], "entir": [8, 9, 14], "dedic": 8, "fresh": 8, "lightweight": 8, "assign": [8, 9, 15, 20], "otherwis": 8, "skip": 8, "demonstr": 8, "use_amp": 8, "clip": [8, 14], "unscale_": 8, "now": [8, 9, 11, 15], "max_norm": 8, "clip_grad_norm_": 8, "add": [8, 14, 19, 20], "effect": [8, 9, 11], "batch_per_it": 8, "iters_to_accumul": 8, "num_proc": 8, "calibr": 8, "check": 8, "found": 8, "occur": [8, 15], "granular": 8, "remain": 8, "constant": 8, "imposs": 8, "enumer": [8, 11], "desir": [8, 15], "commonli": 8, "matter": 8, "rough": 8, "rule": 8, "thumb": 8, "oom": 8, "excess": [8, 11], "sequenc": [8, 15], "friendli": 8, "disabl": 8, "individu": [8, 11, 15, 20], "persist": 8, "introduct": 9, "primit": [9, 11], "deep": 9, "micro": 9, "concurr": [9, 11], "infer": 9, "promis": 9, "difficult": 9, "intrus": 9, "complex": 9, "toolkit": 9, "said": [9, 20], "thing": [9, 15], "easi": [9, 11], "frontend": 9, "relationship": [9, 15], "stage": 9, "propag": [9, 14], "etc": [9, 10, 11, 15, 20], "rich": 9, "gpipe": 9, "1f1b": 9, "interleav": 9, "bf": 9, "infrastrutur": 9, "custom": [9, 20], "pp": 9, "interconnect": 9, "object": [9, 10, 14, 15, 20], "peer": 9, "consum": 9, "shape": [9, 11, 14], "static": [9, 20], "attach": [9, 14], "schedulegpip": 9, "n_microbatch": 9, "in_dim": 9, "microbatch": 9, "relev": 9, "meta": 9, "num_stag": 9, "practic": [9, 11, 15], "transform": [9, 11], "stage_index": 9, "prepar": 9, "del": 9, "elif": 9, "tok_embed": [9, 11], "input_arg": 9, "example_input_microbatch": 9, "repres": [9, 11, 15, 20], "worth": 9, "splitpoint": 9, "longtensor": 9, "pipe": 9, "mod": 9, "mb_arg": 9, "split_spec": 9, "certain": [9, 11], "submodul": 9, "similarli": 9, "graphmodul": 9, "submod_0": 9, "emb": 9, "interpretermodul": 9, "lin": 9, "submod_1": 9, "lm": [9, 11], "proj": 9, "reconstruct": 9, "hierarchi": [9, 20], "root": [9, 20], "Such": 9, "replai": 9, "fashion": [9, 11], "turn": 9, "direct": [9, 20], "acycl": 9, "dag": 9, "togeth": [9, 11, 15, 20], "convent": 9, "children": 9, "cut": 9, "extend": [9, 20], "pipelineschedulesingl": 9, "pipelineschedulemulti": 9, "style": [9, 11], "learnabl": 10, "bias": 10, "simpli": [10, 11, 15, 20], "dictionari": 10, "alter": 10, "restor": 10, "great": 10, "deal": 10, "modular": 10, "batchnorm": 10, "running_mean": 10, "hyperparamet": 10, "tp": 11, "propos": 11, "megatron": 11, "paper": 11, "sp": 11, "variant": [11, 15], "initi": [11, 14], "parallelstyl": 11, "parallelize_modul": 11, "swap": 11, "dtensor": 11, "foward": 11, "layout": 11, "specifi": [11, 15, 20], "allgath": 11, "embed": 11, "howev": 11, "term": [11, 15], "quantiti": 11, "challeng": 11, "aris": 11, "exceed": 11, "domin": 11, "ring": 11, "latenc": [11, 20], "consequ": 11, "decreas": 11, "hit": 11, "ballpark": 11, "continu": [11, 15], "yield": 11, "matrix": [11, 14], "flop": 11, "llm": [11, 15], "billion": 11, "trillion": 11, "token": 11, "month": 11, "thousand": 11, "alwai": 11, "llama": 11, "70b": 11, "2k": 11, "35": 11, "dai": 11, "quickli": 11, "constraint": 11, "1k": 11, "offer": 11, "configur": [11, 20], "colwiseparallel": 11, "rowwiseparallel": 11, "column": [11, 15], "row": 11, "sequenceparallel": 11, "dropout": 11, "rmsnormpython": 11, "preparemoduleinput": 11, "preparemoduleoutput": 11, "program": 11, "spmd": 11, "hood": 11, "devicemesh": 11, "transformerblock": 11, "look": 11, "simpler": 11, "swiglu": 11, "mlp": 11, "w2": 11, "silu": 11, "w1": 11, "w3": 11, "project": 11, "idea": [11, 15], "colwis": 11, "rowwis": 11, "parallelize_plan": 11, "layer_tp_plan": 11, "feed_foward": 11, "feed_forward": 11, "wq": 11, "wk": 11, "wv": 11, "q": 11, "k": [11, 15], "v": [11, 15], "wo": 11, "intend": 11, "plan": 11, "insid": 11, "hook": 11, "respect": [11, 15], "layer_id": 11, "transformer_block": 11, "adjust": 11, "attn_lay": 11, "n_head": 11, "tp_mesh": 11, "n_kv_head": 11, "illustr": 11, "feed": [11, 20], "residu": 11, "attention_norm": 11, "ffn_norm": 11, "input_layout": 11, "desired_input_layout": 11, "output_layout": 11, "relat": [11, 20], "huge": [11, 15], "vocabulari": [11, 15], "entropi": [11, 15], "consumpt": 11, "speed": 11, "pictur": 11, "briefli": 11, "predict": [11, 15], "length": [11, 15, 20], "last": 11, "use_local_output": 11, "incur": 11, "fast": 11, "channel": 11, "express": [11, 15], "fullyshardeddataparallel": 11, "mesh": 11, "dp": 11, "64": 11, "submesh": 11, "dp_mesh": 11, "tp_plan": 11, "model_tp": 11, "model_2d": 11, "use_orig_param": 11, "separ": [11, 20], "articl": [14, 15], "go": 14, "scratch": [14, 15], "numpi": 14, "y": [14, 15], "y_pred": 14, "notimpl": 14, "crossentropyloss": 14, "np": 14, "15": 14, "y_true": 14, "argmax": 14, "axi": 14, "grad_w": 14, "learning_r": 14, "neuralnetwork": 14, "loss_funct": 14, "metric": 14, "valid": 14, "set_input_shap": 14, "output_shap": 14, "hasattr": 14, "n_epoch": 14, "x_val": 14, "y_val": 14, "print_once_every_epoch": 14, "fix": [14, 15], "minibatch": 14, "x_batch": 14, "y_batch": 14, "batch_iter": 14, "acc": 14, "train_on_batch": 14, "get": [14, 20], "val": 14, "val_loss": 14, "val_acc": 14, "test_on_batch": 14, "_forward_pass": 14, "wrt": 14, "grad_loss": 14, "back": 14, "_backward_pass": 14, "layer_output": 14, "forward_pass": 14, "backward_pass": 14, "pic": 14, "page4": 14, "equat": [14, 15], "backpropag": 14, "dim_input": 14, "dim_hidden": 14, "hidden": 14, "bptt_trunc": 14, "input_shap": 14, "w_hh": 14, "w_xh": 14, "w_ho": 14, "matric": [14, 15], "math": 14, "sqrt": 14, "uniform": 14, "w_xh_opt": 14, "w_hh_opt": 14, "w_ho_opt": 14, "num_paramet": 14, "gif": 14, "page6": 14, "num_timestep": 14, "layer_input": 14, "backprop": 14, "state_act_input": 14, "state_act_output": 14, "page7": 14, "dim_output": 14, "grad_inp": 14, "zeros_lik": 14, "grad_wxh": 14, "grad_whh": 14, "grad_who": 14, "timestep": 14, "grad_state_act_output": 14, "grad_state_act_input": 14, "bptt": 14, "num_timestamp": 14, "tt": 14, "arang": 14, "__call__": 14, "exp": [14, 15], "e_x": 14, "keepdim": 14, "definit": [14, 15, 20], "clf": 14, "adam": 14, "61": 14, "training_loss_acc": 14, "validation_loss_acc": 14, "x_train": 14, "y_train": 14, "300": 14, "x_test": 14, "y_test": 14, "y_test1": 14, "accuracy_scor": 14, "plot": 14, "train_loss": 14, "plt": 14, "titl": 14, "ylabel": 14, "xlabel": 14, "legend": 14, "framework": [14, 15], "give": [14, 15, 20], "better": [14, 15], "insight": [14, 15], "probabilist": [14, 15], "fundament": [15, 20], "problem": 15, "natur": 15, "question": 15, "vital": 15, "translat": [15, 20], "answer": [15, 20], "retriev": 15, "summar": 15, "analysi": 15, "text": 15, "speech": 15, "independ": 15, "drawback": 15, "equal": 15, "But": 15, "unfortun": 15, "encod": 15, "notion": 15, "eg": [15, 20], "space": 15, "bank": 15, "financ": 15, "closer": 15, "far": 15, "watermelon": 15, "close": 15, "overcom": 15, "altern": [15, 20], "amongst": 15, "hypothesi": 15, "deriv": [15, 20], "appear": 15, "seemingli": 15, "influenti": 15, "success": [15, 20], "modern": 15, "nlp": 15, "low": 15, "r": 15, "centr": 15, "bag": 15, "Of": 15, "cbow": 15, "surround": 15, "rest": 15, "manner": 15, "u_w": 15, "likewis": 15, "probabl": 15, "v_c": 15, "u_o": 15, "ideal": 15, "mathemat": 15, "pair": 15, "hat": 15, "vocab": 15, "Will": 15, "quantifi": 15, "good": 15, "bad": 15, "accordingli": 15, "l_": 15, "sum_": 15, "mathcal": 15, "y_w": 15, "y_o": 15, "callout": 15, "perfect": 15, "awai": 15, "minimis": 15, "corpu": 15, "document": 15, "w_": 15, "m": [15, 20], "posit": 15, "integ": 15, "l": 15, "j": 15, "p_": 15, "likelihood": 15, "guid": 15, "x_": 15, "learningr": 15, "nabla_": 15, "dfrac": 15, "u_x": 15, "y_x": 15, "tell": 15, "subtract": 15, "sens": 15, "short": 15, "essenc": 15, "select": [15, 20], "interest": 15, "u_1": 15, "u_2": 15, "u_": 15, "rewrit": 15, "vectoris": 15, "therebi": 15, "neq": 15, "y_1": 15, "y_2": 15, "y_": 15, "fact": 15, "computation": 15, "expens": 15, "describ": 15, "estim": 15, "dissimilar": 15, "prohibit": 15, "massiv": 15, "revisit": 15, "choos": 15, "w_1": 15, "w_2": 15, "w_k": 15, "Their": 15, "sigma": 15, "sigmoid": 15, "partial": 15, "modifi": 15, "nabla": 15, "w_t": 15, "leq": 15, "v_": 15, "v_w": 15, "templat": 15, "stanford": 15, "cours": 15, "cs224n": 15, "sentiment": 15, "treebank": 15, "formula": 15, "tune": 15, "impli": 15, "push": 15, "ml": 15, "downstream": 15, "summaris": 15, "lectur": 15, "new": [19, 20], "2020": 19, "12": 19, "28": 19, "beta22": 19, "furo": 19, "fairli": 19, "straightforward": 19, "site": [19, 20], "announc": 19, "banner": 19, "page": 19, "websit": [19, 20], "kei": 19, "html_theme_opt": 19, "conf": 19, "html": 19, "em": 19, "microsoft": 20, "amazon": 20, "servic": 20, "human": 20, "readabl": 20, "www": 20, "com": 20, "numer": 20, "192": 20, "internet": 20, "phone": 20, "book": 20, "request": 20, "browser": 20, "foundat": 20, "peopl": 20, "hierarch": 20, "variou": 20, "form": 20, "tree": 20, "mydomain": 20, "figur": 20, "author": 20, "client": 20, "resolv": 20, "unnam": 20, "indic": 20, "countri": 20, "busi": 20, "commerci": 20, "tld": 20, "edu": 20, "org": 20, "gov": 20, "subdomain": 20, "depart": 20, "geograph": 20, "locat": 20, "leaf": 20, "identifi": 20, "leftmost": 20, "cheat": 20, "sheet": 20, "ttl": 20, "long": 20, "expir": 20, "inherit": 20, "minimum": 20, "hour": 20, "soa": 20, "compet": 20, "diagram": 20, "overview": 20, "recurs": 20, "authorit": 20, "mere": 20, "sent": 20, "forc": 20, "respond": 20, "failur": 20, "contact": 20, "zone": 20, "escal": 20, "outsid": 20, "attempt": 20, "isp": 20, "portion": 20, "among": 20, "primari": 20, "secondari": 20, "stub": 20, "belong": 20, "made": 20, "superus": 20, "planet": 20, "essenti": 20, "13": 20, "organis": 20, "around": 20, "prefix": 20, "letter": 20, "upto": 20, "nearli": 20, "120": 20, "technic": 20, "backbon": 20, "ddo": 20, "attck": 20, "down": 20, "govern": 20, "privat": 20, "compani": 20, "googl": 20, "opendn": 20, "stuff": 20, "registrar": 20, "namecheap": 20, "icann": 20, "charg": 20, "registr": 20, "fee": 20, "cctld": 20, "tk": 20, "internation": 20, "idn": 20, "latin": 20, "charact": 20, "gtld": 20, "aero": 20, "arpa": 20, "protocol": 20, "automat": 20, "mask": 20, "gatewai": 20, "pool": 20, "leas": 20, "rather": 20, "perman": 20, "realloc": 20, "http": 20, "cloudn": 20, "blog": 20, "vpc": 20, "outpost": 20, "rack": 20, "premis": 20, "polici": 20, "failov": 20, "passiv": 20, "geoloc": 20, "geoproxim": 20, "shift": 20, "multivalu": 20, "eight": 20, "healthi": 20, "proport": 20, "expos": 20, "public": 20, "visitor": 20, "outag": 20, "elb": 20, "integr": 20, "load": 20, "balanc": 20, "alia": 20, "cloudfront": 20, "s3": 20, "cidr": 20, "24": 20, "ipv4": 20, "48": 20, "ipv6": 20, "contigu": 20, "act": 20, "intermediari": 20, "bar": 20, "goe": 20, "ec2": 20, "virtual": 20, "cloud": 20, "234": 20, "prepend": 20, "account": 20, "seattl": 20, "submit": 20}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"distribut": [0, 1, 2, 4, 9], "train": [0, 1, 2, 4, 8, 14], "learn": [0, 15], "resourc": [0, 20], "activ": [0, 14], "checkpoint": [0, 4], "singl": 0, "gpu": 0, "automat": [0, 8, 9], "mix": [0, 8], "precis": [0, 8], "static": 0, "graph": 0, "torch": [0, 4, 8, 9], "compil": 0, "how": [0, 3, 4, 6, 9, 11, 20], "work": [0, 4, 6, 11], "torchdynamo": [0, 4], "fx": 0, "multipl": [0, 4], "data": [0, 4], "parallel": [0, 4, 9, 11], "deepspe": 0, "glossari": 0, "nccl": 0, "gloo": 0, "mpi": 0, "pytorch": [1, 7], "ddp": [2, 4, 5, 6], "under": 2, "hood": 2, "point": 2, "commun": [2, 4], "collect": 2, "replic": [2, 20], "function": [2, 14], "distributeddataparallel": [2, 4], "backend": 2, "initi": [2, 4], "method": 2, "devic": 3, "mesh": 3, "what": [3, 9, 20], "i": [3, 4, 8, 9, 20], "devicemesh": 3, "why": [3, 9, 11], "us": [3, 4, 9, 15], "hsdp": 3, "code": [4, 8, 9, 15], "sampl": [4, 8, 9, 15], "implement": [4, 9], "processgroup": 4, "ddpoptim": 4, "overlap": 4, "comput": [4, 22], "save": 4, "load": 4, "combin": 4, "model": [4, 9, 11, 14, 15], "hook": 4, "run": 4, "torchrun": 4, "when": [4, 11], "enough": 4, "node": 4, "option": [4, 9], "slurm": 4, "configur": 4, "set": 4, "up": 4, "an": [4, 15], "aw": [4, 20], "cluster": 4, "script": 4, "launch": 4, "job": 4, "further": 4, "read": 4, "dp": 5, "v": [5, 6], "fsdp": [6, 11], "refer": [6, 8, 9, 11, 14, 15, 20], "gradient": [8, 15], "scale": 8, "cuda": 8, "op": 8, "specif": 8, "behavior": 8, "some": 8, "can": 8, "autocast": 8, "float16": 8, "float32": 8, "promot": 8, "widest": 8, "input": 8, "type": [8, 20], "With": 8, "default": 8, "ad": [8, 14], "gradscal": 8, "typic": 8, "accumul": [8, 15], "penalti": 8, "troubleshoot": 8, "speedup": 8, "amp": 8, "minor": 8, "loss": [8, 11, 14], "inf": 8, "nan": 8, "pipelin": 9, "step": 9, "1": 9, "build": [9, 14], "pipelinestag": 9, "2": 9, "pipelineschedul": 9, "execut": 9, "split": 9, "manual": 9, "doe": [9, 20], "api": 9, "your": [9, 20], "own": 9, "schedul": 9, "state_dict": 10, "tensor": 11, "you": 11, "should": 11, "appli": 11, "llama2": 11, "feedforward": 11, "layer": [11, 14], "attent": 11, "sequenc": 11, "layernorm": 11, "rmsnorm": 11, "home": 12, "natur": 13, "languag": 13, "process": 13, "recurr": 14, "neural": 14, "network": 14, "task": 14, "cross": 14, "entropi": 14, "optim": 14, "ml": 14, "initialis": 14, "fit": 14, "batch": 14, "test": 14, "forward": 14, "pass": 14, "backward": 14, "predict": [14, 19], "rnn": 14, "sigmoid": 14, "softmax": [14, 15], "dataset": 14, "evalu": 14, "summari": [14, 15], "word2vec": 15, "notat": 15, "intuit": 15, "structur": 15, "algorithm": 15, "stochast": 15, "descent": 15, "naiv": 15, "wrt": 15, "center": 15, "word": 15, "vector": 15, "outsid": 15, "neg": 15, "matrix": 15, "skip": 15, "gram": 15, "over": 15, "entir": 15, "context": 15, "window": 15, "numpi": 15, "result": 15, "visualis": 15, "ada": 16, "ecom": 17, "past": 18, "experi": 18, "analyt": 19, "iot": 19, "domain": 20, "name": 20, "system": 20, "dn": 20, "namespac": 20, "organ": 20, "record": 20, "time": 20, "live": 20, "rout": 20, "traffic": 20, "To": 20, "web": 20, "applic": 20, "queri": 20, "databas": 20, "cach": 20, "befor": 20, "hit": 20, "infrastructur": 20, "who": 20, "control": 20, "server": 20, "dhcp": 20, "53": 20, "featur": 20, "concept": 20, "imag": 21, "segment": 21, "vision": 22}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 58}, "alltitles": {"Distributed Training": [[0, "distributed-training"]], "Learning Resources": [[0, "learning-resources"]], "Activation checkpointing": [[0, "activation-checkpointing"]], "Single GPU": [[0, "single-gpu"]], "Automatic Mixed Precision": [[0, "automatic-mixed-precision"]], "Static Graphs with Torch.Compile": [[0, "static-graphs-with-torch-compile"]], "How torch.compile works ?": [[0, "how-torch-compile-works"]], "TorchDynamo and FX Graphs": [[0, "torchdynamo-and-fx-graphs"]], "Multiple GPUs": [[0, "multiple-gpus"]], "Distributed Data Parallel": [[0, "distributed-data-parallel"], [4, "distributed-data-parallel"]], "DeepSpeed": [[0, "deepspeed"]], "Glossary": [[0, "glossary"]], "NCCL": [[0, "nccl"]], "Gloo": [[0, "gloo"]], "MPI": [[0, "mpi"]], "Distributed Training and PyTorch": [[1, "distributed-training-and-pytorch"]], "DDP: Under the Hood": [[2, "ddp-under-the-hood"]], "Point-to-point communication": [[2, "point-to-point-communication"]], "Collective communication": [[2, "collective-communication"]], "Distributed Training:": [[2, "distributed-training"]], "Replicate the functionality of DistributedDataParallel": [[2, "replicate-the-functionality-of-distributeddataparallel"]], "Communication Backends": [[2, "communication-backends"]], "Initialization Methods": [[2, "initialization-methods"]], "Device Mesh": [[3, "device-mesh"]], "What is DeviceMesh ?": [[3, "what-is-devicemesh"]], "Why DeviceMesh is Useful ?": [[3, "why-devicemesh-is-useful"]], "How to use DeviceMesh with HSDP ?": [[3, "how-to-use-devicemesh-with-hsdp"]], "DistributedDataParallel (DDP)": [[4, "distributeddataparallel-ddp"]], "Code Sample": [[4, "code-sample"], [8, "code-sample"], [9, "code-sample"]], "How it works ?": [[4, "how-it-works"]], "Implementation": [[4, "implementation"]], "ProcessGroup": [[4, "processgroup"]], "DistributedDataParallel": [[4, "distributeddataparallel"]], "TorchDynamo DDPOptimizer: Overlap communications with compute": [[4, "torchdynamo-ddpoptimizer-overlap-communications-with-compute"]], "Save and Load Checkpoints": [[4, "save-and-load-checkpoints"]], "Combining DDP with Model Parallelism": [[4, "combining-ddp-with-model-parallelism"]], "DDP Communication Hooks": [[4, "ddp-communication-hooks"]], "Initialize DDP with torch.distributed.run/torchrun": [[4, "initialize-ddp-with-torch-distributed-run-torchrun"]], "When is DDP not enough?": [[4, "when-is-ddp-not-enough"]], "DDP on multiple nodes using Torchrun (and optionally Slurm)": [[4, "ddp-on-multiple-nodes-using-torchrun-and-optionally-slurm"]], "Configuration to set up an AWS cluster": [[4, "configuration-to-set-up-an-aws-cluster"]], "Slurm script to launch the training job": [[4, "slurm-script-to-launch-the-training-job"]], "Further Reading": [[4, "further-reading"]], "DP vs DDP": [[5, "dp-vs-ddp"]], "FSDP": [[6, "fsdp"]], "How FSDP Works": [[6, "how-fsdp-works"]], "FSDP VS DDP": [[6, "fsdp-vs-ddp"]], "References": [[6, "references"], [8, "references"], [8, "id1"], [9, "references"], [11, "references"], [14, "references"], [15, "references"], [20, "references"]], "Pytorch": [[7, "pytorch"]], "Mixed Precision": [[8, "mixed-precision"]], "Gradient Scaling": [[8, "gradient-scaling"]], "CUDA Op-Specific Behavior": [[8, "cuda-op-specific-behavior"]], "Some of the CUDA Ops that can autocast to float16": [[8, "some-of-the-cuda-ops-that-can-autocast-to-float16"]], "Some of the CUDA Ops that can autocast to float32": [[8, "some-of-the-cuda-ops-that-can-autocast-to-float32"]], "Some of the CUDA Ops that promote to the widest input type": [[8, "some-of-the-cuda-ops-that-promote-to-the-widest-input-type"]], "With Default Precision": [[8, "with-default-precision"]], "Adding torch.autocast": [[8, "adding-torch-autocast"]], "Adding GradScaler": [[8, "adding-gradscaler"]], "Typical Automatic Mixed Precision Training": [[8, "typical-automatic-mixed-precision-training"]], "Gradient accumulation with Scaled Gradients": [[8, "gradient-accumulation-with-scaled-gradients"]], "Gradient penalty with Scaled Gradients": [[8, "gradient-penalty-with-scaled-gradients"]], "Troubleshooting": [[8, "troubleshooting"]], "Speedup with Amp is minor": [[8, "speedup-with-amp-is-minor"]], "Loss is inf/NaN": [[8, "loss-is-inf-nan"]], "Pipeline Parallelism": [[9, "pipeline-parallelism"]], "Why Pipeline Parallel?": [[9, "why-pipeline-parallel"]], "What is torch.distributed.pipelining?": [[9, "what-is-torch-distributed-pipelining"]], "Step 1: build PipelineStage": [[9, "step-1-build-pipelinestage"]], "Step 2: use PipelineSchedule for execution": [[9, "step-2-use-pipelineschedule-for-execution"]], "Options for Splitting a Model": [[9, "options-for-splitting-a-model"]], "Option 1: splitting a model manually": [[9, "option-1-splitting-a-model-manually"]], "Option 2: splitting a model automatically": [[9, "option-2-splitting-a-model-automatically"]], "How does the pipeline API split a model?": [[9, "how-does-the-pipeline-api-split-a-model"]], "Implementing Your Own Schedule": [[9, "implementing-your-own-schedule"]], "state_dict": [[10, "state-dict"]], "Tensor parallelism": [[11, "tensor-parallelism"]], "How Tensor Parallel works?": [[11, "how-tensor-parallel-works"]], "When and Why you should apply Tensor Parallel ?": [[11, "when-and-why-you-should-apply-tensor-parallel"]], "How to apply Tensor Parallel ?": [[11, "how-to-apply-tensor-parallel"]], "Tensor Parallelism on Llama2 model": [[11, "tensor-parallelism-on-llama2-model"]], "Feedforward layer": [[11, "feedforward-layer"]], "Attention layer": [[11, "attention-layer"]], "Apply Sequence Parallel to LayerNorm/RMSNorm layers": [[11, "apply-sequence-parallel-to-layernorm-rmsnorm-layers"]], "Apply Loss Parallel": [[11, "apply-loss-parallel"]], "Tensor Parallel with FSDP": [[11, "tensor-parallel-with-fsdp"]], "Home": [[12, "home"]], "Natural Language Processing": [[13, "natural-language-processing"]], "Recurrent Neural Networks": [[14, "recurrent-neural-networks"]], "Task": [[14, "task"]], "Loss Function: Cross Entropy Loss": [[14, "loss-function-cross-entropy-loss"]], "Optimizers": [[14, "optimizers"]], "ML Model": [[14, "ml-model"]], "Model: Neural Network": [[14, "model-neural-network"]], "Initialise": [[14, "initialise"], [14, "id1"]], "Adding layers": [[14, "adding-layers"]], "Fit the model": [[14, "fit-the-model"]], "Train on a batch": [[14, "train-on-a-batch"]], "Test on a batch": [[14, "test-on-a-batch"]], "Forward Pass": [[14, "forward-pass"], [14, "id2"]], "Backward Pass": [[14, "backward-pass"], [14, "id3"]], "Predict": [[14, "predict"]], "Layers: RNN": [[14, "layers-rnn"]], "Activation: Sigmoid": [[14, "activation-sigmoid"]], "Activation: Softmax": [[14, "activation-softmax"]], "Dataset": [[14, "dataset"]], "Build and fit the Model": [[14, "build-and-fit-the-model"]], "Evaluation": [[14, "evaluation"]], "Summary": [[14, "summary"], [15, "summary"]], "Word2Vec": [[15, "word2vec"]], "Word2Vec Model": [[15, "word2vec-model"]], "Notation": [[15, "notation"]], "Model": [[15, "model"]], "Intuition": [[15, "intuition"]], "Code structuring": [[15, "code-structuring"]], "Learning Algorithm: Stochastic Gradient Descent": [[15, "learning-algorithm-stochastic-gradient-descent"]], "Naive-Softmax: Gradient wrt Center word vector": [[15, "naive-softmax-gradient-wrt-center-word-vector"]], "Naive-Softmax: Gradient wrt outside word vectors": [[15, "naive-softmax-gradient-wrt-outside-word-vectors"]], "Negative Sampling": [[15, "negative-sampling"]], "Negative-Sampling: Gradient wrt Center word vector": [[15, "negative-sampling-gradient-wrt-center-word-vector"]], "Negative-Sampling: Gradient wrt Outside word Matrix": [[15, "negative-sampling-gradient-wrt-outside-word-matrix"]], "Skip-gram: Accumulated Gradients over an entire context window": [[15, "skip-gram-accumulated-gradients-over-an-entire-context-window"]], "Code: Word2vec using Numpy": [[15, "code-word2vec-using-numpy"]], "Results: Visualisation": [[15, "results-visualisation"]], "ADAS": [[16, "adas"]], "Ecom": [[17, "ecom"]], "Past Experiences": [[18, "past-experiences"]], "Predictive Analytics in IoT": [[19, "predictive-analytics-in-iot"]], "Domain name system": [[20, "domain-name-system"]], "What is DNS ?": [[20, "what-is-dns"]], "How the DNS domain namespace is organized ?": [[20, "how-the-dns-domain-namespace-is-organized"]], "Types of DNS domain names": [[20, "types-of-dns-domain-names"]], "Record Types": [[20, "record-types"]], "Time-to-Live for resource records": [[20, "time-to-live-for-resource-records"]], "How Does DNS Route Traffic To Your Web Application?": [[20, "how-does-dns-route-traffic-to-your-web-application"]], "Querying the database": [[20, "querying-the-database"]], "Caching before hitting the DNS infrastructure": [[20, "caching-before-hitting-the-dns-infrastructure"]], "Replicating the DNS database": [[20, "replicating-the-dns-database"]], "Who controls the DNS servers?": [[20, "who-controls-the-dns-servers"]], "DHCP ?": [[20, "dhcp"]], "AWS DNS: Route 53 features": [[20, "aws-dns-route-53-features"]], "DNS concepts": [[20, "dns-concepts"]], "Image Segmentation": [[21, "image-segmentation"]], "Computer Vision": [[22, "computer-vision"]]}, "indexentries": {}})