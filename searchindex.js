Search.setIndex({"docnames": ["company_arch/index", "company_arch/netflix/content_popularity", "company_arch/netflix/index", "company_arch/netflix/netflix_fill", "company_arch/netflix/worldwide_content_delivery", "index", "nlp/index", "nlp/rnn", "nlp/word2vec", "past_experiences/adas", "past_experiences/ecom", "past_experiences/index", "past_experiences/iot", "pytorch/ddp_under_the_hood", "pytorch/device_mesh", "pytorch/distributed_data_parallel", "pytorch/dp_ddp", "pytorch/fsdp", "pytorch/general", "pytorch/index", "pytorch/mixed_precision", "pytorch/pipeline_parallelism", "pytorch/state_dict", "pytorch/tensor_parallelism", "system_design/dns", "vision/image_segmentation", "vision/index"], "filenames": ["company_arch/index.md", "company_arch/netflix/content_popularity.md", "company_arch/netflix/index.md", "company_arch/netflix/netflix_fill.md", "company_arch/netflix/worldwide_content_delivery.md", "index.md", "nlp/index.md", "nlp/rnn.md", "nlp/word2vec.md", "past_experiences/adas.md", "past_experiences/ecom.md", "past_experiences/index.md", "past_experiences/iot.md", "pytorch/ddp_under_the_hood.md", "pytorch/device_mesh.md", "pytorch/distributed_data_parallel.md", "pytorch/dp_ddp.md", "pytorch/fsdp.md", "pytorch/general.md", "pytorch/index.md", "pytorch/mixed_precision.md", "pytorch/pipeline_parallelism.md", "pytorch/state_dict.md", "pytorch/tensor_parallelism.md", "system_design/dns.md", "vision/image_segmentation.rst", "vision/index.md"], "titles": ["Company architecture", "Content Popularity for CDN", "Netflix", "Netflix and Fill", "Worldwide Content Delivery", "Home", "Natural Language Processing", "Recurrent Neural Networks", "Word2Vec", "ADAS", "Ecom", "Past Experiences", "Predictive Analytics in IoT", "DDP: Under the Hood", "Device Mesh", "Distributed Data Parallel", "DP vs DDP", "FSDP", "General", "PyTorch", "Mixed Precision", "Pipeline Parallelism", "state_dict", "Tensor parallelism", "Domain name system", "Image Segmentation", "Computer Vision"], "terms": {"netflix": [0, 1, 4], "cdn": [0, 3], "how": [1, 2, 3, 4, 8, 13], "i": [1, 3, 4, 7, 8, 13, 16, 17, 18, 22, 23], "us": [1, 3, 4, 7, 13, 16, 17, 18, 20, 22, 23, 24], "optim": [1, 4, 13, 15, 17, 20, 22, 23], "our": [1, 3, 4, 8, 13, 17, 21], "minim": [1, 4], "network": [1, 3, 4, 15, 18, 20, 24], "distanc": 1, "given": [1, 3, 8, 13, 15, 18, 20, 21, 24], "finit": 1, "amount": [1, 23, 24], "disk": [1, 4], "space": [1, 8], "avail": [1, 3, 13], "per": [1, 3, 15, 16, 17, 21], "server": [1, 4], "larg": [1, 13, 17, 20, 21, 23], "size": [1, 4, 7, 8, 10, 13, 15, 17, 20, 23], "entir": [1, 3, 7, 20, 21], "catalog": [1, 3], "we": [1, 3, 4, 7, 8, 13, 14, 15, 17, 21, 23], "cannot": [1, 15, 24], "fit": [1, 17], "all": [1, 3, 4, 7, 8, 13, 15, 16, 17, 20, 23, 24], "everi": [1, 13, 15, 23], "cluster": [1, 3, 4, 13, 17, 21], "co": 1, "locat": [1, 3, 4, 24], "mani": [1, 3, 13, 20, 23], "ar": [1, 3, 4, 8, 13, 15, 17, 20, 21, 22, 23, 24], "proxim": 1, "end": [1, 3, 4, 7, 8, 15, 20, 21, 23, 24], "user": [1, 4, 14, 15, 21, 23, 24], "isp": [1, 24], "do": [1, 3, 4, 8, 13, 20, 21, 23], "have": [1, 3, 8, 13, 15, 20, 21, 22, 23, 24], "enough": [1, 3, 20], "capac": [1, 4, 15], "therefor": [1, 4, 15, 18, 20], "cach": [1, 3, 4], "onli": [1, 4, 7, 8, 13, 15, 16, 17, 18, 20, 21, 23, 24], "most": [1, 3, 4, 8, 13, 24], "organ": [1, 15], "tier": [1, 3], "At": [1, 3, 7, 8, 17, 23], "deliv": 1, "veri": [1, 8, 17, 23], "traffic": [1, 3, 4], "infrastructur": 1, "high": [1, 3, 4, 7, 8, 13, 17, 23], "throughput": 1, "up": [1, 14, 17, 20, 21, 23, 24], "100gbp": 1, "serv": [1, 3, 4, 15, 20, 24], "storag": [1, 3], "200tb": 1, "tail": 1, "need": [1, 3, 4, 8, 14, 15, 17, 18, 20, 21, 23, 24], "rank": [1, 3, 13, 14, 15, 17, 21], "base": [1, 3, 4, 8, 15, 21, 24], "properli": [1, 13, 15], "within": [1, 3, 4, 7, 8, 14, 23, 24], "influenc": 1, "replic": [1, 14, 15, 16, 17, 23], "titl": [1, 3, 7], "over": [1, 3, 7, 13, 17, 20, 21, 23], "n": [1, 8, 13, 15, 20], "where": [1, 8, 14, 15, 20, 21, 23], "roughli": [1, 15], "proport": [1, 24], "why": [1, 18], "store": [1, 3, 8, 13, 24], "multipl": [1, 7, 8, 20, 21, 23, 24], "copi": [1, 3, 7, 13, 17, 24], "file": [1, 3, 4, 13, 15, 24], "an": [1, 3, 4, 7, 13, 14, 17, 18, 20, 21, 23, 24], "extrem": 1, "deploi": [1, 3], "singl": [1, 7, 15, 16, 17, 18, 21, 23, 24], "can": [1, 3, 4, 8, 13, 14, 15, 17, 18, 21, 22, 23, 24], "overwhelm": 1, "resourc": [1, 4], "while": [1, 8, 16, 17, 20, 21], "other": [1, 3, 4, 8, 13, 14, 15, 20, 21, 24], "mai": [1, 18, 20, 23], "remain": [1, 20], "underutil": 1, "thi": [1, 3, 4, 7, 8, 13, 15, 16, 17, 20, 21, 23, 24], "effect": [1, 20, 21, 23], "pronounc": 1, "deploy": 1, "environ": [1, 13, 15, 21, 23], "due": [1, 16, 23], "two": [1, 8, 14, 15, 21, 24], "crucial": 1, "becaus": [1, 3, 4, 15, 18, 20, 21, 22, 24], "rout": [1, 3], "region": [1, 3, 4, 15, 20, 24], "demand": [1, 4], "even": [1, 8, 16, 23], "get": [1, 3, 7, 18, 24], "share": [1, 3, 13, 15], "diffus": 1, "across": [1, 4, 7, 13, 14, 15, 16, 17, 21, 23], "lock": 1, "memori": [1, 15, 17, 20, 23], "rather": [1, 24], "than": [1, 8, 16, 17, 24], "fetch": 1, "constantli": 1, "from": [1, 3, 4, 7, 8, 13, 14, 15, 17, 18, 20, 21, 23, 24], "latter": 1, "elimin": 1, "possibl": [1, 4], "o": [1, 8, 13, 15, 24], "being": [1, 8, 13, 20, 23], "caus": 1, "bottleneck": [1, 23], "maxim": [1, 4, 17], "inter": [1, 14, 15, 23], "varianc": 1, "consist": [1, 4, 15, 21, 23, 24], "hash": [1, 4], "alloc": [1, 4, 15, 21], "its": [1, 3, 13, 14, 15, 17, 20, 21, 22, 23, 24], "own": [1, 17, 24], "typic": [1, 15, 21, 23, 24], "result": [1, 13, 20, 23, 24], "reason": [1, 15], "well": [1, 22], "balanc": [1, 24], "absolut": 1, "rock": 1, "broken": 1, "down": [1, 24], "less": 1, "pebbl": 1, "simpli": [1, 8, 22, 23, 24], "resili": 1, "failur": [1, 24], "unexpect": 1, "spike": 1, "In": [1, 4, 7, 8, 13, 15, 17, 20, 21, 22, 23, 24], "event": 1, "ha": [1, 7, 13, 15, 17, 20, 23, 24], "fail": [1, 20], "bound": [1, 20], "same": [1, 3, 8, 13, 15, 20, 23, 24], "more": [1, 3, 8, 13, 15, 17, 18, 23, 24], "distant": 1, "stai": 1, "much": [1, 4, 8, 20, 24], "prefer": [1, 18], "encod": [1, 3, 4, 8], "format": [1, 20], "profil": [1, 4], "For": [1, 3, 4, 7, 8, 13, 14, 15, 23, 24], "exampl": [1, 3, 13, 14, 15, 20, 21, 23, 24], "some": [1, 3, 15, 17, 24], "io": 1, "devic": [1, 4, 15, 17, 19, 20, 21, 23], "certain": [1, 21, 23], "class": [1, 7, 13, 14, 15, 18, 21], "smart": 1, "tv": 1, "There": [1, 8, 13, 18, 24], "video": [1, 4], "audio": 1, "contain": [1, 3, 15, 18, 20, 22, 24], "subtitl": [1, 3], "which": [1, 3, 7, 8, 14, 15, 17, 20, 21, 22, 23, 24], "bitrat": [1, 3, 4], "you": [1, 13, 15, 18, 20, 21, 24], "stream": [1, 3], "depend": [1, 3, 21, 23], "qualiti": [1, 3, 4], "your": [1, 13, 14, 15, 18, 20], "connect": [1, 3, 4, 13, 14, 23, 24], "support": [1, 4, 13, 15, 17, 21, 24], "itself": 1, "plan": [1, 23], "subscrib": 1, "so": [1, 3, 4, 8, 13, 15, 17, 20, 21, 23, 24], "each": [1, 3, 4, 7, 8, 13, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24], "quadrupl": 1, "languag": [1, 8, 23], "one": [1, 3, 4, 7, 8, 13, 15, 18, 21, 23, 24], "As": [1, 8, 13, 23], "episod": [1, 4], "The": [1, 3, 4, 8, 13, 14, 15, 17, 18, 20, 21, 23, 24], "crown": 1, "around": [1, 24], "1": [1, 7, 8, 13, 15, 17, 20, 23, 24], "200": 1, "evalu": 1, "effici": [1, 4, 15, 17, 23], "set": [1, 3, 7, 8, 13, 14, 23, 24], "servic": [1, 3, 24], "segment": 1, "ratio": 1, "byte": [1, 4, 20], "versu": 1, "overal": [1, 13, 21], "closest": 1, "translat": [1, 8, 24], "lesser": 1, "hop": [1, 3], "directli": [1, 15, 18, 21], "improv": [1, 8, 15, 17, 20, 23], "also": [1, 4, 8, 13, 14, 15, 20, 21, 22, 23], "reduc": [1, 4, 8, 13, 15, 17, 20, 23], "cost": [1, 3, 17, 23], "transport": 1, "both": [1, 8, 14, 16, 20, 23, 24], "predict": [1, 3, 4, 8, 23], "futur": 1, "view": [1, 4, 17], "pattern": [1, 13, 23], "look": [1, 23], "histor": 1, "smooth": 1, "data": [1, 2, 3, 4, 7, 8, 13, 14, 16, 17, 19, 20, 21, 23, 24], "collect": [1, 15, 16, 17, 20, 23], "dai": [1, 3, 23], "histori": 1, "make": [1, 3, 8, 15, 17, 20, 23, 24], "best": [1, 13, 24], "next": [1, 8, 15, 17, 20, 23], "what": [1, 3, 4, 8], "granular": [1, 4, 20], "level": [1, 3, 4, 7, 8, 13, 14, 15, 17, 21, 23, 24], "posit": [1, 8], "associ": [1, 3, 4], "group": [1, 3, 13, 14, 15, 21], "method": [1, 7, 8, 15, 20, 21, 24], "differ": [1, 3, 4, 8, 13, 14, 15, 17, 20, 21, 24], "section": [1, 8, 15], "howev": [1, 4, 23], "mechan": 1, "significantli": [1, 8, 23], "orthogon": 1, "abov": [1, 3, 8, 14, 15, 23], "2": [1, 7, 8, 13, 14, 15, 20, 23, 24], "aggreg": [1, 4], "comput": [1, 3, 7, 8, 13, 17, 20, 23, 24], "intuit": 1, "presumpt": 1, "member": [1, 3], "countri": [1, 3, 24], "similar": [1, 8, 13, 23], "scienc": [2, 4], "help": [2, 4, 14, 15, 20], "power": [2, 4], "worldwid": 2, "deliveri": 2, "content": [2, 3, 16, 24], "popular": [2, 3, 4], "fill": [2, 4], "readi": [3, 15], "when": [3, 4, 8, 13, 14, 16, 17, 20, 24], "new": [3, 4, 24], "piec": 3, "releas": 3, "digit": 3, "asset": 3, "hand": 3, "off": [3, 4, 15], "provid": [3, 4, 13, 15, 20, 21, 23, 24], "oper": [3, 13, 15, 17, 20, 21, 23], "team": 3, "point": [3, 15, 20, 21, 23], "variou": [3, 24], "type": [3, 15, 17, 23], "process": [3, 7, 8, 13, 14, 15, 16, 17, 24], "enhanc": 3, "take": [3, 4, 8, 15, 18, 20, 21, 23], "place": [3, 4, 13, 15, 20], "includ": [3, 4, 13, 21, 23, 24], "control": [3, 13, 15], "addit": [3, 16, 17, 21, 23, 24], "requir": [3, 13, 14, 15, 20, 21, 23, 24], "integr": [3, 24], "platform": 3, "phase": 3, "etc": [3, 8, 21, 22, 23, 24], "repackag": 3, "amazon": [3, 24], "simpl": [3, 4, 8, 13, 14, 15, 21, 24], "s3": [3, 24], "flag": 3, "via": [3, 13, 14, 23], "metadata": 3, "open": [3, 4, 13, 24], "system": [3, 8, 13], "start": [3, 8, 13, 15, 24], "applianc": 3, "oca": [3, 4], "proactiv": [3, 4], "import": [3, 4, 8, 14, 15, 20, 21, 23, 24], "between": [3, 8, 15, 21, 24], "commerci": [3, 24], "concept": 3, "accuraci": [3, 4, 7, 20, 24], "watch": 3, "time": [3, 7, 8, 15, 16, 20], "thei": [3, 8, 13, 15, 20, 22, 24], "non": [3, 8, 13, 24], "peak": [3, 4, 17], "bandwidth": [3, 21], "download": 3, "updat": [3, 7, 8, 15, 17, 20, 22, 24], "dure": [3, 4, 15, 17, 23], "configur": [3, 23, 24], "window": 3, "manifest": 3, "distribut": [3, 4, 8, 14, 19, 20, 23, 24], "appropri": [3, 7, 20], "expect": [3, 8, 15, 18, 20, 24], "particular": [3, 8, 20], "feed": [3, 23, 24], "simplifi": 3, "term": [3, 8, 23], "order": [3, 4, 8, 13, 15, 18], "list": [3, 13], "previou": [3, 7, 24], "about": [3, 13, 14, 22, 24], "should": [3, 8, 15, 20], "hold": 3, "independ": [3, 8], "select": [3, 8, 24], "criteria": 3, "step": [3, 7, 8, 13, 15, 17, 20], "further": [3, 8, 17, 23], "A": [3, 4, 13, 15, 20, 21, 22, 24], "escal": [3, 24], "polici": [3, 24], "describ": [3, 8], "below": [3, 15, 20, 23, 24], "number": [3, 4, 7, 8, 13, 23, 24], "master": [3, 13], "sourc": [3, 13, 15, 23, 24], "commun": [3, 14, 17, 21, 23, 24], "regular": 3, "interv": 3, "plane": 3, "request": [3, 24], "among": [3, 24], "thing": [3, 8, 21], "If": [3, 8, 13, 15, 20, 21, 24], "delta": 3, "current": [3, 7, 8, 13, 24], "send": [3, 4, 13, 15, 20, 21, 24], "respons": [3, 21, 23, 24], "aw": [3, 17], "potenti": 3, "k": [3, 8, 23], "determin": [3, 15, 21, 23, 24], "consider": 3, "sever": [3, 4, 8], "factor": [3, 8, 20, 24], "doe": [3, 8, 16, 20], "health": 3, "calcul": [3, 7, 8, 15], "least": [3, 8, 15], "expens": [3, 8], "To": [3, 4, 8, 13, 14, 15, 17, 20, 21, 23], "account": [3, 24], "state": [3, 7, 15, 17, 22], "paramet": [3, 7, 8, 13, 15, 17, 20, 21, 22, 23], "bgp": 3, "path": [3, 15, 17], "attribut": [3, 20], "physic": 3, "latitud": 3, "longitud": 3, "defin": [3, 8, 15, 21, 24], "awai": [3, 8], "go": [3, 7], "long": [3, 24], "wait": [3, 13, 15], "befor": [3, 13, 14, 15, 20, 21, 23], "whether": [3, 13], "beyond": 3, "input": [3, 7, 15, 16, 18, 21, 23], "work": [3, 4, 13, 14, 16, 20, 24], "gener": [3, 8, 15, 19, 21, 23, 24], "like": [3, 8, 15, 17, 20, 21, 23, 24], "peer": [3, 21], "subnet": [3, 15, 24], "outsid": [3, 24], "direct": [3, 21, 24], "live": 3, "suffici": [3, 15], "consid": [3, 13, 21, 24], "perspect": [3, 15], "blog": [4, 24], "prioriti": 4, "close": [4, 8], "consequ": [4, 23], "few": [4, 15, 20], "wider": 4, "internet": [4, 24], "fulli": [4, 15, 17, 23], "util": [4, 15, 20, 21, 23, 24], "hardwar": 4, "primetim": 4, "hour": [4, 24], "That": 4, "forecast": 4, "tomorrow": 4, "quiet": 4, "priorit": 4, "object": [4, 7, 8, 21, 22, 24], "simultan": 4, "replac": 4, "placement": 4, "wai": [4, 8, 15, 17, 23, 24], "advantag": [4, 13, 15], "local": [4, 15, 23, 24], "increas": [4, 15, 17, 20, 23], "highli": 4, "anoth": [4, 21, 24], "dimens": [4, 7, 8, 20, 23], "hundr": 4, "show": [4, 7, 14, 15, 20, 24], "wide": [4, 13], "rang": [4, 7, 13, 15, 20, 24], "condit": 4, "separ": [4, 23, 24], "vari": 4, "magnitud": [4, 20], "after": [4, 13, 15, 17, 20, 21, 23], "decid": 4, "relat": [4, 23, 24], "area": 4, "perform": [4, 13, 14, 15, 17, 20, 23, 24], "address": [4, 8, 13, 15, 24], "layer": [4, 17, 18, 20, 21, 22], "through": [4, 7, 13, 18, 20, 21, 24], "develop": 4, "algorithm": [4, 13, 23], "see": [4, 8, 14, 15, 20, 21], "affect": 4, "imagin": 4, "bad": [4, 8], "too": 4, "quickli": [4, 23], "satur": [4, 20], "avoid": [4, 8, 20, 23, 24], "situat": 4, "pseudo": 4, "randomli": 4, "stabl": [4, 18], "repeat": 4, "ani": [4, 7, 8, 13, 14, 15, 20, 24], "degre": 4, "random": [4, 7, 8, 15, 24], "still": [4, 14], "lead": 4, "hot": 4, "spot": 4, "anomal": 4, "load": [4, 24], "involv": [7, 8, 15], "follow": [7, 8, 13, 14, 17, 20, 21, 23, 24], "compon": 7, "articl": [7, 8], "implement": [7, 8, 13, 17, 20, 23, 24], "scratch": [7, 8], "numpi": 7, "def": [7, 13, 14, 15, 20, 21, 23], "__init__": [7, 14, 15], "self": [7, 14, 15, 21, 23], "y": [7, 8], "y_pred": 7, "rais": [7, 23], "notimpl": 7, "gradient": [7, 13, 15, 17, 21, 23], "return": [7, 14, 15, 20, 21, 23, 24], "0": [7, 8, 13, 15, 20, 21, 23, 24], "crossentropyloss": [7, 18], "p": [7, 8, 13], "np": 7, "clip": [7, 20], "1e": [7, 15], "15": 7, "log": [7, 8, 18, 20], "y_true": 7, "argmax": 7, "axi": 7, "sum": [7, 8, 13, 15, 17, 20], "len": [7, 13, 15], "w": [7, 8, 15], "grad_w": 7, "sgd": [7, 8, 13, 15, 20], "learning_r": 7, "descent": [7, 13], "neuralnetwork": 7, "loss_funct": 7, "metric": 7, "valid": 7, "add": [7, 18, 20, 24], "shape": [7, 21, 23], "set_input_shap": 7, "output_shap": 7, "attach": [7, 21], "weight": [7, 15, 17, 21, 22, 24], "hasattr": 7, "initi": [7, 23], "append": [7, 13, 20], "x": [7, 8, 14, 15, 18, 21, 23], "n_epoch": 7, "batch_siz": [7, 15, 20, 21, 23], "x_val": 7, "none": [7, 15, 20, 21], "y_val": 7, "print_once_every_epoch": 7, "fix": [7, 8], "epoch": [7, 8, 13, 15, 20], "run": [7, 13, 14, 17, 20, 21, 23, 24], "minibatch": 7, "x_batch": 7, "y_batch": 7, "batch_iter": 7, "acc": 7, "train_on_batch": 7, "mean": [7, 8, 13, 15, 20, 23], "val": 7, "val_loss": 7, "val_acc": 7, "test_on_batch": 7, "sampl": [7, 13], "_forward_pass": 7, "true": [7, 8, 15, 20, 23], "wrt": 7, "grad_loss": 7, "back": 7, "propag": [7, 21], "_backward_pass": 7, "fals": [7, 15, 20, 23], "output": [7, 13, 15, 16, 18, 20, 21, 23], "nn": [7, 14, 15, 18, 20, 21, 22, 23], "layer_output": 7, "forward_pass": 7, "grad": [7, 13, 15, 20], "revers": [7, 15], "backward_pass": 7, "pic": 7, "page4": 7, "unit": [7, 17], "equat": [7, 8], "backpropag": 7, "dim_input": 7, "int": [7, 15], "dim_hidden": 7, "hidden": 7, "relu": [7, 14, 15, 20], "bptt_trunc": 7, "input_shap": 7, "5": [7, 13, 14, 15, 21], "w_hh": 7, "matrix": [7, 23], "w_xh": 7, "w_ho": 7, "matric": [7, 8], "limit": [7, 15, 21, 23, 24], "math": 7, "sqrt": 7, "uniform": 7, "w_xh_opt": 7, "w_hh_opt": 7, "w_ho_opt": 7, "num_paramet": 7, "prod": [7, 20], "gif": 7, "page6": 7, "num_timestep": 7, "layer_input": 7, "save": [7, 17, 22, 23], "backprop": 7, "intermedi": [7, 15, 21], "state_act_input": 7, "zero": [7, 8, 13, 20], "state_act_output": 7, "iter": [7, 8, 15, 16, 20, 24], "t": [7, 8, 20], "matmul": [7, 20, 23], "page7": 7, "accumul": [7, 15], "dim_output": 7, "variabl": [7, 13, 24], "grad_inp": 7, "zeros_lik": 7, "grad_wxh": 7, "grad_whh": 7, "grad_who": 7, "timestep": 7, "grad_state_act_output": 7, "grad_state_act_input": 7, "bptt": 7, "num_timestamp": 7, "tt": 7, "arang": 7, "max": [7, 13, 20], "__call__": 7, "exp": [7, 8, 18], "e_x": 7, "keepdim": 7, "definit": [7, 8, 24], "clf": 7, "adam": 7, "10": [7, 13, 14, 15], "61": 7, "training_loss_acc": 7, "validation_loss_acc": 7, "x_train": 7, "y_train": 7, "300": 7, "512": [7, 20], "x_test": 7, "y_test": 7, "label": [7, 15, 24], "y_test1": 7, "accuracy_scor": 7, "plot": 7, "train_loss": 7, "plt": 7, "ylabel": 7, "xlabel": 7, "legend": 7, "without": [7, 8, 14, 20, 23, 24], "framework": [7, 8], "give": [7, 8, 24], "u": [7, 8, 15, 23, 24], "better": [7, 8], "insight": [7, 8], "probabilist": [7, 8], "machin": [7, 8, 13, 15, 16], "learn": [7, 20, 21, 24], "One": [8, 13, 15, 17, 23], "fundament": [8, 24], "problem": 8, "build": [8, 13], "natur": 8, "question": 8, "repres": [8, 21, 23, 24], "vital": 8, "practic": [8, 21, 23], "applic": [8, 13, 15], "answer": [8, 24], "inform": [8, 13, 22, 24], "retriev": 8, "summar": 8, "analysi": 8, "text": 8, "speech": 8, "simplest": [8, 15], "drawback": 8, "represent": [8, 20], "column": [8, 23], "": [8, 13, 14, 15, 17, 18, 20, 22, 23, 24], "length": [8, 10, 23, 24], "equal": 8, "vocabulari": [8, 23], "huge": [8, 23], "But": 8, "unfortun": 8, "notion": 8, "relationship": [8, 21], "eg": [8, 24], "would": [8, 14, 16, 20, 21, 23], "want": [8, 13, 23, 24], "bank": 8, "financ": 8, "closer": 8, "far": 8, "watermelon": 8, "overcom": 8, "altern": [8, 24], "amongst": 8, "hypothesi": 8, "deriv": [8, 24], "appear": 8, "seemingli": 8, "idea": [8, 23], "influenti": 8, "success": [8, 24], "modern": 8, "nlp": 8, "low": 8, "dimension": [8, 14, 23], "smaller": [8, 17, 23], "let": [8, 13, 14, 15, 23, 24], "v": [8, 18, 19, 23], "total": [8, 13, 15, 20], "d": [8, 14, 15, 23], "respect": [8, 23], "r": 8, "setup": [8, 14, 15], "centr": 8, "occur": [8, 20], "continu": [8, 23], "bag": 8, "Of": [8, 18], "cbow": 8, "surround": 8, "rest": 8, "manner": 8, "specifi": [8, 23, 24], "u_w": 8, "correspond": [8, 15, 17, 20, 24], "likewis": 8, "c": [8, 15], "probabl": [8, 18], "v_c": 8, "specif": [8, 15, 17, 21, 23, 24], "u_o": 8, "assign": [8, 20, 21, 24], "ideal": 8, "express": [8, 23], "mathemat": 8, "pair": 8, "hat": 8, "vocab": 8, "Will": 8, "actual": [8, 15, 24], "quantifi": 8, "good": 8, "cross": [8, 18, 20, 21, 23], "entropi": [8, 18, 23], "accordingli": 8, "loss": [8, 13, 15, 18], "l_": 8, "sum_": 8, "mathcal": 8, "y_w": 8, "sinc": [8, 15, 20, 23], "y_o": 8, "callout": 8, "info": [8, 15, 24], "now": [8, 20, 21, 23], "perfect": 8, "larger": [8, 15, 17, 20, 23], "function": [8, 15, 18, 21, 23, 24], "minimis": 8, "corpu": 8, "document": 8, "train": [8, 16, 17, 21, 23], "sequenc": [8, 20], "w_": 8, "m": [8, 24], "integ": 8, "valu": [8, 15, 20, 24], "l": 8, "j": 8, "p_": 8, "It": [8, 13, 14, 15, 21, 23, 24], "observ": [8, 20], "likelihood": 8, "guid": 8, "x_": 8, "learningr": 8, "nabla_": 8, "begin": [8, 20, 21], "first": [8, 13, 20, 21, 23, 24], "variant": [8, 23], "dfrac": 8, "u_x": 8, "y_x": 8, "tell": 8, "subtract": 8, "sens": 8, "multipli": [8, 20], "wa": [8, 13, 23], "short": 8, "essenc": 8, "wherea": [8, 20], "interest": 8, "note": [8, 15, 24], "u_1": 8, "u_2": 8, "u_": 8, "rewrit": 8, "enabl": [8, 13, 15, 20, 23, 24], "write": [8, 13, 15, 21], "vectoris": 8, "therebi": 8, "case": [8, 15, 20], "here": [8, 13, 15, 20, 23], "neq": 8, "combin": [8, 16, 17, 18, 20, 23], "y_1": 8, "y_2": 8, "y_": 8, "fact": 8, "computation": 8, "techniqu": [8, 15, 21, 23], "scale": [8, 13, 17, 21, 23], "ad": [8, 17, 18, 21, 22, 24], "estim": 8, "target": [8, 13, 15, 20], "dissimilar": 8, "prohibit": 8, "massiv": 8, "introduc": [8, 16, 17], "revisit": 8, "instead": [8, 15, 18], "choos": 8, "small": [8, 20], "w_1": 8, "w_2": 8, "w_k": 8, "Their": 8, "sigma": 8, "sigmoid": 8, "partial": 8, "With": [8, 14, 17, 23, 24], "chang": [8, 13, 20, 21, 23, 24], "modifi": 8, "nabla": 8, "those": [8, 20, 21, 23], "w_t": 8, "leq": 8, "arbitrari": 8, "could": [8, 14, 17, 23], "individu": [8, 20, 23, 24], "v_": 8, "v_w": 8, "templat": 8, "stanford": 8, "cours": [8, 18], "cs224n": 8, "sentiment": 8, "treebank": 8, "dataset": [8, 13, 15], "librari": [8, 15], "top": [8, 13, 23, 24], "formula": 8, "earlier": [8, 20], "rate": [8, 20], "tune": 8, "desir": [8, 20], "impli": 8, "ones": [8, 13], "togeth": [8, 21, 23, 24], "push": 8, "llm": [8, 23], "ml": 8, "These": [8, 15, 20, 24], "downstream": 8, "summaris": 8, "lectur": 8, "latenc": [10, 23, 24], "expt": 10, "model": [10, 13, 14, 16, 17, 18, 20, 22], "context": [10, 20], "batch": [10, 13, 15, 17, 20, 21, 23], "tensor": [10, 13, 15, 19, 20, 21, 22], "parallel": [10, 13, 14, 16, 17, 19], "pytorch": [13, 14, 15, 17, 18, 20, 21, 22, 23], "doc": [13, 15, 20, 21, 23], "packag": [13, 15, 20, 21], "torch": [13, 14, 18, 22, 23], "research": 13, "practition": 13, "easili": [13, 14, 15, 18, 22, 23], "leverag": [13, 14, 23], "messag": 13, "pass": [13, 15, 17, 18, 20, 21, 23], "semant": 13, "allow": [13, 14, 15, 17, 20, 21, 23, 24], "oppos": 13, "multiprocess": [13, 15], "restrict": 13, "execut": [13, 20], "init_process": 13, "ensur": [13, 17], "abl": 13, "coordin": 13, "ip": [13, 15, 24], "port": 13, "fn": 13, "gloo": [13, 15], "master_addr": [13, 15], "127": 13, "master_port": 13, "29500": [13, 15], "dist": [13, 15, 20], "init_process_group": [13, 15], "world_siz": [13, 15], "__name__": [13, 15], "__main__": [13, 15], "mp": [13, 15], "set_start_method": 13, "spawn": [13, 15], "arg": [13, 15], "join": [13, 15], "fine": 13, "grain": 13, "fanci": 13, "baidu": 13, "deepspeech": 13, "facebook": 13, "experi": [13, 17], "dst": 13, "block": [13, 15, 23, 24], "req": 13, "isend": 13, "els": [13, 20, 21], "receiv": [13, 24], "recv": [13, 21], "src": 13, "irecv": 13, "been": [13, 20, 21], "guarante": 13, "took": 13, "print": [13, 15, 20, 21], "communc": 13, "subset": 13, "creat": [13, 14, 15, 20, 21, 23, 24], "new_group": 13, "By": [13, 23], "default": [13, 15, 23, 24], "known": [13, 23], "world": [13, 15, 23, 24], "obtain": [13, 18, 24], "all_reduc": 13, "op": [13, 15, 21], "come": [13, 15, 17, 21, 23], "4": [13, 14, 15, 21], "element": 13, "wise": [13, 23], "reduceop": 13, "product": 13, "min": 13, "6": 13, "broadcast": [13, 15], "appli": [13, 14, 15, 20], "scatter": [13, 16, 17], "scatter_list": 13, "ith": 13, "gather": [13, 16, 17, 23], "gather_list": 13, "all_gath": [13, 17], "tensor_list": 13, "barrier": [13, 15], "until": 13, "enter": [13, 24], "version": [13, 17, 24], "stochast": 13, "script": [13, 20], "averag": [13, 15], "split": [13, 24], "converg": [13, 20, 23], "partit": [13, 21], "assum": 13, "replica": [13, 15, 17], "num_train_sampl": 13, "divid": [13, 21, 24], "maintain": [13, 17, 20, 24], "forward": [13, 14, 15, 17, 18, 20, 21, 23, 24], "backward": [13, 15, 17, 20, 21, 23], "code": [13, 14, 23, 24], "synchron": [13, 15, 20], "manual_se": 13, "1234": 13, "train_set": [13, 15], "bsz": 13, "partition_dataset": 13, "net": [13, 20, 24], "lr": [13, 15, 20], "01": 13, "momentum": 13, "num_batch": [13, 20], "ceil": 13, "float": [13, 20, 23], "epoch_loss": 13, "zero_grad": [13, 15, 20], "f": [13, 15, 18, 23], "nll_loss": [13, 20], "item": [13, 20], "average_gradi": 13, "get_rank": [13, 15], "get_world_s": 13, "param": [13, 15], "eleg": 13, "aspect": [13, 21], "abil": [13, 23], "abstract": [13, 14, 15, 23], "mention": [13, 23], "three": [13, 15, 23, 24], "nccl": [13, 14, 15, 23], "mpi": 13, "cpu": [13, 15, 17, 20], "gpu": [13, 15, 17, 20, 23], "cuda": [13, 14, 15, 23], "interfac": [13, 15], "standard": 13, "tool": [13, 15, 21], "field": [13, 15], "main": [13, 15], "inspir": 13, "api": [13, 14, 15, 17, 23], "li": 13, "against": 13, "pre": [13, 23], "built": [13, 15], "binari": 13, "four": 13, "final": [13, 17, 18, 23], "handshak": 13, "them": [13, 20, 23, 24], "free": 13, "host": [13, 14, 15, 21, 23, 24], "know": [13, 21, 24], "worker": [13, 15, 17], "filesystem": 13, "access": [13, 14, 21, 22], "everybodi": 13, "did": 13, "readili": 13, "tcp": [13, 24], "achiev": [13, 18], "reachabl": 13, "exchang": 13, "reach": [13, 17, 24], "higher": 14, "manag": [14, 15, 20, 21, 23, 24], "processgroup": [14, 23], "effortlessli": 14, "node": 14, "intra": [14, 15, 23], "worri": 14, "correctli": [14, 21], "sub": [14, 23], "underli": 14, "process_group": 14, "multi": [14, 15, 16, 23], "e": [14, 20, 21, 22, 23, 24], "3": [14, 15, 20], "compos": [14, 21], "solut": 14, "imag": [14, 15], "2d": 14, "counterpart": 14, "homogen": 14, "manual": [14, 20], "quit": 14, "complic": 14, "init_device_mesh": [14, 23], "accomplish": 14, "just": [14, 15, 17, 23], "line": 14, "device_mesh": [14, 23], "mesh_2d": [14, 23], "mesh_dim_nam": 14, "shard": [14, 15, 17, 23], "thru": 14, "get_group": 14, "replicate_group": 14, "mesh_dim": 14, "shard_group": 14, "snippet": 14, "elast": [14, 15, 24], "torchrun": 14, "nproc_per_nod": [14, 15], "8": [14, 15, 20, 23], "2d_setup_with_device_mesh": 14, "py": [14, 15], "hybrid": 14, "strategi": [14, 15], "fsdp": [14, 15, 19, 21], "ddp": [14, 19, 21, 23], "assist": 14, "toymodel": [14, 15], "modul": [14, 15, 21, 22, 23], "super": [14, 15], "net1": [14, 15], "linear": [14, 15, 20, 22, 23], "net2": [14, 15], "meshshap": 14, "sharding_strategi": 14, "shardingstrategi": 14, "hybrid_shard": 14, "Then": [14, 15, 17, 21], "command": [14, 15], "tutori": [15, 23], "instanc": [15, 17, 20, 21, 24], "buffer": [15, 21, 22], "regist": [15, 22, 23, 24], "autograd": [15, 20], "fire": 15, "signal": 15, "trigger": 15, "pleas": 15, "refer": 15, "design": 15, "detail": 15, "recommend": [15, 20], "span": 15, "wrap": [15, 17, 21], "lower": [15, 20, 24], "clean": 15, "were": 15, "alreadi": [15, 23], "basic": [15, 23], "loc": 15, "advanc": 15, "caveat": 15, "caution": 15, "construct": [15, 20, 21], "ddp_model": 15, "device_id": 15, "loss_fn": [15, 20], "mseloss": [15, 20], "001": [15, 20], "randn": [15, 20, 21], "20": 15, "nproc": 15, "wrapper": 15, "compil": 15, "graph": [15, 21], "break": 15, "bucket": [15, 24], "reli": 15, "c10d": 15, "henc": 15, "must": [15, 20, 21, 24], "constructor": [15, 17, 20], "state_dict": 15, "sure": [15, 20, 23], "exact": 15, "later": [15, 21], "care": 15, "bucket_cap_mb": 15, "argument": [15, 20, 21], "map": [15, 22, 24], "becom": [15, 23], "approxim": 15, "besid": 15, "analyz": 15, "find_unused_paramet": 15, "mode": 15, "subgraph": 15, "find": [15, 24], "out": [15, 23], "travers": 15, "mark": [15, 23], "unus": 15, "reduct": [15, 20], "invok": [15, 20], "kick": 15, "asynchron": 15, "allreduc": [15, 23], "finish": 15, "done": [15, 21, 23], "written": 15, "keep": [15, 17, 23], "sync": [15, 17], "hpp": 15, "box": 15, "name": [15, 23], "processgroupgloo": 15, "processgroupnccl": 15, "processgroupmpi": 15, "python": [15, 22], "entri": [15, 22, 24], "call": [15, 18, 20, 23, 24], "Its": [15, 17], "_sync_param": 15, "happen": [15, 23], "cpp": 15, "comm": 15, "h": [15, 23], "coalesc": [15, 20], "helper": [15, 21], "core": [15, 20, 23], "autograd_hook": 15, "engin": 15, "prepare_for_backward": 15, "aotautograd": 15, "prevent": [15, 20, 24], "whole": [15, 21], "logic": 15, "boundari": 15, "goal": 15, "schedul": 15, "common": 15, "recov": [15, 17, 20], "overhead": [15, 16, 17, 23], "correct": 15, "demo_checkpoint": 15, "checkpoint_path": 15, "tempfil": 15, "gettempdir": 15, "map_loc": 15, "load_state_dict": 15, "Not": 15, "necessari": [15, 23], "guard": 15, "delet": [15, 21], "remov": 15, "cleanup": 15, "output_devic": 15, "NOT": 15, "proper": [15, 23], "either": [15, 24], "toympmodel": 15, "dev0": 15, "dev1": 15, "demo_model_parallel": 15, "mp_model": 15, "ddp_mp_model": 15, "n_gpu": 15, "device_count": 15, "assert": [15, 20, 21], "got": 15, "run_demo": 15, "demo_bas": 15, "overrid": 15, "vanilla": 15, "loop": [15, 21], "register_comm_hook": 15, "flexibl": 15, "mainli": 15, "move": 15, "id": 15, "destroy_process_group": 15, "nnode": 15, "rdzv_id": 15, "100": 15, "rdzv_backend": 15, "rdzv_endpoint": 15, "29400": 15, "elastic_ddp": 15, "aka": 15, "16": 15, "export": [15, 21], "scontrol": 15, "hostnam": 15, "slurm_nodelist": 15, "head": [15, 23], "srun": 15, "torchrun_script": 15, "sh": 15, "footprint": [15, 17], "activ": [15, 17, 23, 24], "accomod": 15, "full": [15, 17, 20, 21], "grow": [15, 24], "aggress": 15, "might": [15, 24], "recomput": 15, "approach": 15, "multinod": 15, "dataload": 15, "datautil": 15, "mytraindataset": 15, "distributedsampl": 15, "ddp_setup": 15, "backend": 15, "set_devic": 15, "local_rank": 15, "trainer": 15, "train_data": 15, "save_everi": 15, "snapshot_path": 15, "str": 15, "global_rank": 15, "epochs_run": 15, "exist": 15, "snapshot": 15, "_load_snapshot": 15, "model_st": 15, "resum": 15, "_run_batch": 15, "cross_entropi": [15, 20], "_run_epoch": 15, "b_sz": 15, "batchsiz": 15, "sampler": 15, "set_epoch": 15, "_save_snapshot": 15, "max_epoch": 15, "load_train_obj": 15, "2048": 15, "prepare_dataload": 15, "pin_memori": 15, "shuffl": 15, "total_epoch": 15, "pt": 15, "argpars": 15, "parser": 15, "argumentpars": 15, "descript": 15, "add_argu": 15, "often": [15, 20, 21, 23, 24], "32": 15, "parse_arg": 15, "east": 15, "ubuntu1804": 15, "sharedstorag": 15, "mountdir": 15, "storagetyp": 15, "fsxlustr": 15, "fsxlustreset": 15, "storagecapac": 15, "1200": 15, "deploymenttyp": 15, "scratch_1": 15, "ssd": 15, "headnod": 15, "instancetyp": 15, "c5": 15, "xlarg": 15, "subnetid": 15, "xxxxxxx": 15, "ssh": 15, "keynam": 15, "slurmqueu": 15, "computeresourc": 15, "p32xlarg": 15, "p3": 15, "2xlarg": 15, "mincount": 15, "maxcount": 15, "bin": 15, "bash": 15, "sbatch": 15, "ntask": 15, "task": [15, 20], "slurm_job_nodelist": 15, "nodes_arrai": 15, "head_nod": 15, "head_node_ip": 15, "echo": 15, "loglevel": 15, "multinode_torchrun": 15, "50": [15, 20], "real": 15, "mingpt": 15, "1t": [15, 17], "dataparallel": 16, "thread": 16, "distributeddataparallel": [16, 17], "usual": [16, 17, 20, 23, 24], "slower": [16, 21], "gil": 16, "mar": 17, "2022": 17, "11": 17, "re": 17, "nativ": [17, 23], "heavili": 17, "borrow": 17, "fairscal": 17, "bring": [17, 24], "streamlin": 17, "realiz": 17, "84": 17, "tflop": 17, "a100": 17, "gpt": [17, 21], "159": 17, "175b": 17, "unlik": 17, "tradit": 17, "option": [17, 20, 24], "offload": 17, "nest": 17, "freed": 17, "immedi": [17, 20], "thu": 17, "feasibl": 17, "volum": 17, "intern": [17, 24], "overlap": 17, "discard": [17, 24], "reduce_scatt": [17, 23], "decompos": 17, "possess": 17, "subsequ": 17, "logsoftmax": 18, "softmax": [18, 20], "stackoverflow": 18, "ye": 18, "nllloss": 18, "log_softmax": [18, 20], "said": [18, 21, 24], "And": 18, "raw": 18, "logit": 18, "neural": 18, "last": [18, 23], "extra": 18, "mix": 19, "precis": 19, "under": [19, 20, 23], "hood": [19, 23], "dp": [19, 23], "pipelin": 19, "mesh": [19, 23], "conveni": 20, "datatyp": 20, "lower_precision_fp": 20, "half": 20, "bfloat16": 20, "tri": [20, 24], "match": 20, "convolut": [20, 22], "faster": [20, 24], "dynam": [20, 24], "primarili": 20, "benefit": 20, "architectur": [20, 24], "volta": 20, "ture": 20, "amper": 20, "recip": 20, "signific": 20, "3x": 20, "On": 20, "kepler": 20, "maxwel": 20, "pascal": 20, "modest": 20, "greatest": 20, "won": 20, "chosen": 20, "particip": 20, "permit": 20, "usag": 20, "capabl": [20, 23], "in_siz": 20, "out_siz": 20, "num_lay": 20, "produc": 20, "flush": 20, "underflow": 20, "lost": 20, "flow": [20, 21], "word": 20, "don": 20, "unscal": 20, "interfer": 20, "addbmm": 20, "bmm": 20, "chain_matmul": 20, "multi_dot": 20, "conv1d": 20, "conv2d": 20, "conv3d": 20, "grucel": 20, "lstmcell": 20, "mm": 20, "mv": 20, "prelu": 20, "rnncell": 20, "binary_cross_entropy_with_logit": 20, "cosine_similar": 20, "cumsum": 20, "l1_loss": 20, "layer_norm": 20, "mse_loss": 20, "norm": [20, 21, 23], "normal": 20, "pow": 20, "soft_margin_loss": 20, "softmin": 20, "softplu": 20, "dtype": 20, "stabil": 20, "cast": 20, "addcdiv": 20, "addcmul": 20, "bilinear": 20, "dot": [20, 24], "grid_sampl": 20, "scatter_add": 20, "tensordot": 20, "gc": 20, "start_tim": 20, "measur": 20, "report": 20, "yet": [20, 21], "pick": 20, "complet": 20, "synchronis": 20, "global": [20, 23, 24], "empty_cach": 20, "reset_max_memory_alloc": 20, "end_timer_and_print": 20, "local_msg": 20, "end_tim": 20, "3f": 20, "sec": 20, "max_memory_alloc": 20, "make_model": 20, "_": 20, "sequenti": 20, "tupl": 20, "try": 20, "128": [20, 23], "256": [20, 23, 24], "513": 20, "4096": 20, "is_avail": 20, "set_default_devic": 20, "trial": 20, "opt": 20, "zip": 20, "set_to_non": 20, "modestli": 20, "device_typ": 20, "exit": 20, "chose": 20, "scaler": 20, "onc": 20, "dedic": 20, "fresh": 20, "lightweight": 20, "otherwis": 20, "skip": 20, "demonstr": 20, "use_amp": 20, "unscale_": 20, "max_norm": 20, "clip_grad_norm_": 20, "batch_per_it": 20, "iters_to_accumul": 20, "num_proc": 20, "calibr": 20, "check": 20, "found": 20, "constant": 20, "imposs": 20, "enumer": [20, 23], "g": [20, 21, 24], "commonli": 20, "matter": 20, "rough": 20, "rule": 20, "thumb": 20, "oom": 20, "excess": [20, 23], "lot": 20, "friendli": 20, "disabl": 20, "persist": 20, "introduct": 21, "primit": [21, 23], "deep": 21, "micro": 21, "part": [21, 24], "concurr": [21, 23], "infer": 21, "promis": 21, "difficult": 21, "intrus": 21, "complex": 21, "toolkit": 21, "easi": [21, 23], "frontend": 21, "runtim": [21, 23], "captur": 21, "stage": 21, "handl": 21, "featur": 21, "rich": 21, "gpipe": 21, "1f1b": 21, "interleav": 21, "bf": 21, "infrastrutur": 21, "custom": [21, 24], "pp": 21, "interconnect": 21, "consum": 21, "static": [21, 24], "schedulegpip": 21, "n_microbatch": 21, "in_dim": 21, "microbatch": 21, "relev": 21, "meta": 21, "num_stag": 21, "transform": [21, 23], "stage_index": 21, "prepar": 21, "del": 21, "elif": 21, "second": [21, 24], "tok_embed": [21, 23], "input_arg": 21, "example_input_microbatch": 21, "worth": 21, "splitpoint": 21, "longtensor": 21, "pipe": 21, "mod": 21, "mb_arg": 21, "split_spec": 21, "stand": 21, "submodul": 21, "similarli": 21, "graphmodul": 21, "submod_0": 21, "emb": 21, "interpretermodul": 21, "lin": 21, "submod_1": 21, "lm": [21, 23], "proj": 21, "reconstruct": 21, "origin": [21, 23, 24], "hierarchi": [21, 24], "root": [21, 24], "Such": 21, "replai": 21, "fashion": [21, 23], "turn": 21, "acycl": 21, "dag": 21, "trace": 21, "convent": 21, "children": 21, "cut": 21, "structur": [21, 24], "extend": [21, 24], "pipelineschedulesingl": 21, "pipelineschedulemulti": 21, "style": [21, 23], "learnabl": 22, "bias": 22, "dictionari": 22, "alter": 22, "restor": 22, "great": 22, "deal": 22, "modular": 22, "batchnorm": 22, "running_mean": 22, "hyperparamet": 22, "tp": 23, "propos": 23, "megatron": 23, "paper": 23, "sp": 23, "parallelstyl": 23, "parallelize_modul": 23, "swap": 23, "dtensor": 23, "foward": 23, "layout": 23, "allgath": 23, "embed": 23, "quantiti": 23, "challeng": 23, "aris": 23, "exceed": 23, "domin": 23, "ring": 23, "decreas": 23, "hit": 23, "ballpark": 23, "yield": 23, "flop": 23, "billion": 23, "trillion": 23, "token": 23, "month": 23, "thousand": 23, "alwai": 23, "llama": 23, "70b": 23, "2k": 23, "35": 23, "alon": 23, "constraint": 23, "1k": 23, "offer": 23, "colwiseparallel": 23, "rowwiseparallel": 23, "row": 23, "sequenceparallel": 23, "dropout": 23, "rmsnormpython": 23, "preparemoduleinput": 23, "preparemoduleoutput": 23, "program": 23, "spmd": 23, "devicemesh": 23, "transformerblock": 23, "simpler": 23, "swiglu": 23, "mlp": 23, "w2": 23, "silu": 23, "w1": 23, "w3": 23, "project": 23, "colwis": 23, "rowwis": 23, "parallelize_plan": 23, "layer_tp_plan": 23, "feed_foward": 23, "feed_forward": 23, "wq": 23, "wk": 23, "wv": 23, "q": 23, "wo": 23, "intend": 23, "insid": 23, "hook": 23, "layer_id": 23, "transformer_block": 23, "adjust": 23, "attn_lay": 23, "n_head": 23, "tp_mesh": 23, "n_kv_head": 23, "illustr": 23, "compar": 23, "residu": 23, "attention_norm": 23, "ffn_norm": 23, "input_layout": 23, "desired_input_layout": 23, "output_layout": 23, "consumpt": 23, "speed": 23, "pictur": 23, "briefli": 23, "use_local_output": 23, "incur": 23, "fast": 23, "channel": 23, "nvlink": 23, "fullyshardeddataparallel": 23, "64": 23, "submesh": 23, "dp_mesh": 23, "tp_plan": 23, "model_tp": 23, "model_2d": 23, "use_orig_param": 23, "microsoft": 24, "human": 24, "readabl": 24, "www": 24, "com": 24, "numer": 24, "192": 24, "phone": 24, "book": 24, "browser": 24, "foundat": 24, "peopl": 24, "hierarch": 24, "form": 24, "tree": 24, "mydomain": 24, "figur": 24, "author": 24, "client": 24, "resolv": 24, "unnam": 24, "indic": 24, "busi": 24, "tld": 24, "edu": 24, "org": 24, "gov": 24, "subdomain": 24, "depart": 24, "geograph": 24, "leaf": 24, "identifi": 24, "leftmost": 24, "cheat": 24, "sheet": 24, "ttl": 24, "expir": 24, "inherit": 24, "minimum": 24, "soa": 24, "compet": 24, "diagram": 24, "overview": 24, "recurs": 24, "authorit": 24, "websit": 24, "mere": 24, "sent": 24, "forc": 24, "respond": 24, "contact": 24, "zone": 24, "attempt": 24, "portion": 24, "primari": 24, "secondari": 24, "stub": 24, "belong": 24, "made": 24, "read": 24, "superus": 24, "planet": 24, "essenti": 24, "13": 24, "organis": 24, "prefix": 24, "letter": 24, "upto": 24, "nearli": 24, "120": 24, "technic": 24, "backbon": 24, "ddo": 24, "attck": 24, "govern": 24, "privat": 24, "compani": 24, "googl": 24, "opendn": 24, "stuff": 24, "registrar": 24, "namecheap": 24, "icann": 24, "charg": 24, "registr": 24, "fee": 24, "cctld": 24, "tk": 24, "internation": 24, "idn": 24, "latin": 24, "charact": 24, "gtld": 24, "aero": 24, "arpa": 24, "protocol": 24, "automat": 24, "mask": 24, "gatewai": 24, "pool": 24, "leas": 24, "perman": 24, "longer": 24, "realloc": 24, "http": 24, "cloudn": 24, "vpc": 24, "outpost": 24, "rack": 24, "premis": 24, "failov": 24, "passiv": 24, "geoloc": 24, "geoproxim": 24, "shift": 24, "multivalu": 24, "eight": 24, "healthi": 24, "expos": 24, "public": 24, "visitor": 24, "site": 24, "outag": 24, "elb": 24, "alia": 24, "cloudfront": 24, "cidr": 24, "24": 24, "ipv4": 24, "48": 24, "ipv6": 24, "contigu": 24, "act": 24, "intermediari": 24, "bar": 24, "goe": 24, "ec2": 24, "virtual": 24, "cloud": 24, "234": 24, "prepend": 24, "seattl": 24, "submit": 24}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"compani": 0, "architectur": 0, "content": [1, 4], "popular": 1, "cdn": [1, 2], "netflix": [2, 3], "fill": 3, "worldwid": 4, "deliveri": 4, "home": 5, "natur": 6, "languag": 6, "process": 6, "recurr": 7, "neural": 7, "network": 7, "task": 7, "loss": [7, 20, 23], "function": [7, 13], "cross": 7, "entropi": 7, "optim": 7, "ml": 7, "model": [7, 8, 15, 21, 23], "initialis": 7, "ad": [7, 20], "layer": [7, 23], "fit": 7, "train": [7, 13, 15, 20], "batch": 7, "test": 7, "forward": 7, "pass": 7, "backward": 7, "predict": [7, 12], "rnn": 7, "activ": 7, "sigmoid": 7, "softmax": [7, 8], "dataset": 7, "build": [7, 21], "evalu": 7, "summari": [7, 8], "refer": [7, 8, 17, 20, 21, 23, 24], "word2vec": 8, "notat": 8, "intuit": 8, "code": [8, 15, 20, 21], "structur": 8, "learn": 8, "algorithm": 8, "stochast": 8, "gradient": [8, 20], "descent": 8, "naiv": 8, "wrt": 8, "center": 8, "word": 8, "vector": 8, "outsid": 8, "neg": 8, "sampl": [8, 15, 20, 21], "matrix": 8, "skip": 8, "gram": 8, "accumul": [8, 20], "over": 8, "an": [8, 15], "entir": 8, "context": 8, "window": 8, "us": [8, 14, 15, 21], "numpi": 8, "result": 8, "visualis": 8, "ada": 9, "ecom": 10, "rag": 10, "infer": 10, "past": 11, "experi": 11, "analyt": 12, "iot": 12, "ddp": [13, 15, 16, 17], "under": 13, "hood": 13, "point": 13, "commun": [13, 15], "collect": 13, "distribut": [13, 15, 21], "replic": [13, 24], "distributeddataparallel": [13, 15], "backend": 13, "initi": [13, 15], "method": 13, "devic": 14, "mesh": 14, "what": [14, 21, 24], "i": [14, 15, 20, 21, 24], "devicemesh": 14, "why": [14, 21, 23], "how": [14, 15, 17, 21, 23, 24], "hsdp": 14, "data": 15, "parallel": [15, 21, 23], "work": [15, 17, 23], "implement": [15, 21], "processgroup": 15, "torchdynamo": 15, "ddpoptim": 15, "overlap": 15, "comput": [15, 26], "save": 15, "load": 15, "checkpoint": 15, "combin": 15, "hook": 15, "torch": [15, 20, 21], "run": 15, "torchrun": 15, "when": [15, 23], "enough": 15, "multipl": 15, "node": 15, "option": [15, 21], "slurm": 15, "configur": 15, "set": 15, "up": 15, "aw": [15, 24], "cluster": 15, "script": 15, "launch": 15, "job": 15, "further": 15, "read": 15, "dp": 16, "v": [16, 17], "fsdp": [17, 23], "gener": 18, "pytorch": 19, "mix": 20, "precis": 20, "scale": 20, "cuda": 20, "op": 20, "specif": 20, "behavior": 20, "some": 20, "can": 20, "autocast": 20, "float16": 20, "float32": 20, "promot": 20, "widest": 20, "input": 20, "type": [20, 24], "With": 20, "default": 20, "gradscal": 20, "typic": 20, "automat": [20, 21], "penalti": 20, "troubleshoot": 20, "speedup": 20, "amp": 20, "minor": 20, "inf": 20, "nan": 20, "pipelin": 21, "step": 21, "1": 21, "pipelinestag": 21, "2": 21, "pipelineschedul": 21, "execut": 21, "split": 21, "manual": 21, "doe": [21, 24], "api": 21, "your": [21, 24], "own": 21, "schedul": 21, "state_dict": 22, "tensor": 23, "you": 23, "should": 23, "appli": 23, "llama2": 23, "feedforward": 23, "attent": 23, "sequenc": 23, "layernorm": 23, "rmsnorm": 23, "domain": 24, "name": 24, "system": 24, "dn": 24, "namespac": 24, "organ": 24, "record": 24, "time": 24, "live": 24, "resourc": 24, "rout": 24, "traffic": 24, "To": 24, "web": 24, "applic": 24, "queri": 24, "databas": 24, "cach": 24, "befor": 24, "hit": 24, "infrastructur": 24, "who": 24, "control": 24, "server": 24, "dhcp": 24, "53": 24, "featur": 24, "concept": 24, "imag": 25, "segment": 25, "vision": 26}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 58}, "alltitles": {"Company architecture": [[0, "company-architecture"]], "Content Popularity for CDN": [[1, "content-popularity-for-cdn"]], "Netflix": [[2, "netflix"]], "CDN": [[2, "cdn"]], "Netflix and Fill": [[3, "netflix-and-fill"]], "Worldwide Content Delivery": [[4, "worldwide-content-delivery"]], "Home": [[5, "home"]], "Natural Language Processing": [[6, "natural-language-processing"]], "Recurrent Neural Networks": [[7, "recurrent-neural-networks"]], "Task": [[7, "task"]], "Loss Function: Cross Entropy Loss": [[7, "loss-function-cross-entropy-loss"]], "Optimizers": [[7, "optimizers"]], "ML Model": [[7, "ml-model"]], "Model: Neural Network": [[7, "model-neural-network"]], "Initialise": [[7, "initialise"], [7, "id1"]], "Adding layers": [[7, "adding-layers"]], "Fit the model": [[7, "fit-the-model"]], "Train on a batch": [[7, "train-on-a-batch"]], "Test on a batch": [[7, "test-on-a-batch"]], "Forward Pass": [[7, "forward-pass"], [7, "id2"]], "Backward Pass": [[7, "backward-pass"], [7, "id3"]], "Predict": [[7, "predict"]], "Layers: RNN": [[7, "layers-rnn"]], "Activation: Sigmoid": [[7, "activation-sigmoid"]], "Activation: Softmax": [[7, "activation-softmax"]], "Dataset": [[7, "dataset"]], "Build and fit the Model": [[7, "build-and-fit-the-model"]], "Evaluation": [[7, "evaluation"]], "Summary": [[7, "summary"], [8, "summary"]], "References": [[7, "references"], [8, "references"], [17, "references"], [20, "references"], [20, "id1"], [21, "references"], [23, "references"], [24, "references"]], "Word2Vec": [[8, "word2vec"]], "Word2Vec Model": [[8, "word2vec-model"]], "Notation": [[8, "notation"]], "Model": [[8, "model"]], "Intuition": [[8, "intuition"]], "Code structuring": [[8, "code-structuring"]], "Learning Algorithm: Stochastic Gradient Descent": [[8, "learning-algorithm-stochastic-gradient-descent"]], "Naive-Softmax: Gradient wrt Center word vector": [[8, "naive-softmax-gradient-wrt-center-word-vector"]], "Naive-Softmax: Gradient wrt outside word vectors": [[8, "naive-softmax-gradient-wrt-outside-word-vectors"]], "Negative Sampling": [[8, "negative-sampling"]], "Negative-Sampling: Gradient wrt Center word vector": [[8, "negative-sampling-gradient-wrt-center-word-vector"]], "Negative-Sampling: Gradient wrt Outside word Matrix": [[8, "negative-sampling-gradient-wrt-outside-word-matrix"]], "Skip-gram: Accumulated Gradients over an entire context window": [[8, "skip-gram-accumulated-gradients-over-an-entire-context-window"]], "Code: Word2vec using Numpy": [[8, "code-word2vec-using-numpy"]], "Results: Visualisation": [[8, "results-visualisation"]], "ADAS": [[9, "adas"]], "Ecom": [[10, "ecom"]], "RAG": [[10, "rag"]], "Inference": [[10, "inference"]], "Past Experiences": [[11, "past-experiences"]], "Predictive Analytics in IoT": [[12, "predictive-analytics-in-iot"]], "DDP: Under the Hood": [[13, "ddp-under-the-hood"]], "Point-to-point communication": [[13, "point-to-point-communication"]], "Collective communication": [[13, "collective-communication"]], "Distributed Training:": [[13, "distributed-training"]], "Replicate the functionality of DistributedDataParallel": [[13, "replicate-the-functionality-of-distributeddataparallel"]], "Communication Backends": [[13, "communication-backends"]], "Initialization Methods": [[13, "initialization-methods"]], "Device Mesh": [[14, "device-mesh"]], "What is DeviceMesh ?": [[14, "what-is-devicemesh"]], "Why DeviceMesh is Useful ?": [[14, "why-devicemesh-is-useful"]], "How to use DeviceMesh with HSDP ?": [[14, "how-to-use-devicemesh-with-hsdp"]], "Distributed Data Parallel": [[15, "distributed-data-parallel"]], "DistributedDataParallel (DDP)": [[15, "distributeddataparallel-ddp"]], "Code Sample": [[15, "code-sample"], [20, "code-sample"], [21, "code-sample"]], "How it works ?": [[15, "how-it-works"]], "Implementation": [[15, "implementation"]], "ProcessGroup": [[15, "processgroup"]], "DistributedDataParallel": [[15, "distributeddataparallel"]], "TorchDynamo DDPOptimizer: Overlap communications with compute": [[15, "torchdynamo-ddpoptimizer-overlap-communications-with-compute"]], "Save and Load Checkpoints": [[15, "save-and-load-checkpoints"]], "Combining DDP with Model Parallelism": [[15, "combining-ddp-with-model-parallelism"]], "DDP Communication Hooks": [[15, "ddp-communication-hooks"]], "Initialize DDP with torch.distributed.run/torchrun": [[15, "initialize-ddp-with-torch-distributed-run-torchrun"]], "When is DDP not enough?": [[15, "when-is-ddp-not-enough"]], "DDP on multiple nodes using Torchrun (and optionally Slurm)": [[15, "ddp-on-multiple-nodes-using-torchrun-and-optionally-slurm"]], "Configuration to set up an AWS cluster": [[15, "configuration-to-set-up-an-aws-cluster"]], "Slurm script to launch the training job": [[15, "slurm-script-to-launch-the-training-job"]], "Further Reading": [[15, "further-reading"]], "DP vs DDP": [[16, "dp-vs-ddp"]], "FSDP": [[17, "fsdp"]], "How FSDP Works": [[17, "how-fsdp-works"]], "FSDP VS DDP": [[17, "fsdp-vs-ddp"]], "General": [[18, "general"]], "PyTorch": [[19, "pytorch"]], "Mixed Precision": [[20, "mixed-precision"]], "Gradient Scaling": [[20, "gradient-scaling"]], "CUDA Op-Specific Behavior": [[20, "cuda-op-specific-behavior"]], "Some of the CUDA Ops that can autocast to float16": [[20, "some-of-the-cuda-ops-that-can-autocast-to-float16"]], "Some of the CUDA Ops that can autocast to float32": [[20, "some-of-the-cuda-ops-that-can-autocast-to-float32"]], "Some of the CUDA Ops that promote to the widest input type": [[20, "some-of-the-cuda-ops-that-promote-to-the-widest-input-type"]], "With Default Precision": [[20, "with-default-precision"]], "Adding torch.autocast": [[20, "adding-torch-autocast"]], "Adding GradScaler": [[20, "adding-gradscaler"]], "Typical Automatic Mixed Precision Training": [[20, "typical-automatic-mixed-precision-training"]], "Gradient accumulation with Scaled Gradients": [[20, "gradient-accumulation-with-scaled-gradients"]], "Gradient penalty with Scaled Gradients": [[20, "gradient-penalty-with-scaled-gradients"]], "Troubleshooting": [[20, "troubleshooting"]], "Speedup with Amp is minor": [[20, "speedup-with-amp-is-minor"]], "Loss is inf/NaN": [[20, "loss-is-inf-nan"]], "Pipeline Parallelism": [[21, "pipeline-parallelism"]], "Why Pipeline Parallel?": [[21, "why-pipeline-parallel"]], "What is torch.distributed.pipelining?": [[21, "what-is-torch-distributed-pipelining"]], "Step 1: build PipelineStage": [[21, "step-1-build-pipelinestage"]], "Step 2: use PipelineSchedule for execution": [[21, "step-2-use-pipelineschedule-for-execution"]], "Options for Splitting a Model": [[21, "options-for-splitting-a-model"]], "Option 1: splitting a model manually": [[21, "option-1-splitting-a-model-manually"]], "Option 2: splitting a model automatically": [[21, "option-2-splitting-a-model-automatically"]], "How does the pipeline API split a model?": [[21, "how-does-the-pipeline-api-split-a-model"]], "Implementing Your Own Schedule": [[21, "implementing-your-own-schedule"]], "state_dict": [[22, "state-dict"]], "Tensor parallelism": [[23, "tensor-parallelism"]], "How Tensor Parallel works?": [[23, "how-tensor-parallel-works"]], "When and Why you should apply Tensor Parallel ?": [[23, "when-and-why-you-should-apply-tensor-parallel"]], "How to apply Tensor Parallel ?": [[23, "how-to-apply-tensor-parallel"]], "Tensor Parallelism on Llama2 model": [[23, "tensor-parallelism-on-llama2-model"]], "Feedforward layer": [[23, "feedforward-layer"]], "Attention layer": [[23, "attention-layer"]], "Apply Sequence Parallel to LayerNorm/RMSNorm layers": [[23, "apply-sequence-parallel-to-layernorm-rmsnorm-layers"]], "Apply Loss Parallel": [[23, "apply-loss-parallel"]], "Tensor Parallel with FSDP": [[23, "tensor-parallel-with-fsdp"]], "Domain name system": [[24, "domain-name-system"]], "What is DNS ?": [[24, "what-is-dns"]], "How the DNS domain namespace is organized ?": [[24, "how-the-dns-domain-namespace-is-organized"]], "Types of DNS domain names": [[24, "types-of-dns-domain-names"]], "Record Types": [[24, "record-types"]], "Time-to-Live for resource records": [[24, "time-to-live-for-resource-records"]], "How Does DNS Route Traffic To Your Web Application?": [[24, "how-does-dns-route-traffic-to-your-web-application"]], "Querying the database": [[24, "querying-the-database"]], "Caching before hitting the DNS infrastructure": [[24, "caching-before-hitting-the-dns-infrastructure"]], "Replicating the DNS database": [[24, "replicating-the-dns-database"]], "Who controls the DNS servers?": [[24, "who-controls-the-dns-servers"]], "DHCP ?": [[24, "dhcp"]], "AWS DNS: Route 53 features": [[24, "aws-dns-route-53-features"]], "DNS concepts": [[24, "dns-concepts"]], "Image Segmentation": [[25, "image-segmentation"]], "Computer Vision": [[26, "computer-vision"]]}, "indexentries": {}})