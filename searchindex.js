Search.setIndex({"docnames": ["index", "nlp/index", "nlp/rnn", "nlp/word2vec", "past_experiences/adas", "past_experiences/ecom", "past_experiences/index", "past_experiences/iot", "pytorch/ddp_under_the_hood", "pytorch/device_mesh", "pytorch/distributed_data_parallel", "pytorch/dp_ddp", "pytorch/fsdp", "pytorch/general", "pytorch/index", "pytorch/mixed_precision", "pytorch/pipeline_parallelism", "pytorch/state_dict", "pytorch/tensor_parallelism", "system_design/dns", "vision/image_segmentation", "vision/index"], "filenames": ["index.md", "nlp/index.md", "nlp/rnn.md", "nlp/word2vec.md", "past_experiences/adas.md", "past_experiences/ecom.md", "past_experiences/index.md", "past_experiences/iot.md", "pytorch/ddp_under_the_hood.md", "pytorch/device_mesh.md", "pytorch/distributed_data_parallel.md", "pytorch/dp_ddp.md", "pytorch/fsdp.md", "pytorch/general.md", "pytorch/index.md", "pytorch/mixed_precision.md", "pytorch/pipeline_parallelism.md", "pytorch/state_dict.md", "pytorch/tensor_parallelism.md", "system_design/dns.md", "vision/image_segmentation.rst", "vision/index.md"], "titles": ["Home", "Natural Language Processing", "Recurrent Neural Networks", "Word2Vec", "ADAS", "Ecom", "Past Experiences", "Predictive Analytics in IoT", "DDP: Under the Hood", "Device Mesh", "Distributed Data Parallel", "DP vs DDP", "FSDP", "General", "PyTorch", "Mixed Precision", "Pipeline Parallelism", "state_dict", "Tensor parallelism", "Domain name system", "Image Segmentation", "Computer Vision"], "terms": {"involv": [2, 3, 10], "follow": [2, 3, 8, 9, 12, 15, 16, 18, 19], "compon": 2, "In": [2, 3, 8, 10, 12, 15, 16, 17, 18, 19], "thi": [2, 3, 8, 10, 11, 12, 15, 16, 18, 19], "articl": [2, 3], "we": [2, 3, 8, 9, 10, 12, 16, 18], "go": 2, "implement": [2, 3, 8, 12, 15, 18, 19], "each": [2, 3, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19], "from": [2, 3, 8, 9, 10, 12, 13, 15, 16, 18, 19], "scratch": [2, 3], "us": [2, 8, 11, 12, 13, 15, 17, 18, 19], "numpi": 2, "class": [2, 8, 9, 10, 13, 16], "object": [2, 3, 16, 17, 19], "def": [2, 8, 9, 10, 15, 16, 18], "__init__": [2, 9, 10], "self": [2, 9, 10, 16, 18], "y": [2, 3], "y_pred": 2, "rais": [2, 18], "notimpl": 2, "gradient": [2, 8, 10, 12, 16, 18], "accuraci": [2, 15, 19], "return": [2, 9, 10, 15, 16, 18, 19], "0": [2, 3, 8, 10, 15, 16, 18, 19], "crossentropyloss": [2, 13], "p": [2, 3, 8], "np": 2, "clip": [2, 15], "1e": [2, 10], "15": 2, "1": [2, 3, 8, 10, 12, 15, 18, 19], "log": [2, 3, 13, 15], "y_true": 2, "argmax": 2, "axi": 2, "sum": [2, 3, 8, 10, 12, 15], "len": [2, 8, 10], "updat": [2, 3, 10, 12, 15, 17, 19], "w": [2, 3, 10], "grad_w": 2, "sgd": [2, 3, 8, 10, 15], "learning_r": 2, "descent": [2, 8], "neuralnetwork": 2, "loss_funct": 2, "metric": 2, "valid": 2, "add": [2, 13, 15, 19], "method": [2, 3, 10, 15, 16, 19], "which": [2, 3, 9, 10, 12, 15, 16, 17, 18, 19], "set": [2, 3, 8, 9, 18, 19], "input": [2, 10, 11, 13, 16, 18], "shape": [2, 16, 18], "set_input_shap": 2, "output_shap": 2, "attach": [2, 16], "an": [2, 8, 9, 12, 13, 15, 16, 18, 19], "ha": [2, 8, 10, 12, 15, 18, 19], "weight": [2, 10, 12, 16, 17, 19], "hasattr": 2, "initi": [2, 18], "current": [2, 3, 8, 19], "append": [2, 8, 15], "x": [2, 3, 9, 10, 13, 16, 18], "n_epoch": 2, "batch_siz": [2, 10, 15, 16, 18], "x_val": 2, "none": [2, 10, 15, 16], "y_val": 2, "print_once_every_epoch": 2, "fix": [2, 3], "number": [2, 3, 8, 18, 19], "epoch": [2, 3, 8, 10, 15], "rang": [2, 8, 10, 15, 19], "For": [2, 3, 8, 9, 10, 18, 19], "run": [2, 8, 9, 12, 15, 16, 18, 19], "over": [2, 8, 12, 15, 16, 18], "all": [2, 3, 8, 10, 11, 12, 15, 18, 19], "minibatch": 2, "x_batch": 2, "y_batch": 2, "batch_iter": 2, "acc": 2, "train_on_batch": 2, "mean": [2, 3, 8, 10, 15, 18], "At": [2, 3, 12, 18], "end": [2, 3, 10, 15, 16, 18, 19], "get": [2, 13, 19], "val": 2, "data": [2, 3, 8, 9, 11, 12, 14, 15, 16, 18, 19], "i": [2, 3, 8, 11, 12, 13, 17, 18], "val_loss": 2, "val_acc": 2, "test_on_batch": 2, "singl": [2, 10, 11, 12, 13, 16, 18, 19], "one": [2, 3, 8, 10, 13, 16, 18, 19], "sampl": [2, 8], "_forward_pass": 2, "true": [2, 3, 10, 15, 18], "comput": [2, 3, 8, 12, 15, 18, 19], "wrt": 2, "grad_loss": 2, "back": 2, "propag": [2, 16], "through": [2, 8, 13, 15, 16, 19], "entir": [2, 15, 16], "_backward_pass": 2, "fals": [2, 10, 15, 18], "calcul": [2, 3, 10], "output": [2, 8, 10, 11, 13, 15, 16, 18], "nn": [2, 9, 10, 13, 15, 16, 17, 18], "layer_output": 2, "forward_pass": 2, "grad": [2, 8, 10, 15], "revers": [2, 10], "backward_pass": 2, "pic": 2, "page4": 2, "2": [2, 3, 8, 9, 10, 15, 18, 19], "unit": [2, 12], "equat": [2, 3], "backpropag": 2, "within": [2, 3, 9, 18, 19], "paramet": [2, 3, 8, 10, 12, 15, 16, 17, 18], "dim_input": 2, "int": [2, 10], "dimens": [2, 3, 15, 18], "dim_hidden": 2, "hidden": 2, "state": [2, 10, 12, 17], "relu": [2, 9, 10, 15], "bptt_trunc": 2, "time": [2, 3, 10, 11, 15], "step": [2, 3, 8, 10, 12, 15], "input_shap": 2, "5": [2, 8, 9, 10, 16], "w_hh": 2, "matrix": [2, 18], "w_xh": 2, "w_ho": 2, "matric": [2, 3], "limit": [2, 10, 16, 18, 19], "math": 2, "sqrt": 2, "random": [2, 3, 10, 19], "uniform": 2, "w_xh_opt": 2, "copi": [2, 8, 12, 19], "w_hh_opt": 2, "w_ho_opt": 2, "num_paramet": 2, "prod": [2, 15], "gif": 2, "page6": 2, "across": [2, 8, 9, 10, 11, 12, 16, 18], "num_timestep": 2, "layer_input": 2, "save": [2, 12, 17, 18], "backprop": 2, "intermedi": [2, 10, 16], "state_act_input": 2, "zero": [2, 3, 8, 15], "state_act_output": 2, "iter": [2, 3, 10, 11, 15, 19], "t": [2, 3, 15], "matmul": [2, 15, 18], "page7": 2, "accumul": [2, 10], "multipl": [2, 3, 15, 16, 18, 19], "dim_output": 2, "variabl": [2, 8, 19], "appropri": [2, 15], "size": [2, 3, 5, 8, 10, 12, 15, 18], "grad_inp": 2, "zeros_lik": 2, "grad_wxh": 2, "grad_whh": 2, "grad_who": 2, "timestep": 2, "grad_state_act_output": 2, "grad_state_act_input": 2, "bptt": 2, "num_timestamp": 2, "onli": [2, 3, 8, 10, 11, 12, 13, 15, 16, 18, 19], "tt": 2, "arang": 2, "max": [2, 8, 15], "previou": [2, 19], "__call__": 2, "exp": [2, 3, 13], "e_x": 2, "keepdim": 2, "definit": [2, 3, 19], "clf": 2, "adam": 2, "10": [2, 8, 9, 10], "61": 2, "training_loss_acc": 2, "validation_loss_acc": 2, "x_train": 2, "y_train": 2, "300": 2, "512": [2, 15], "x_test": 2, "y_test": 2, "label": [2, 10, 19], "y_test1": 2, "accuracy_scor": 2, "plot": 2, "train_loss": 2, "plt": 2, "titl": 2, "ylabel": 2, "xlabel": 2, "legend": 2, "show": [2, 9, 10, 15, 19], "without": [2, 3, 9, 15, 18, 19], "ani": [2, 3, 8, 9, 10, 15, 19], "high": [2, 3, 8, 12, 18], "level": [2, 3, 8, 9, 10, 12, 16, 18, 19], "framework": [2, 3], "give": [2, 3, 19], "u": [2, 3, 10, 18, 19], "better": [2, 3], "insight": [2, 3], "probabilist": [2, 3], "process": [2, 3, 8, 9, 10, 11, 12, 19], "machin": [2, 3, 8, 10, 11], "learn": [2, 15, 16, 19], "One": [3, 8, 10, 12, 18], "fundament": [3, 19], "problem": 3, "build": [3, 8], "natur": 3, "languag": [3, 18], "system": [3, 8], "question": 3, "how": [3, 8], "repres": [3, 16, 18, 19], "vital": 3, "practic": [3, 16, 18], "applic": [3, 8, 10], "translat": [3, 19], "answer": [3, 19], "inform": [3, 8, 17, 19], "retriev": 3, "summar": 3, "analysi": 3, "text": 3, "speech": 3, "etc": [3, 16, 17, 18, 19], "simplest": [3, 10], "wai": [3, 10, 12, 18, 19], "independ": 3, "drawback": 3, "represent": [3, 15], "column": [3, 18], "": [3, 8, 9, 10, 12, 13, 15, 17, 18, 19], "length": [3, 5, 18, 19], "equal": 3, "vocabulari": [3, 18], "huge": [3, 18], "But": 3, "unfortun": 3, "do": [3, 8, 15, 16, 18], "encod": 3, "notion": 3, "similar": [3, 8, 18], "other": [3, 8, 9, 10, 15, 16, 19], "relationship": [3, 16], "between": [3, 10, 16, 19], "eg": [3, 19], "our": [3, 8, 12, 16], "space": 3, "would": [3, 9, 11, 15, 16, 18], "want": [3, 8, 18, 19], "bank": 3, "financ": 3, "closer": 3, "while": [3, 11, 12, 15, 16], "same": [3, 8, 10, 15, 18, 19], "both": [3, 9, 11, 15, 18, 19], "being": [3, 8, 15, 18], "significantli": [3, 18], "far": 3, "watermelon": 3, "thei": [3, 8, 10, 15, 17, 19], "ar": [3, 8, 10, 12, 15, 16, 17, 18, 19], "close": 3, "order": [3, 8, 10, 13], "overcom": 3, "need": [3, 9, 10, 12, 13, 15, 16, 18, 19], "altern": [3, 19], "amongst": 3, "gener": [3, 10, 14, 16, 18, 19], "base": [3, 10, 16, 19], "hypothesi": 3, "can": [3, 8, 9, 10, 12, 13, 16, 17, 18, 19], "deriv": [3, 19], "distribut": [3, 9, 14, 15, 18, 19], "appear": 3, "seemingli": 3, "simpl": [3, 8, 9, 10, 16, 19], "idea": [3, 18], "most": [3, 8, 19], "influenti": 3, "success": [3, 19], "modern": 3, "nlp": 3, "The": [3, 8, 9, 10, 12, 13, 15, 16, 18, 19], "low": 3, "dimension": [3, 9, 18], "much": [3, 15, 19], "smaller": [3, 12, 18], "than": [3, 11, 12, 19], "let": [3, 8, 9, 10, 18, 19], "v": [3, 13, 14, 18], "total": [3, 8, 10, 15], "d": [3, 9, 10, 18], "store": [3, 8, 19], "respect": [3, 18], "r": 3, "given": [3, 8, 10, 13, 15, 16, 19], "setup": [3, 9, 10], "two": [3, 9, 10, 16, 19], "centr": 3, "like": [3, 10, 12, 15, 16, 18, 19], "occur": [3, 15], "continu": [3, 18], "bag": 3, "Of": [3, 13], "cbow": 3, "surround": 3, "rest": 3, "manner": 3, "specifi": [3, 18, 19], "where": [3, 9, 10, 15, 16, 18], "u_w": 3, "correspond": [3, 10, 12, 15, 19], "likewis": 3, "c": [3, 10], "probabl": [3, 13], "o": [3, 8, 10, 19], "v_c": 3, "specif": [3, 10, 12, 16, 18, 19], "u_o": 3, "assign": [3, 15, 16, 19], "ideal": 3, "more": [3, 8, 10, 12, 13, 18, 19], "least": [3, 10], "express": [3, 18], "mathemat": 3, "pair": 3, "have": [3, 8, 10, 15, 16, 17, 18, 19], "hat": 3, "vocab": 3, "expect": [3, 10, 13, 15, 19], "Will": 3, "actual": [3, 10, 19], "predict": [3, 18], "quantifi": 3, "good": 3, "bad": 3, "cross": [3, 13, 15, 16, 18], "entropi": [3, 13, 18], "particular": [3, 15], "accordingli": 3, "loss": [3, 8, 10, 13], "l_": 3, "sum_": 3, "mathcal": 3, "y_w": 3, "sinc": [3, 10, 15, 18], "reduc": [3, 8, 10, 12, 15, 18], "y_o": 3, "callout": 3, "info": [3, 10, 19], "now": [3, 15, 16, 18], "If": [3, 8, 10, 15, 16, 19], "perfect": 3, "further": [3, 12, 18], "awai": 3, "larger": [3, 10, 12, 15, 18], "function": [3, 10, 13, 16, 18, 19], "minimis": 3, "corpu": 3, "document": 3, "train": [3, 11, 12, 16, 18], "sequenc": [3, 15], "w_": 3, "m": [3, 19], "k": [3, 18], "posit": 3, "integ": 3, "take": [3, 10, 13, 15, 16, 18], "valu": [3, 10, 15, 19], "l": 3, "j": 3, "p_": 3, "It": [3, 8, 9, 10, 16, 18, 19], "observ": [3, 15], "likelihood": 3, "defin": [3, 10, 16, 19], "next": [3, 10, 12, 15, 18], "guid": 3, "x_": 3, "n": [3, 8, 10, 15], "learningr": 3, "nabla_": 3, "section": [3, 10], "begin": [3, 15, 16], "first": [3, 8, 15, 16, 18, 19], "variant": [3, 18], "dfrac": 3, "u_x": 3, "y_x": 3, "so": [3, 8, 10, 12, 15, 16, 18, 19], "what": 3, "doe": [3, 11, 15], "tell": 3, "subtract": 3, "sens": 3, "multipli": [3, 15], "wa": [3, 8, 18], "short": 3, "make": [3, 10, 12, 15, 18, 19], "essenc": 3, "should": [3, 10, 15], "wherea": [3, 15], "select": [3, 19], "veri": [3, 12, 18], "differ": [3, 8, 9, 10, 12, 15, 16, 19], "also": [3, 8, 9, 10, 15, 16, 17, 18], "interest": 3, "note": [3, 10, 19], "u_1": 3, "u_2": 3, "u_": 3, "rewrit": 3, "abov": [3, 9, 10, 18], "term": [3, 18], "enabl": [3, 8, 10, 15, 18, 19], "write": [3, 8, 10, 16], "vectoris": 3, "therebi": 3, "improv": [3, 10, 12, 15, 18], "There": [3, 8, 13, 19], "case": [3, 10, 15], "here": [3, 8, 10, 15, 18], "neq": 3, "combin": [3, 11, 12, 13, 15, 18], "y_1": 3, "y_2": 3, "y_": 3, "thing": [3, 16], "fact": 3, "computation": 3, "expens": 3, "techniqu": [3, 10, 16, 18], "describ": 3, "address": [3, 8, 10, 19], "scale": [3, 8, 12, 16, 18], "ad": [3, 12, 13, 16, 17, 19], "estim": 3, "target": [3, 8, 10, 15], "factor": [3, 15, 19], "non": [3, 8, 19], "dissimilar": 3, "prohibit": 3, "massiv": 3, "avoid": [3, 15, 18, 19], "introduc": [3, 11, 12], "To": [3, 8, 9, 10, 12, 15, 16, 18], "see": [3, 9, 10, 15, 16], "revisit": 3, "instead": [3, 10, 13], "choos": 3, "small": [3, 15], "w_1": 3, "w_2": 3, "w_k": 3, "Their": 3, "sigma": 3, "sigmoid": 3, "partial": 3, "With": [3, 9, 12, 18, 19], "chang": [3, 8, 15, 16, 18, 19], "modifi": 3, "nabla": 3, "when": [3, 8, 9, 11, 12, 15, 19], "those": [3, 15, 16, 18], "w_t": 3, "leq": 3, "arbitrari": 3, "could": [3, 9, 12, 18], "simpli": [3, 17, 18, 19], "individu": [3, 15, 18, 19], "As": [3, 8, 18], "v_": 3, "v_w": 3, "templat": 3, "stanford": 3, "cours": [3, 13], "cs224n": 3, "sentiment": 3, "treebank": 3, "dataset": [3, 8, 10], "start": [3, 8, 10, 19], "import": [3, 9, 10, 15, 16, 18, 19], "librari": [3, 10], "top": [3, 8, 18, 19], "sever": 3, "formula": 3, "earlier": [3, 15], "rate": [3, 15], "tune": 3, "desir": [3, 15], "impli": 3, "ones": [3, 8], "togeth": [3, 16, 18, 19], "push": 3, "even": [3, 11, 18], "llm": [3, 18], "ml": 3, "These": [3, 10, 15, 19], "downstream": 3, "summaris": 3, "lectur": 3, "latenc": [5, 18, 19], "expt": 5, "model": [5, 8, 9, 11, 12, 13, 15, 17], "context": [5, 15], "batch": [5, 8, 10, 12, 15, 16, 18], "tensor": [5, 8, 10, 14, 15, 16, 17], "parallel": [5, 8, 9, 11, 12, 14], "sourc": [8, 10, 18, 19], "pytorch": [8, 9, 10, 12, 13, 15, 16, 17, 18], "doc": [8, 10, 15, 16, 18], "packag": [8, 10, 15, 16], "includ": [8, 16, 18, 19], "torch": [8, 9, 13, 17, 18], "research": 8, "practition": 8, "easili": [8, 9, 10, 13, 17, 18], "cluster": [8, 12, 16], "leverag": [8, 9, 18], "messag": 8, "pass": [8, 10, 12, 13, 15, 16, 18], "semant": 8, "allow": [8, 9, 10, 12, 15, 16, 18, 19], "oppos": 8, "multiprocess": [8, 10], "restrict": 8, "execut": [8, 15], "init_process": 8, "ensur": [8, 12], "everi": [8, 10, 18], "abl": 8, "coordin": 8, "master": 8, "ip": [8, 10, 19], "port": 8, "rank": [8, 9, 10, 12, 16], "fn": 8, "gloo": [8, 10], "environ": [8, 10, 16, 18], "master_addr": [8, 10], "127": 8, "master_port": 8, "29500": [8, 10], "dist": [8, 10, 15], "init_process_group": [8, 10], "world_siz": [8, 10], "__name__": [8, 10], "__main__": [8, 10], "mp": [8, 10], "set_start_method": 8, "spawn": [8, 10], "arg": [8, 10], "join": [8, 10], "fine": 8, "grain": 8, "control": [8, 10], "fanci": 8, "algorithm": [8, 18], "baidu": 8, "deepspeech": 8, "facebook": 8, "larg": [8, 12, 15, 16, 18], "experi": [8, 12], "send": [8, 10, 15, 16, 19], "dst": 8, "block": [8, 10, 18, 19], "req": 8, "isend": 8, "els": [8, 15, 16], "receiv": [8, 19], "recv": [8, 16], "src": 8, "irecv": 8, "wait": [8, 10], "after": [8, 10, 12, 15, 16, 18], "been": [8, 15, 16], "guarante": 8, "took": 8, "place": [8, 10, 15], "print": [8, 10, 15, 16], "communc": 8, "pattern": [8, 18], "group": [8, 9, 10, 16], "A": [8, 10, 15, 16, 17, 19], "subset": 8, "creat": [8, 9, 10, 15, 16, 18, 19], "list": 8, "new_group": 8, "By": [8, 18], "default": [8, 10, 18, 19], "known": [8, 18], "world": [8, 10, 18, 19], "exampl": [8, 9, 10, 15, 16, 18, 19], "obtain": [8, 13, 19], "all_reduc": 8, "op": [8, 10, 16], "come": [8, 10, 12, 16, 18], "4": [8, 9, 10, 16], "oper": [8, 10, 12, 15, 16, 18], "work": [8, 9, 11, 15, 19], "element": 8, "wise": [8, 18], "reduceop": 8, "product": 8, "min": 8, "6": 8, "broadcast": [8, 10], "appli": [8, 9, 10, 15], "result": [8, 15, 18, 19], "scatter": [8, 11, 12], "scatter_list": 8, "ith": 8, "gather": [8, 11, 12, 18], "gather_list": 8, "all_gath": [8, 12], "tensor_list": 8, "barrier": [8, 10], "until": 8, "enter": [8, 19], "version": [8, 12, 19], "stochast": 8, "script": [8, 15], "averag": [8, 10], "split": [8, 19], "converg": [8, 15, 18], "partit": [8, 16], "assum": 8, "replica": [8, 10, 12], "num_train_sampl": 8, "divid": [8, 16, 19], "maintain": [8, 12, 15, 19], "overal": [8, 16], "forward": [8, 9, 10, 12, 13, 15, 16, 18, 19], "backward": [8, 10, 12, 15, 16, 18], "optim": [8, 10, 12, 15, 17, 18], "code": [8, 9, 18, 19], "synchron": [8, 10, 15], "manual_se": 8, "1234": 8, "train_set": [8, 10], "bsz": 8, "partition_dataset": 8, "net": [8, 15, 19], "lr": [8, 10, 15], "01": 8, "momentum": 8, "num_batch": [8, 15], "ceil": 8, "float": [8, 15, 18], "epoch_loss": 8, "zero_grad": [8, 10, 15], "f": [8, 10, 13, 18], "nll_loss": [8, 15], "item": [8, 15], "average_gradi": 8, "get_rank": [8, 10], "get_world_s": 8, "param": [8, 10], "eleg": 8, "aspect": [8, 16], "its": [8, 9, 10, 12, 15, 16, 17, 18, 19], "abil": [8, 18], "abstract": [8, 9, 10, 18], "mention": [8, 18], "befor": [8, 9, 10, 15, 16, 18], "three": [8, 10, 18, 19], "nccl": [8, 9, 10, 18], "mpi": 8, "support": [8, 10, 12, 16, 19], "cpu": [8, 10, 12, 15], "gpu": [8, 10, 12, 15, 18], "cuda": [8, 9, 10, 18], "provid": [8, 10, 15, 16, 18, 19], "interfac": [8, 10], "standard": 8, "tool": [8, 10, 16], "field": [8, 10], "perform": [8, 9, 10, 12, 15, 18, 19], "main": [8, 10], "inspir": 8, "api": [8, 9, 10, 12, 18], "advantag": [8, 10], "li": 8, "wide": 8, "avail": 8, "against": 8, "you": [8, 10, 13, 15, 16, 19], "your": [8, 9, 10, 13, 15], "consid": [8, 16, 19], "best": [8, 19], "pre": [8, 18], "built": [8, 10], "binari": 8, "four": 8, "properli": [8, 10], "connect": [8, 9, 18, 19], "about": [8, 9, 17, 19], "final": [8, 12, 13, 18], "handshak": 8, "them": [8, 15, 18, 19], "free": 8, "host": [8, 9, 10, 16, 18, 19], "know": [8, 16, 19], "mani": [8, 15, 18], "worker": [8, 10, 12], "whether": 8, "share": [8, 10], "file": [8, 10, 19], "filesystem": 8, "requir": [8, 9, 10, 15, 16, 18, 19], "access": [8, 9, 16, 17], "open": [8, 19], "everybodi": 8, "did": 8, "readili": 8, "tcp": [8, 19], "via": [8, 9, 18], "achiev": [8, 13], "reachabl": 8, "exchang": 8, "reach": [8, 12, 19], "higher": 9, "manag": [9, 10, 15, 16, 18, 19], "processgroup": [9, 18], "user": [9, 10, 16, 18, 19], "effortlessli": 9, "inter": [9, 10, 18], "node": 9, "intra": [9, 10, 18], "worri": 9, "up": [9, 12, 15, 16, 18, 19], "correctli": [9, 16], "sub": [9, 18], "underli": 9, "process_group": 9, "multi": [9, 10, 11, 18], "e": [9, 15, 16, 17, 18, 19], "3": [9, 10, 15], "compos": [9, 16], "solut": 9, "commun": [9, 12, 16, 18, 19], "imag": [9, 10], "2d": 9, "counterpart": 9, "homogen": 9, "manual": [9, 15], "quit": 9, "complic": 9, "help": [9, 10, 15], "init_device_mesh": [9, 18], "accomplish": 9, "just": [9, 10, 12, 18], "line": 9, "still": 9, "device_mesh": [9, 18], "mesh_2d": [9, 18], "mesh_dim_nam": 9, "replic": [9, 10, 11, 12, 18], "shard": [9, 10, 12, 18], "thru": 9, "get_group": 9, "replicate_group": 9, "mesh_dim": 9, "shard_group": 9, "snippet": 9, "elast": [9, 10, 19], "torchrun": 9, "nproc_per_nod": [9, 10], "8": [9, 10, 15, 18], "2d_setup_with_device_mesh": 9, "py": [9, 10], "hybrid": 9, "strategi": [9, 10], "fsdp": [9, 10, 14, 16], "ddp": [9, 14, 16, 18], "assist": 9, "toymodel": [9, 10], "modul": [9, 10, 16, 17, 18], "super": [9, 10], "net1": [9, 10], "linear": [9, 10, 15, 17, 18], "net2": [9, 10], "meshshap": 9, "sharding_strategi": 9, "shardingstrategi": 9, "hybrid_shard": 9, "Then": [9, 10, 12, 16], "command": [9, 10], "tutori": [10, 18], "instanc": [10, 12, 15, 16, 19], "per": [10, 11, 12, 16], "collect": [10, 11, 12, 15, 18], "buffer": [10, 16, 17], "regist": [10, 17, 18, 19], "autograd": [10, 15], "fire": 10, "signal": 10, "trigger": 10, "pleas": 10, "refer": 10, "design": 10, "detail": 10, "recommend": [10, 15], "span": 10, "devic": [10, 12, 14, 15, 16, 18], "cannot": [10, 19], "wrap": [10, 12, 16], "lower": [10, 15, 19], "clean": 10, "were": 10, "local": [10, 18, 19], "dure": [10, 12, 18], "alreadi": [10, 18], "contain": [10, 13, 15, 17, 19], "basic": [10, 18], "few": [10, 15], "loc": 10, "advanc": 10, "some": [10, 12, 19], "caveat": 10, "caution": 10, "construct": [10, 15, 16], "ddp_model": 10, "device_id": 10, "loss_fn": [10, 15], "mseloss": [10, 15], "001": [10, 15], "randn": [10, 15, 16], "20": 10, "nproc": 10, "wrapper": 10, "compil": 10, "graph": [10, 16], "break": 10, "bucket": [10, 19], "reli": 10, "c10d": 10, "henc": 10, "must": [10, 15, 16, 19], "constructor": [10, 12, 15], "state_dict": 10, "sure": [10, 15, 18], "exact": 10, "later": [10, 16], "care": 10, "effici": [10, 12, 18], "organ": 10, "bucket_cap_mb": 10, "argument": [10, 15, 16], "map": [10, 17, 19], "determin": [10, 16, 18, 19], "alloc": [10, 16], "roughli": 10, "reason": 10, "becaus": [10, 13, 15, 16, 17, 19], "becom": [10, 18], "readi": 10, "approxim": 10, "besid": 10, "analyz": 10, "find_unused_paramet": 10, "mode": 10, "subgraph": 10, "find": [10, 19], "out": [10, 18], "travers": 10, "mark": [10, 18], "unus": 10, "reduct": [10, 15], "directli": [10, 13, 16], "invok": [10, 15], "kick": 10, "off": 10, "asynchron": 10, "allreduc": [10, 18], "finish": 10, "done": [10, 16, 18], "written": 10, "perspect": 10, "keep": [10, 12, 18], "sync": [10, 12], "hpp": 10, "box": 10, "name": [10, 18], "processgroupgloo": 10, "processgroupnccl": 10, "processgroupmpi": 10, "python": [10, 17], "entri": [10, 17, 19], "point": [10, 15, 16, 18], "call": [10, 13, 15, 18, 19], "Its": [10, 12], "_sync_param": 10, "happen": [10, 18], "cpp": 10, "comm": 10, "h": [10, 18], "coalesc": [10, 15], "helper": [10, 16], "core": [10, 15, 18], "autograd_hook": 10, "engin": 10, "prepare_for_backward": 10, "aotautograd": 10, "prevent": [10, 15, 19], "whole": [10, 16], "logic": 10, "boundari": 10, "goal": 10, "schedul": 10, "common": 10, "recov": [10, 12, 15], "overhead": [10, 11, 12, 18], "correct": 10, "demo_checkpoint": 10, "checkpoint_path": 10, "tempfil": 10, "gettempdir": 10, "therefor": [10, 13, 15], "suffici": 10, "map_loc": 10, "load_state_dict": 10, "Not": 10, "necessari": [10, 18], "guard": 10, "delet": [10, 16], "below": [10, 15, 18, 19], "serv": [10, 15, 19], "remov": 10, "cleanup": 10, "output_devic": 10, "NOT": 10, "proper": [10, 18], "either": [10, 19], "toympmodel": 10, "dev0": 10, "dev1": 10, "demo_model_parallel": 10, "mp_model": 10, "ddp_mp_model": 10, "n_gpu": 10, "device_count": 10, "assert": [10, 15, 16], "got": 10, "run_demo": 10, "demo_bas": 10, "overrid": 10, "vanilla": 10, "loop": [10, 16], "register_comm_hook": 10, "flexibl": 10, "mainli": 10, "increas": [10, 12, 15, 18], "move": 10, "id": 10, "destroy_process_group": 10, "nnode": 10, "rdzv_id": 10, "100": 10, "rdzv_backend": 10, "rdzv_endpoint": 10, "29400": 10, "elastic_ddp": 10, "aka": 10, "16": 10, "export": [10, 16], "scontrol": 10, "hostnam": 10, "slurm_nodelist": 10, "head": [10, 18], "srun": 10, "torchrun_script": 10, "sh": 10, "typic": [10, 16, 18, 19], "memori": [10, 12, 15, 18], "footprint": [10, 12], "consist": [10, 16, 18, 19], "activ": [10, 12, 18, 19], "capac": 10, "accomod": 10, "full": [10, 12, 15, 16], "grow": [10, 19], "aggress": 10, "might": [10, 19], "recomput": 10, "approach": 10, "fulli": [10, 12, 18], "multinod": 10, "util": [10, 15, 16, 18, 19], "dataload": 10, "datautil": 10, "mytraindataset": 10, "distributedsampl": 10, "ddp_setup": 10, "backend": 10, "set_devic": 10, "local_rank": 10, "trainer": 10, "train_data": 10, "save_everi": 10, "snapshot_path": 10, "str": 10, "global_rank": 10, "epochs_run": 10, "path": [10, 12], "exist": 10, "snapshot": 10, "_load_snapshot": 10, "model_st": 10, "resum": 10, "_run_batch": 10, "cross_entropi": [10, 15], "_run_epoch": 10, "b_sz": 10, "batchsiz": 10, "sampler": 10, "set_epoch": 10, "_save_snapshot": 10, "max_epoch": 10, "load_train_obj": 10, "2048": 10, "prepare_dataload": 10, "pin_memori": 10, "shuffl": 10, "total_epoch": 10, "pt": 10, "argpars": 10, "parser": 10, "argumentpars": 10, "descript": 10, "add_argu": 10, "type": [10, 12, 18], "often": [10, 15, 16, 18, 19], "32": 10, "parse_arg": 10, "region": [10, 15, 19], "east": 10, "ubuntu1804": 10, "sharedstorag": 10, "mountdir": 10, "storagetyp": 10, "fsxlustr": 10, "fsxlustreset": 10, "storagecapac": 10, "1200": 10, "deploymenttyp": 10, "scratch_1": 10, "ssd": 10, "headnod": 10, "instancetyp": 10, "c5": 10, "xlarg": 10, "network": [10, 13, 15, 19], "subnetid": 10, "subnet": [10, 19], "xxxxxxx": 10, "ssh": 10, "keynam": 10, "slurmqueu": 10, "computeresourc": 10, "p32xlarg": 10, "p3": 10, "2xlarg": 10, "mincount": 10, "maxcount": 10, "bin": 10, "bash": 10, "sbatch": 10, "ntask": 10, "task": [10, 15], "slurm_job_nodelist": 10, "nodes_arrai": 10, "head_nod": 10, "head_node_ip": 10, "echo": 10, "loglevel": 10, "multinode_torchrun": 10, "50": [10, 15], "real": 10, "mingpt": 10, "1t": [10, 12], "dataparallel": 11, "thread": 11, "distributeddataparallel": [11, 12], "usual": [11, 12, 15, 18, 19], "slower": [11, 16], "due": [11, 18], "gil": 11, "content": [11, 19], "addit": [11, 12, 16, 18, 19], "mar": 12, "2022": 12, "11": 12, "re": 12, "nativ": [12, 18], "heavili": 12, "borrow": 12, "fairscal": 12, "bring": [12, 19], "streamlin": 12, "realiz": 12, "84": 12, "tflop": 12, "a100": 12, "gpt": [12, 16], "159": 12, "175b": 12, "aw": 12, "unlik": 12, "tradit": 12, "option": [12, 15, 19], "offload": 12, "layer": [12, 13, 15, 16, 17], "nest": 12, "freed": 12, "immedi": [12, 15], "peak": 12, "thu": 12, "maxim": 12, "own": [12, 19], "feasibl": 12, "fit": 12, "cost": [12, 18], "volum": 12, "intern": [12, 19], "overlap": 12, "discard": [12, 19], "reduce_scatt": [12, 18], "view": 12, "decompos": 12, "possess": 12, "subsequ": 12, "logsoftmax": 13, "softmax": [13, 15], "stackoverflow": 13, "ye": 13, "nllloss": 13, "why": 13, "log_softmax": [13, 15], "stabl": 13, "said": [13, 16, 19], "And": 13, "raw": 13, "logit": 13, "neural": 13, "last": [13, 18], "mai": [13, 15, 18], "prefer": 13, "extra": 13, "mix": 14, "precis": 14, "under": [14, 15, 18], "hood": [14, 18], "dp": [14, 18], "pipelin": 14, "mesh": [14, 18], "conveni": 15, "datatyp": 15, "lower_precision_fp": 15, "half": 15, "bfloat16": 15, "tri": [15, 19], "match": 15, "convolut": [15, 17], "faster": [15, 19], "dynam": [15, 19], "primarili": 15, "benefit": 15, "architectur": [15, 19], "volta": 15, "ture": 15, "amper": 15, "recip": 15, "signific": 15, "3x": 15, "On": 15, "kepler": 15, "maxwel": 15, "pascal": 15, "modest": 15, "greatest": 15, "satur": 15, "bound": 15, "won": 15, "chosen": 15, "particip": 15, "permit": 15, "usag": 15, "capabl": [15, 18], "in_siz": 15, "out_siz": 15, "num_lay": 15, "enough": 15, "produc": 15, "magnitud": 15, "flush": 15, "underflow": 15, "lost": 15, "flow": [15, 16], "word": 15, "don": 15, "attribut": 15, "unscal": 15, "interfer": 15, "addbmm": 15, "bmm": 15, "chain_matmul": 15, "multi_dot": 15, "conv1d": 15, "conv2d": 15, "conv3d": 15, "grucel": 15, "lstmcell": 15, "mm": 15, "mv": 15, "prelu": 15, "rnncell": 15, "binary_cross_entropy_with_logit": 15, "cosine_similar": 15, "cumsum": 15, "l1_loss": 15, "layer_norm": 15, "mse_loss": 15, "norm": [15, 16, 18], "normal": 15, "pow": 15, "soft_margin_loss": 15, "softmin": 15, "softplu": 15, "dtype": 15, "stabil": 15, "cast": 15, "addcdiv": 15, "addcmul": 15, "bilinear": 15, "dot": [15, 19], "grid_sampl": 15, "scatter_add": 15, "tensordot": 15, "gc": 15, "start_tim": 15, "measur": 15, "report": 15, "yet": [15, 16], "pick": 15, "complet": 15, "synchronis": 15, "global": [15, 18, 19], "empty_cach": 15, "reset_max_memory_alloc": 15, "end_timer_and_print": 15, "local_msg": 15, "end_tim": 15, "3f": 15, "sec": 15, "format": 15, "byte": 15, "max_memory_alloc": 15, "make_model": 15, "_": 15, "sequenti": 15, "tupl": 15, "try": 15, "128": [15, 18], "256": [15, 18, 19], "513": 15, "4096": 15, "is_avail": 15, "set_default_devic": 15, "trial": 15, "opt": 15, "zip": 15, "set_to_non": 15, "modestli": 15, "device_typ": 15, "exit": 15, "chose": 15, "scaler": 15, "onc": 15, "dedic": 15, "fresh": 15, "lightweight": 15, "otherwis": 15, "skip": 15, "demonstr": 15, "use_amp": 15, "unscale_": 15, "max_norm": 15, "clip_grad_norm_": 15, "effect": [15, 16, 18], "batch_per_it": 15, "iters_to_accumul": 15, "num_proc": 15, "calibr": 15, "check": 15, "found": 15, "granular": 15, "remain": 15, "constant": 15, "imposs": 15, "enumer": [15, 18], "g": [15, 16, 19], "commonli": 15, "fail": 15, "matter": 15, "rough": 15, "rule": 15, "thumb": 15, "oom": 15, "excess": [15, 18], "lot": 15, "friendli": 15, "disabl": 15, "persist": 15, "introduct": 16, "primit": [16, 18], "deep": 16, "micro": 16, "part": [16, 19], "concurr": [16, 18], "bandwidth": 16, "infer": 16, "promis": 16, "difficult": 16, "intrus": 16, "anoth": [16, 19], "complex": 16, "depend": [16, 18], "toolkit": 16, "easi": [16, 18], "frontend": 16, "runtim": [16, 18], "captur": 16, "stage": 16, "handl": 16, "featur": 16, "rich": 16, "gpipe": 16, "1f1b": 16, "interleav": 16, "bf": 16, "infrastrutur": 16, "custom": [16, 19], "pp": 16, "interconnect": 16, "respons": [16, 18, 19], "peer": 16, "consum": 16, "static": [16, 19], "schedulegpip": 16, "n_microbatch": 16, "in_dim": 16, "microbatch": 16, "relev": 16, "meta": 16, "num_stag": 16, "transform": [16, 18], "stage_index": 16, "prepar": 16, "del": 16, "elif": 16, "second": [16, 19], "tok_embed": [16, 18], "input_arg": 16, "example_input_microbatch": 16, "worth": 16, "splitpoint": 16, "longtensor": 16, "pipe": 16, "mod": 16, "mb_arg": 16, "split_spec": 16, "stand": 16, "certain": [16, 18], "submodul": 16, "similarli": 16, "graphmodul": 16, "submod_0": 16, "emb": 16, "interpretermodul": 16, "lin": 16, "submod_1": 16, "lm": [16, 18], "proj": 16, "reconstruct": 16, "origin": [16, 18, 19], "hierarchi": [16, 19], "root": [16, 19], "Such": 16, "replai": 16, "fashion": [16, 18], "turn": 16, "direct": [16, 19], "acycl": 16, "dag": 16, "trace": 16, "convent": 16, "children": 16, "cut": 16, "structur": [16, 19], "extend": [16, 19], "pipelineschedulesingl": 16, "pipelineschedulemulti": 16, "style": [16, 18], "learnabl": 17, "bias": 17, "dictionari": 17, "alter": 17, "restor": 17, "great": 17, "deal": 17, "modular": 17, "batchnorm": 17, "running_mean": 17, "well": 17, "hyperparamet": 17, "tp": 18, "propos": 18, "megatron": 18, "paper": 18, "sp": 18, "bottleneck": 18, "parallelstyl": 18, "parallelize_modul": 18, "swap": 18, "dtensor": 18, "foward": 18, "layout": 18, "allgath": 18, "embed": 18, "howev": 18, "quantiti": 18, "challeng": 18, "aris": 18, "exceed": 18, "domin": 18, "ring": 18, "consequ": 18, "decreas": 18, "amount": [18, 19], "hit": 18, "ballpark": 18, "yield": 18, "flop": 18, "billion": 18, "trillion": 18, "token": 18, "month": 18, "thousand": 18, "alwai": 18, "llama": 18, "70b": 18, "2k": 18, "35": 18, "dai": 18, "quickli": 18, "alon": 18, "constraint": 18, "1k": 18, "offer": 18, "configur": [18, 19], "colwiseparallel": 18, "rowwiseparallel": 18, "row": 18, "sequenceparallel": 18, "dropout": 18, "rmsnormpython": 18, "preparemoduleinput": 18, "preparemoduleoutput": 18, "program": 18, "spmd": 18, "devicemesh": 18, "transformerblock": 18, "look": 18, "simpler": 18, "swiglu": 18, "mlp": 18, "w2": 18, "silu": 18, "w1": 18, "w3": 18, "project": 18, "colwis": 18, "rowwis": 18, "parallelize_plan": 18, "layer_tp_plan": 18, "feed_foward": 18, "feed_forward": 18, "wq": 18, "wk": 18, "wv": 18, "q": 18, "wo": 18, "intend": 18, "plan": 18, "insid": 18, "hook": 18, "layer_id": 18, "transformer_block": 18, "adjust": 18, "attn_lay": 18, "n_head": 18, "tp_mesh": 18, "n_kv_head": 18, "illustr": 18, "compar": 18, "feed": [18, 19], "residu": 18, "attention_norm": 18, "ffn_norm": 18, "input_layout": 18, "desired_input_layout": 18, "output_layout": 18, "relat": [18, 19], "consumpt": 18, "speed": 18, "pictur": 18, "briefli": 18, "use_local_output": 18, "incur": 18, "fast": 18, "channel": 18, "nvlink": 18, "fullyshardeddataparallel": 18, "64": 18, "submesh": 18, "dp_mesh": 18, "tp_plan": 18, "model_tp": 18, "model_2d": 18, "use_orig_param": 18, "separ": [18, 19], "microsoft": 19, "amazon": 19, "servic": 19, "human": 19, "readabl": 19, "www": 19, "com": 19, "numer": 19, "192": 19, "internet": 19, "phone": 19, "book": 19, "request": 19, "browser": 19, "foundat": 19, "peopl": 19, "hierarch": 19, "variou": 19, "form": 19, "tree": 19, "mydomain": 19, "figur": 19, "author": 19, "client": 19, "resolv": 19, "unnam": 19, "indic": 19, "countri": 19, "busi": 19, "commerci": 19, "tld": 19, "edu": 19, "org": 19, "gov": 19, "subdomain": 19, "depart": 19, "geograph": 19, "locat": 19, "leaf": 19, "identifi": 19, "leftmost": 19, "cheat": 19, "sheet": 19, "ttl": 19, "long": 19, "expir": 19, "inherit": 19, "minimum": 19, "hour": 19, "soa": 19, "compet": 19, "diagram": 19, "overview": 19, "recurs": 19, "authorit": 19, "websit": 19, "mere": 19, "sent": 19, "forc": 19, "respond": 19, "failur": 19, "contact": 19, "zone": 19, "escal": 19, "outsid": 19, "attempt": 19, "isp": 19, "portion": 19, "among": 19, "primari": 19, "secondari": 19, "stub": 19, "belong": 19, "made": 19, "read": 19, "superus": 19, "planet": 19, "essenti": 19, "13": 19, "organis": 19, "around": 19, "prefix": 19, "letter": 19, "upto": 19, "nearli": 19, "120": 19, "technic": 19, "backbon": 19, "ddo": 19, "attck": 19, "down": 19, "govern": 19, "privat": 19, "compani": 19, "googl": 19, "opendn": 19, "stuff": 19, "new": 19, "registrar": 19, "namecheap": 19, "icann": 19, "charg": 19, "registr": 19, "fee": 19, "cctld": 19, "tk": 19, "internation": 19, "idn": 19, "latin": 19, "charact": 19, "gtld": 19, "aero": 19, "arpa": 19, "protocol": 19, "automat": 19, "mask": 19, "gatewai": 19, "pool": 19, "leas": 19, "rather": 19, "perman": 19, "longer": 19, "realloc": 19, "http": 19, "cloudn": 19, "blog": 19, "vpc": 19, "outpost": 19, "rack": 19, "premis": 19, "polici": 19, "failov": 19, "passiv": 19, "geoloc": 19, "geoproxim": 19, "shift": 19, "multivalu": 19, "eight": 19, "healthi": 19, "proport": 19, "expos": 19, "public": 19, "visitor": 19, "site": 19, "outag": 19, "elb": 19, "integr": 19, "load": 19, "balanc": 19, "alia": 19, "cloudfront": 19, "s3": 19, "cidr": 19, "24": 19, "ipv4": 19, "48": 19, "ipv6": 19, "contigu": 19, "act": 19, "intermediari": 19, "bar": 19, "goe": 19, "ec2": 19, "virtual": 19, "cloud": 19, "234": 19, "prepend": 19, "account": 19, "seattl": 19, "submit": 19}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"home": 0, "natur": 1, "languag": 1, "process": 1, "recurr": 2, "neural": 2, "network": 2, "task": 2, "loss": [2, 15, 18], "function": [2, 8], "cross": 2, "entropi": 2, "optim": 2, "ml": 2, "model": [2, 3, 10, 16, 18], "initialis": 2, "ad": [2, 15], "layer": [2, 18], "fit": 2, "train": [2, 8, 10, 15], "batch": 2, "test": 2, "forward": 2, "pass": 2, "backward": 2, "predict": [2, 7], "rnn": 2, "activ": 2, "sigmoid": 2, "softmax": [2, 3], "dataset": 2, "build": [2, 16], "evalu": 2, "summari": [2, 3], "refer": [2, 3, 12, 15, 16, 18, 19], "word2vec": 3, "notat": 3, "intuit": 3, "code": [3, 10, 15, 16], "structur": 3, "learn": 3, "algorithm": 3, "stochast": 3, "gradient": [3, 15], "descent": 3, "naiv": 3, "wrt": 3, "center": 3, "word": 3, "vector": 3, "outsid": 3, "neg": 3, "sampl": [3, 10, 15, 16], "matrix": 3, "skip": 3, "gram": 3, "accumul": [3, 15], "over": 3, "an": [3, 10], "entir": 3, "context": 3, "window": 3, "us": [3, 9, 10, 16], "numpi": 3, "result": 3, "visualis": 3, "ada": 4, "ecom": 5, "rag": 5, "infer": 5, "past": 6, "experi": 6, "analyt": 7, "iot": 7, "ddp": [8, 10, 11, 12], "under": 8, "hood": 8, "point": 8, "commun": [8, 10], "collect": 8, "distribut": [8, 10, 16], "replic": [8, 19], "distributeddataparallel": [8, 10], "backend": 8, "initi": [8, 10], "method": 8, "devic": 9, "mesh": 9, "what": [9, 16, 19], "i": [9, 10, 15, 16, 19], "devicemesh": 9, "why": [9, 16, 18], "how": [9, 10, 12, 16, 18, 19], "hsdp": 9, "data": 10, "parallel": [10, 16, 18], "work": [10, 12, 18], "implement": [10, 16], "processgroup": 10, "torchdynamo": 10, "ddpoptim": 10, "overlap": 10, "comput": [10, 21], "save": 10, "load": 10, "checkpoint": 10, "combin": 10, "hook": 10, "torch": [10, 15, 16], "run": 10, "torchrun": 10, "when": [10, 18], "enough": 10, "multipl": 10, "node": 10, "option": [10, 16], "slurm": 10, "configur": 10, "set": 10, "up": 10, "aw": [10, 19], "cluster": 10, "script": 10, "launch": 10, "job": 10, "further": 10, "read": 10, "dp": 11, "v": [11, 12], "fsdp": [12, 18], "gener": 13, "pytorch": 14, "mix": 15, "precis": 15, "scale": 15, "cuda": 15, "op": 15, "specif": 15, "behavior": 15, "some": 15, "can": 15, "autocast": 15, "float16": 15, "float32": 15, "promot": 15, "widest": 15, "input": 15, "type": [15, 19], "With": 15, "default": 15, "gradscal": 15, "typic": 15, "automat": [15, 16], "penalti": 15, "troubleshoot": 15, "speedup": 15, "amp": 15, "minor": 15, "inf": 15, "nan": 15, "pipelin": 16, "step": 16, "1": 16, "pipelinestag": 16, "2": 16, "pipelineschedul": 16, "execut": 16, "split": 16, "manual": 16, "doe": [16, 19], "api": 16, "your": [16, 19], "own": 16, "schedul": 16, "state_dict": 17, "tensor": 18, "you": 18, "should": 18, "appli": 18, "llama2": 18, "feedforward": 18, "attent": 18, "sequenc": 18, "layernorm": 18, "rmsnorm": 18, "domain": 19, "name": 19, "system": 19, "dn": 19, "namespac": 19, "organ": 19, "record": 19, "time": 19, "live": 19, "resourc": 19, "rout": 19, "traffic": 19, "To": 19, "web": 19, "applic": 19, "queri": 19, "databas": 19, "cach": 19, "befor": 19, "hit": 19, "infrastructur": 19, "who": 19, "control": 19, "server": 19, "dhcp": 19, "53": 19, "featur": 19, "concept": 19, "imag": 20, "segment": 20, "vision": 21}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 58}, "alltitles": {"Home": [[0, "home"]], "Natural Language Processing": [[1, "natural-language-processing"]], "Recurrent Neural Networks": [[2, "recurrent-neural-networks"]], "Task": [[2, "task"]], "Loss Function: Cross Entropy Loss": [[2, "loss-function-cross-entropy-loss"]], "Optimizers": [[2, "optimizers"]], "ML Model": [[2, "ml-model"]], "Model: Neural Network": [[2, "model-neural-network"]], "Initialise": [[2, "initialise"], [2, "id1"]], "Adding layers": [[2, "adding-layers"]], "Fit the model": [[2, "fit-the-model"]], "Train on a batch": [[2, "train-on-a-batch"]], "Test on a batch": [[2, "test-on-a-batch"]], "Forward Pass": [[2, "forward-pass"], [2, "id2"]], "Backward Pass": [[2, "backward-pass"], [2, "id3"]], "Predict": [[2, "predict"]], "Layers: RNN": [[2, "layers-rnn"]], "Activation: Sigmoid": [[2, "activation-sigmoid"]], "Activation: Softmax": [[2, "activation-softmax"]], "Dataset": [[2, "dataset"]], "Build and fit the Model": [[2, "build-and-fit-the-model"]], "Evaluation": [[2, "evaluation"]], "Summary": [[2, "summary"], [3, "summary"]], "References": [[2, "references"], [3, "references"], [12, "references"], [15, "references"], [15, "id1"], [16, "references"], [18, "references"], [19, "references"]], "Word2Vec": [[3, "word2vec"]], "Word2Vec Model": [[3, "word2vec-model"]], "Notation": [[3, "notation"]], "Model": [[3, "model"]], "Intuition": [[3, "intuition"]], "Code structuring": [[3, "code-structuring"]], "Learning Algorithm: Stochastic Gradient Descent": [[3, "learning-algorithm-stochastic-gradient-descent"]], "Naive-Softmax: Gradient wrt Center word vector": [[3, "naive-softmax-gradient-wrt-center-word-vector"]], "Naive-Softmax: Gradient wrt outside word vectors": [[3, "naive-softmax-gradient-wrt-outside-word-vectors"]], "Negative Sampling": [[3, "negative-sampling"]], "Negative-Sampling: Gradient wrt Center word vector": [[3, "negative-sampling-gradient-wrt-center-word-vector"]], "Negative-Sampling: Gradient wrt Outside word Matrix": [[3, "negative-sampling-gradient-wrt-outside-word-matrix"]], "Skip-gram: Accumulated Gradients over an entire context window": [[3, "skip-gram-accumulated-gradients-over-an-entire-context-window"]], "Code: Word2vec using Numpy": [[3, "code-word2vec-using-numpy"]], "Results: Visualisation": [[3, "results-visualisation"]], "ADAS": [[4, "adas"]], "Ecom": [[5, "ecom"]], "RAG": [[5, "rag"]], "Inference": [[5, "inference"]], "Past Experiences": [[6, "past-experiences"]], "Predictive Analytics in IoT": [[7, "predictive-analytics-in-iot"]], "DDP: Under the Hood": [[8, "ddp-under-the-hood"]], "Point-to-point communication": [[8, "point-to-point-communication"]], "Collective communication": [[8, "collective-communication"]], "Distributed Training:": [[8, "distributed-training"]], "Replicate the functionality of DistributedDataParallel": [[8, "replicate-the-functionality-of-distributeddataparallel"]], "Communication Backends": [[8, "communication-backends"]], "Initialization Methods": [[8, "initialization-methods"]], "Device Mesh": [[9, "device-mesh"]], "What is DeviceMesh ?": [[9, "what-is-devicemesh"]], "Why DeviceMesh is Useful ?": [[9, "why-devicemesh-is-useful"]], "How to use DeviceMesh with HSDP ?": [[9, "how-to-use-devicemesh-with-hsdp"]], "Distributed Data Parallel": [[10, "distributed-data-parallel"]], "DistributedDataParallel (DDP)": [[10, "distributeddataparallel-ddp"]], "Code Sample": [[10, "code-sample"], [15, "code-sample"], [16, "code-sample"]], "How it works ?": [[10, "how-it-works"]], "Implementation": [[10, "implementation"]], "ProcessGroup": [[10, "processgroup"]], "DistributedDataParallel": [[10, "distributeddataparallel"]], "TorchDynamo DDPOptimizer: Overlap communications with compute": [[10, "torchdynamo-ddpoptimizer-overlap-communications-with-compute"]], "Save and Load Checkpoints": [[10, "save-and-load-checkpoints"]], "Combining DDP with Model Parallelism": [[10, "combining-ddp-with-model-parallelism"]], "DDP Communication Hooks": [[10, "ddp-communication-hooks"]], "Initialize DDP with torch.distributed.run/torchrun": [[10, "initialize-ddp-with-torch-distributed-run-torchrun"]], "When is DDP not enough?": [[10, "when-is-ddp-not-enough"]], "DDP on multiple nodes using Torchrun (and optionally Slurm)": [[10, "ddp-on-multiple-nodes-using-torchrun-and-optionally-slurm"]], "Configuration to set up an AWS cluster": [[10, "configuration-to-set-up-an-aws-cluster"]], "Slurm script to launch the training job": [[10, "slurm-script-to-launch-the-training-job"]], "Further Reading": [[10, "further-reading"]], "DP vs DDP": [[11, "dp-vs-ddp"]], "FSDP": [[12, "fsdp"]], "How FSDP Works": [[12, "how-fsdp-works"]], "FSDP VS DDP": [[12, "fsdp-vs-ddp"]], "General": [[13, "general"]], "PyTorch": [[14, "pytorch"]], "Mixed Precision": [[15, "mixed-precision"]], "Gradient Scaling": [[15, "gradient-scaling"]], "CUDA Op-Specific Behavior": [[15, "cuda-op-specific-behavior"]], "Some of the CUDA Ops that can autocast to float16": [[15, "some-of-the-cuda-ops-that-can-autocast-to-float16"]], "Some of the CUDA Ops that can autocast to float32": [[15, "some-of-the-cuda-ops-that-can-autocast-to-float32"]], "Some of the CUDA Ops that promote to the widest input type": [[15, "some-of-the-cuda-ops-that-promote-to-the-widest-input-type"]], "With Default Precision": [[15, "with-default-precision"]], "Adding torch.autocast": [[15, "adding-torch-autocast"]], "Adding GradScaler": [[15, "adding-gradscaler"]], "Typical Automatic Mixed Precision Training": [[15, "typical-automatic-mixed-precision-training"]], "Gradient accumulation with Scaled Gradients": [[15, "gradient-accumulation-with-scaled-gradients"]], "Gradient penalty with Scaled Gradients": [[15, "gradient-penalty-with-scaled-gradients"]], "Troubleshooting": [[15, "troubleshooting"]], "Speedup with Amp is minor": [[15, "speedup-with-amp-is-minor"]], "Loss is inf/NaN": [[15, "loss-is-inf-nan"]], "Pipeline Parallelism": [[16, "pipeline-parallelism"]], "Why Pipeline Parallel?": [[16, "why-pipeline-parallel"]], "What is torch.distributed.pipelining?": [[16, "what-is-torch-distributed-pipelining"]], "Step 1: build PipelineStage": [[16, "step-1-build-pipelinestage"]], "Step 2: use PipelineSchedule for execution": [[16, "step-2-use-pipelineschedule-for-execution"]], "Options for Splitting a Model": [[16, "options-for-splitting-a-model"]], "Option 1: splitting a model manually": [[16, "option-1-splitting-a-model-manually"]], "Option 2: splitting a model automatically": [[16, "option-2-splitting-a-model-automatically"]], "How does the pipeline API split a model?": [[16, "how-does-the-pipeline-api-split-a-model"]], "Implementing Your Own Schedule": [[16, "implementing-your-own-schedule"]], "state_dict": [[17, "state-dict"]], "Tensor parallelism": [[18, "tensor-parallelism"]], "How Tensor Parallel works?": [[18, "how-tensor-parallel-works"]], "When and Why you should apply Tensor Parallel ?": [[18, "when-and-why-you-should-apply-tensor-parallel"]], "How to apply Tensor Parallel ?": [[18, "how-to-apply-tensor-parallel"]], "Tensor Parallelism on Llama2 model": [[18, "tensor-parallelism-on-llama2-model"]], "Feedforward layer": [[18, "feedforward-layer"]], "Attention layer": [[18, "attention-layer"]], "Apply Sequence Parallel to LayerNorm/RMSNorm layers": [[18, "apply-sequence-parallel-to-layernorm-rmsnorm-layers"]], "Apply Loss Parallel": [[18, "apply-loss-parallel"]], "Tensor Parallel with FSDP": [[18, "tensor-parallel-with-fsdp"]], "Domain name system": [[19, "domain-name-system"]], "What is DNS ?": [[19, "what-is-dns"]], "How the DNS domain namespace is organized ?": [[19, "how-the-dns-domain-namespace-is-organized"]], "Types of DNS domain names": [[19, "types-of-dns-domain-names"]], "Record Types": [[19, "record-types"]], "Time-to-Live for resource records": [[19, "time-to-live-for-resource-records"]], "How Does DNS Route Traffic To Your Web Application?": [[19, "how-does-dns-route-traffic-to-your-web-application"]], "Querying the database": [[19, "querying-the-database"]], "Caching before hitting the DNS infrastructure": [[19, "caching-before-hitting-the-dns-infrastructure"]], "Replicating the DNS database": [[19, "replicating-the-dns-database"]], "Who controls the DNS servers?": [[19, "who-controls-the-dns-servers"]], "DHCP ?": [[19, "dhcp"]], "AWS DNS: Route 53 features": [[19, "aws-dns-route-53-features"]], "DNS concepts": [[19, "dns-concepts"]], "Image Segmentation": [[20, "image-segmentation"]], "Computer Vision": [[21, "computer-vision"]]}, "indexentries": {}})