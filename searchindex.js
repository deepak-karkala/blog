Search.setIndex({"docnames": ["index", "nlp/index", "nlp/rnn", "nlp/word2vec", "past_experiences/adas", "past_experiences/ecom", "past_experiences/index", "past_experiences/iot", "pytorch_distributed_training/distributed_training/index", "pytorch_distributed_training/index", "pytorch_distributed_training/optim_linear", "pytorch_distributed_training/pytorch/ddp_under_the_hood", "pytorch_distributed_training/pytorch/device_mesh", "pytorch_distributed_training/pytorch/distributed_data_parallel", "pytorch_distributed_training/pytorch/dp_ddp", "pytorch_distributed_training/pytorch/fsdp", "pytorch_distributed_training/pytorch/general", "pytorch_distributed_training/pytorch/index", "pytorch_distributed_training/pytorch/mixed_precision", "pytorch_distributed_training/pytorch/pipeline_parallelism", "pytorch_distributed_training/pytorch/state_dict", "pytorch_distributed_training/pytorch/tensor_parallelism", "system_design/dns", "vision/image_segmentation", "vision/index"], "filenames": ["index.md", "nlp/index.md", "nlp/rnn.md", "nlp/word2vec.md", "past_experiences/adas.md", "past_experiences/ecom.md", "past_experiences/index.md", "past_experiences/iot.md", "pytorch_distributed_training/distributed_training/index.md", "pytorch_distributed_training/index.md", "pytorch_distributed_training/optim_linear.md", "pytorch_distributed_training/pytorch/ddp_under_the_hood.md", "pytorch_distributed_training/pytorch/device_mesh.md", "pytorch_distributed_training/pytorch/distributed_data_parallel.md", "pytorch_distributed_training/pytorch/dp_ddp.md", "pytorch_distributed_training/pytorch/fsdp.md", "pytorch_distributed_training/pytorch/general.md", "pytorch_distributed_training/pytorch/index.md", "pytorch_distributed_training/pytorch/mixed_precision.md", "pytorch_distributed_training/pytorch/pipeline_parallelism.md", "pytorch_distributed_training/pytorch/state_dict.md", "pytorch_distributed_training/pytorch/tensor_parallelism.md", "system_design/dns.md", "vision/image_segmentation.rst", "vision/index.md"], "titles": ["Home", "Natural Language Processing", "Recurrent Neural Networks", "Word2Vec", "ADAS", "Ecom", "Past Experiences", "Predictive Analytics in IoT", "Distributed Training", "PyTorch, Distributed Training", "Optimising Linear Layers", "DDP: Under the Hood", "Device Mesh", "Distributed Data Parallel", "DP vs DDP", "FSDP", "General", "Pytorch", "Mixed Precision", "Pipeline Parallelism", "state_dict", "Tensor parallelism", "Domain name system", "Image Segmentation", "Computer Vision"], "terms": {"involv": [2, 3, 13], "follow": [2, 3, 11, 12, 15, 18, 19, 21, 22], "compon": [2, 8], "In": [2, 3, 8, 11, 13, 15, 18, 19, 20, 21, 22], "thi": [2, 3, 7, 8, 11, 13, 14, 15, 18, 19, 21, 22], "articl": [2, 3], "we": [2, 3, 8, 11, 12, 13, 15, 19, 21], "go": 2, "implement": [2, 3, 8, 11, 15, 18, 21, 22], "each": [2, 3, 11, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22], "from": [2, 3, 8, 11, 12, 13, 15, 16, 18, 19, 21, 22], "scratch": [2, 3], "us": [2, 8, 11, 14, 15, 16, 18, 20, 21, 22], "numpi": 2, "class": [2, 11, 12, 13, 16, 19], "object": [2, 3, 19, 20, 22], "def": [2, 11, 12, 13, 18, 19, 21], "__init__": [2, 12, 13], "self": [2, 12, 13, 19, 21], "y": [2, 3], "y_pred": 2, "rais": [2, 8, 21], "notimpl": 2, "gradient": [2, 8, 11, 13, 15, 19, 21], "accuraci": [2, 18, 22], "return": [2, 8, 12, 13, 18, 19, 21, 22], "0": [2, 3, 11, 13, 18, 19, 21, 22], "crossentropyloss": [2, 16], "p": [2, 3, 11], "np": 2, "clip": [2, 18], "1e": [2, 13], "15": 2, "1": [2, 3, 11, 13, 15, 18, 21, 22], "log": [2, 3, 16, 18], "y_true": 2, "argmax": 2, "axi": 2, "sum": [2, 3, 11, 13, 15, 18], "len": [2, 11, 13], "updat": [2, 3, 13, 15, 18, 20, 22], "w": [2, 3, 8, 13], "grad_w": 2, "sgd": [2, 3, 11, 13, 18], "learning_r": 2, "descent": [2, 11], "neuralnetwork": 2, "loss_funct": 2, "metric": 2, "valid": 2, "add": [2, 7, 16, 18, 22], "method": [2, 3, 13, 18, 19, 22], "which": [2, 3, 7, 8, 12, 13, 15, 18, 19, 20, 21, 22], "set": [2, 3, 7, 11, 12, 21, 22], "input": [2, 10, 13, 14, 16, 19, 21], "shape": [2, 19, 21], "set_input_shap": 2, "output_shap": 2, "attach": [2, 19], "an": [2, 8, 11, 12, 15, 16, 18, 19, 21, 22], "ha": [2, 8, 11, 13, 15, 18, 21, 22], "weight": [2, 13, 15, 19, 20, 22], "hasattr": 2, "initi": [2, 21], "current": [2, 3, 11, 22], "append": [2, 11, 18], "x": [2, 3, 8, 12, 13, 16, 19, 21], "n_epoch": 2, "batch_siz": [2, 13, 18, 19, 21], "x_val": 2, "none": [2, 13, 18, 19], "y_val": 2, "print_once_every_epoch": 2, "fix": [2, 3], "number": [2, 3, 8, 10, 11, 21, 22], "epoch": [2, 3, 11, 13, 18], "rang": [2, 11, 13, 18, 22], "For": [2, 3, 8, 10, 11, 12, 13, 21, 22], "run": [2, 8, 10, 11, 12, 15, 18, 19, 21, 22], "over": [2, 11, 15, 18, 19, 21], "all": [2, 3, 7, 8, 11, 13, 14, 15, 18, 21, 22], "minibatch": 2, "x_batch": 2, "y_batch": 2, "batch_iter": 2, "acc": 2, "train_on_batch": 2, "mean": [2, 3, 11, 13, 18, 21], "At": [2, 3, 15, 21], "end": [2, 3, 13, 18, 19, 21, 22], "get": [2, 16, 22], "val": 2, "data": [2, 3, 11, 12, 14, 15, 17, 18, 19, 21, 22], "i": [2, 3, 7, 8, 11, 14, 15, 16, 20, 21], "val_loss": 2, "val_acc": 2, "test_on_batch": 2, "singl": [2, 13, 14, 15, 16, 19, 21, 22], "one": [2, 3, 11, 13, 16, 19, 21, 22], "sampl": [2, 11], "_forward_pass": 2, "true": [2, 3, 13, 18, 21], "comput": [2, 3, 8, 11, 15, 18, 21, 22], "wrt": 2, "grad_loss": 2, "back": 2, "propag": [2, 19], "through": [2, 11, 16, 18, 19, 22], "entir": [2, 18, 19], "_backward_pass": 2, "fals": [2, 13, 18, 21], "calcul": [2, 3, 13], "output": [2, 10, 11, 13, 14, 16, 18, 19, 21], "nn": [2, 8, 12, 13, 16, 18, 19, 20, 21], "layer_output": 2, "forward_pass": 2, "grad": [2, 11, 13, 18], "revers": [2, 13], "backward_pass": 2, "pic": 2, "page4": 2, "2": [2, 3, 8, 11, 12, 13, 18, 21, 22], "unit": [2, 15], "equat": [2, 3], "backpropag": 2, "within": [2, 3, 12, 21, 22], "paramet": [2, 3, 10, 11, 13, 15, 18, 19, 20, 21], "dim_input": 2, "int": [2, 13], "dimens": [2, 3, 18, 21], "dim_hidden": 2, "hidden": 2, "state": [2, 13, 15, 20], "relu": [2, 12, 13, 18], "bptt_trunc": 2, "time": [2, 3, 8, 13, 14, 18], "step": [2, 3, 8, 11, 13, 15, 18], "input_shap": 2, "5": [2, 11, 12, 13, 19], "w_hh": 2, "matrix": [2, 21], "w_xh": 2, "w_ho": 2, "matric": [2, 3], "limit": [2, 10, 13, 19, 21, 22], "math": 2, "sqrt": 2, "random": [2, 3, 13, 22], "uniform": 2, "w_xh_opt": 2, "copi": [2, 11, 15, 22], "w_hh_opt": 2, "w_ho_opt": 2, "num_paramet": 2, "prod": [2, 18], "gif": 2, "page6": 2, "across": [2, 8, 11, 12, 13, 14, 15, 19, 21], "num_timestep": 2, "layer_input": 2, "save": [2, 8, 15, 20, 21], "backprop": 2, "intermedi": [2, 13, 19], "state_act_input": 2, "zero": [2, 3, 11, 18], "state_act_output": 2, "iter": [2, 3, 8, 13, 14, 18, 22], "t": [2, 3, 8, 18], "matmul": [2, 18, 21], "page7": 2, "accumul": [2, 13], "multipl": [2, 3, 18, 19, 21, 22], "dim_output": 2, "variabl": [2, 11, 22], "appropri": [2, 18], "size": [2, 3, 8, 10, 11, 13, 15, 18, 21], "grad_inp": 2, "zeros_lik": 2, "grad_wxh": 2, "grad_whh": 2, "grad_who": 2, "timestep": 2, "grad_state_act_output": 2, "grad_state_act_input": 2, "bptt": 2, "num_timestamp": 2, "onli": [2, 3, 11, 13, 14, 15, 16, 18, 19, 21, 22], "tt": 2, "arang": 2, "max": [2, 11, 18], "previou": [2, 8, 22], "__call__": 2, "exp": [2, 3, 16], "e_x": 2, "keepdim": 2, "definit": [2, 3, 22], "clf": 2, "adam": 2, "10": [2, 11, 12, 13], "61": 2, "training_loss_acc": 2, "validation_loss_acc": 2, "x_train": 2, "y_train": 2, "300": 2, "512": [2, 18], "x_test": 2, "y_test": 2, "label": [2, 13, 22], "y_test1": 2, "accuracy_scor": 2, "plot": 2, "train_loss": 2, "plt": 2, "titl": 2, "ylabel": 2, "xlabel": 2, "legend": 2, "show": [2, 12, 13, 18, 22], "without": [2, 3, 12, 18, 21, 22], "ani": [2, 3, 8, 11, 12, 13, 18, 22], "high": [2, 3, 8, 11, 15, 21], "level": [2, 3, 11, 12, 13, 15, 19, 21, 22], "framework": [2, 3], "give": [2, 3, 22], "u": [2, 3, 13, 21, 22], "better": [2, 3], "insight": [2, 3], "probabilist": [2, 3], "process": [2, 3, 8, 11, 12, 13, 14, 15, 22], "machin": [2, 3, 8, 11, 13, 14], "learn": [2, 18, 19, 22], "One": [3, 11, 13, 15, 21], "fundament": [3, 22], "problem": 3, "build": [3, 8, 11], "natur": 3, "languag": [3, 8, 21], "system": [3, 11], "question": 3, "how": [3, 11], "repres": [3, 19, 21, 22], "vital": 3, "practic": [3, 19, 21], "applic": [3, 8, 11, 13], "translat": [3, 22], "answer": [3, 22], "inform": [3, 11, 20, 22], "retriev": 3, "summar": 3, "analysi": 3, "text": 3, "speech": 3, "etc": [3, 19, 20, 21, 22], "simplest": [3, 13], "wai": [3, 13, 15, 21, 22], "independ": 3, "drawback": 3, "represent": [3, 18], "column": [3, 21], "": [3, 8, 11, 12, 13, 15, 16, 18, 20, 21, 22], "length": [3, 21, 22], "equal": 3, "vocabulari": [3, 21], "huge": [3, 21], "But": 3, "unfortun": 3, "do": [3, 11, 18, 19, 21], "encod": 3, "notion": 3, "similar": [3, 11, 21], "other": [3, 8, 11, 12, 13, 18, 19, 22], "relationship": [3, 19], "between": [3, 8, 13, 19, 22], "eg": [3, 22], "our": [3, 11, 15, 19], "space": 3, "would": [3, 8, 12, 14, 18, 19, 21], "want": [3, 11, 21, 22], "bank": 3, "financ": 3, "closer": 3, "while": [3, 8, 14, 15, 18, 19], "same": [3, 11, 13, 18, 21, 22], "both": [3, 8, 12, 14, 18, 21, 22], "being": [3, 10, 11, 18, 21], "significantli": [3, 8, 21], "far": 3, "watermelon": 3, "thei": [3, 8, 11, 13, 18, 20, 22], "ar": [3, 8, 11, 13, 15, 18, 19, 20, 21, 22], "close": 3, "order": [3, 11, 13, 16], "overcom": 3, "need": [3, 8, 12, 13, 15, 16, 18, 19, 21, 22], "altern": [3, 22], "amongst": 3, "gener": [3, 13, 17, 19, 21, 22], "base": [3, 8, 13, 19, 22], "hypothesi": 3, "can": [3, 8, 11, 12, 13, 15, 16, 19, 20, 21, 22], "deriv": [3, 22], "distribut": [3, 12, 17, 18, 21, 22], "appear": 3, "seemingli": 3, "simpl": [3, 8, 11, 12, 13, 19, 22], "idea": [3, 21], "most": [3, 8, 11, 22], "influenti": 3, "success": [3, 22], "modern": 3, "nlp": 3, "The": [3, 7, 8, 11, 12, 13, 15, 16, 18, 19, 21, 22], "low": 3, "dimension": [3, 12, 21], "much": [3, 8, 18, 22], "smaller": [3, 15, 21], "than": [3, 8, 10, 14, 15, 22], "let": [3, 8, 11, 12, 13, 21, 22], "v": [3, 16, 17, 21], "total": [3, 11, 13, 18], "d": [3, 12, 13, 21], "store": [3, 11, 22], "respect": [3, 21], "r": 3, "given": [3, 11, 13, 16, 18, 19, 22], "setup": [3, 12, 13], "two": [3, 12, 13, 19, 22], "centr": 3, "like": [3, 13, 15, 18, 19, 21, 22], "occur": [3, 18], "continu": [3, 21], "bag": 3, "Of": [3, 16], "cbow": 3, "surround": 3, "rest": 3, "manner": 3, "specifi": [3, 21, 22], "where": [3, 12, 13, 18, 19, 21], "u_w": 3, "correspond": [3, 13, 15, 18, 22], "likewis": 3, "c": [3, 8, 13], "probabl": [3, 16], "o": [3, 11, 13, 22], "v_c": 3, "specif": [3, 13, 15, 19, 21, 22], "u_o": 3, "assign": [3, 18, 19, 22], "ideal": 3, "more": [3, 8, 11, 13, 15, 16, 21, 22], "least": [3, 13], "express": [3, 21], "mathemat": 3, "pair": 3, "have": [3, 11, 13, 18, 19, 20, 21, 22], "hat": 3, "vocab": 3, "expect": [3, 13, 16, 18, 22], "Will": 3, "actual": [3, 13, 22], "predict": [3, 21], "quantifi": 3, "good": 3, "bad": 3, "cross": [3, 16, 18, 19, 21], "entropi": [3, 16, 21], "particular": [3, 18], "accordingli": 3, "loss": [3, 11, 13, 16], "l_": 3, "sum_": 3, "mathcal": 3, "y_w": 3, "sinc": [3, 13, 18, 21], "reduc": [3, 8, 11, 13, 15, 18, 21], "y_o": 3, "callout": 3, "info": [3, 13, 22], "now": [3, 18, 19, 21], "If": [3, 8, 11, 13, 18, 19, 22], "perfect": 3, "further": [3, 8, 15, 21], "awai": 3, "larger": [3, 10, 13, 15, 18, 21], "function": [3, 8, 13, 16, 19, 21, 22], "minimis": 3, "corpu": 3, "document": 3, "train": [3, 14, 15, 19, 21], "sequenc": [3, 18], "w_": 3, "m": [3, 22], "k": [3, 21], "posit": 3, "integ": 3, "take": [3, 8, 13, 16, 18, 19, 21], "valu": [3, 7, 10, 13, 18, 22], "l": 3, "j": 3, "p_": 3, "It": [3, 8, 11, 12, 13, 19, 21, 22], "observ": [3, 8, 18], "likelihood": 3, "defin": [3, 13, 19, 22], "next": [3, 13, 15, 18, 21], "guid": 3, "x_": 3, "n": [3, 11, 13, 18], "learningr": 3, "nabla_": 3, "section": [3, 13], "begin": [3, 18, 19], "first": [3, 8, 11, 18, 19, 21, 22], "variant": [3, 21], "dfrac": 3, "u_x": 3, "y_x": 3, "so": [3, 8, 11, 13, 15, 18, 19, 21, 22], "what": [3, 8], "doe": [3, 14, 18], "tell": 3, "subtract": 3, "sens": 3, "multipli": [3, 18], "wa": [3, 11, 21], "short": 3, "make": [3, 7, 8, 13, 15, 18, 21, 22], "essenc": 3, "should": [3, 13, 18], "wherea": [3, 18], "select": [3, 22], "veri": [3, 15, 21], "differ": [3, 8, 11, 12, 13, 15, 18, 19, 22], "also": [3, 11, 12, 13, 18, 19, 20, 21], "interest": 3, "note": [3, 13, 22], "u_1": 3, "u_2": 3, "u_": 3, "rewrit": 3, "abov": [3, 12, 13, 21], "term": [3, 21], "enabl": [3, 11, 13, 18, 21, 22], "write": [3, 8, 11, 13, 19], "vectoris": 3, "therebi": 3, "improv": [3, 8, 10, 13, 15, 18, 21], "There": [3, 11, 16, 22], "case": [3, 13, 18], "here": [3, 11, 13, 18, 21], "neq": 3, "combin": [3, 14, 15, 16, 18, 21], "y_1": 3, "y_2": 3, "y_": 3, "thing": [3, 19], "fact": 3, "computation": 3, "expens": 3, "techniqu": [3, 8, 13, 19, 21], "describ": 3, "address": [3, 11, 13, 22], "scale": [3, 8, 11, 15, 19, 21], "ad": [3, 7, 15, 16, 19, 20, 22], "estim": 3, "target": [3, 11, 13, 18], "factor": [3, 8, 18, 22], "non": [3, 11, 22], "dissimilar": 3, "prohibit": 3, "massiv": 3, "avoid": [3, 10, 18, 21, 22], "introduc": [3, 14, 15], "To": [3, 8, 11, 12, 13, 15, 18, 19, 21], "see": [3, 12, 13, 18, 19], "revisit": 3, "instead": [3, 8, 13, 16], "choos": [3, 10], "small": [3, 18], "w_1": 3, "w_2": 3, "w_k": 3, "Their": 3, "sigma": 3, "sigmoid": 3, "partial": 3, "With": [3, 12, 15, 21, 22], "chang": [3, 8, 11, 18, 19, 21, 22], "modifi": 3, "nabla": 3, "when": [3, 8, 11, 12, 14, 15, 18, 22], "those": [3, 18, 19, 21], "w_t": 3, "leq": 3, "arbitrari": [3, 8], "could": [3, 12, 15, 21], "simpli": [3, 20, 21, 22], "individu": [3, 18, 21, 22], "As": [3, 10, 11, 21], "v_": 3, "v_w": 3, "templat": 3, "stanford": 3, "cours": [3, 16], "cs224n": 3, "sentiment": 3, "treebank": 3, "dataset": [3, 11, 13], "start": [3, 11, 13, 22], "import": [3, 7, 12, 13, 18, 19, 21, 22], "librari": [3, 8, 13], "top": [3, 7, 11, 21, 22], "sever": [3, 8], "formula": 3, "earlier": [3, 18], "rate": [3, 18], "tune": 3, "desir": [3, 18], "impli": 3, "ones": [3, 11], "togeth": [3, 19, 21, 22], "push": 3, "even": [3, 14, 21], "llm": [3, 21], "ml": 3, "These": [3, 8, 13, 18, 22], "downstream": 3, "summaris": 3, "lectur": 3, "new": [7, 22], "version": [7, 8, 11, 15, 22], "2020": 7, "12": 7, "28": 7, "beta22": 7, "furo": 7, "fairli": 7, "straightforward": 7, "site": [7, 22], "wide": [7, 11], "announc": 7, "aka": [7, 13], "banner": 7, "page": 7, "websit": [7, 22], "done": [7, 13, 19, 21], "kei": 7, "html_theme_opt": 7, "your": [7, 8, 11, 12, 13, 16, 18], "conf": 7, "py": [7, 12, 13], "file": [7, 11, 13, 22], "html": 7, "includ": [7, 8, 11, 19, 21, 22], "em": 7, "read": [8, 22], "pytorch": [8, 11, 12, 13, 15, 16, 18, 19, 20, 21], "trace": [8, 19], "realli": 8, "happen": [8, 13, 21], "you": [8, 11, 13, 16, 18, 19, 22], "call": [8, 13, 16, 18, 21, 22], "forward": [8, 11, 12, 13, 15, 16, 18, 19, 21, 22], "backward": [8, 11, 13, 15, 18, 19, 21], "profil": 8, "b": 8, "trade": 8, "memori": [8, 10, 13, 15, 18, 21], "keep": [8, 13, 15, 21], "tensor": [8, 10, 11, 13, 17, 18, 19, 20], "aliv": 8, "until": [8, 11], "dure": [8, 13, 15, 21], "region": [8, 13, 18, 22], "omit": 8, "recomput": [8, 13], "them": [8, 11, 18, 21, 22], "pass": [8, 11, 13, 15, 16, 18, 19, 21], "appli": [8, 11, 12, 13, 18], "part": [8, 19, 22], "model": [8, 11, 12, 14, 15, 16, 18, 20], "code": [8, 11, 12, 21, 22], "faster": [8, 18, 22], "jit": 8, "optim": [8, 11, 13, 15, 18, 20, 21], "kernel": 8, "requir": [8, 11, 12, 13, 18, 19, 21, 22], "minim": 8, "python": [8, 13, 20], "callabl": 8, "place": [8, 11, 13, 18], "origin": [8, 19, 21, 22], "opt_func": 8, "func": 8, "decor": 8, "modul": [8, 12, 13, 19, 20, 21], "instanc": [8, 13, 15, 18, 19, 22], "compiled_model": 8, "hold": 8, "refer": [8, 13], "three": [8, 11, 13, 21, 22], "acquisit": 8, "lower": [8, 13, 18, 22], "sourc": [8, 11, 13, 21, 22], "AND": 8, "AS": 8, "dynam": [8, 18, 22], "ever": 8, "lot": [8, 18], "longer": [8, 22], "complet": [8, 18], "compar": [8, 21], "eager": 8, "becaus": [8, 13, 16, 18, 19, 20, 22], "execut": [8, 11, 18], "structur": [8, 19, 22], "doesn": 8, "recompil": 8, "signific": [8, 18], "speedup": 8, "mainli": [8, 13], "come": [8, 11, 13, 15, 19, 21], "overhead": [8, 13, 14, 15, 21], "mai": [8, 16, 18, 21], "vari": 8, "architectur": [8, 18, 22], "batch": [8, 10, 11, 13, 15, 18, 19, 21], "exampl": [8, 11, 12, 13, 18, 19, 21, 22], "amount": [8, 21, 22], "larg": [8, 11, 15, 18, 19, 21], "bottleneck": [8, 21], "less": 8, "mode": [8, 13], "cuda": [8, 11, 12, 13, 21], "second": [8, 19, 22], "slower": [8, 14, 19], "although": 8, "few": [8, 13, 18], "warm": 8, "up": [8, 12, 15, 18, 19, 21, 22], "respons": [8, 19, 21, 22], "extract": 8, "analyz": [8, 13], "bytecod": 8, "runtim": [8, 19, 21], "detect": 8, "oper": [8, 11, 13, 15, 18, 19, 21], "torchinductor": 8, "anoth": [8, 19, 22], "allow": [8, 11, 12, 13, 15, 18, 19, 21, 22], "backend": [8, 13], "encount": 8, "unsupport": 8, "featur": [8, 19], "depend": [8, 19, 21], "control": [8, 11, 13], "flow": [8, 18, 19], "break": [8, 13], "default": [8, 11, 13, 21, 22], "interpret": 8, "handl": [8, 19], "resum": [8, 13], "captur": [8, 19], "highlight": 8, "major": 8, "solut": [8, 12], "either": [8, 13, 22], "error": 8, "silent": 8, "fail": [8, 18], "hand": 8, "some": [8, 13, 15, 22], "pronounc": 8, "nickel": 8, "stand": [8, 19], "alon": [8, 21], "standard": [8, 11], "commun": [8, 12, 15, 19, 21, 22], "routin": 8, "gather": [8, 11, 14, 15, 21], "broadcast": [8, 11, 13], "scatter": [8, 11, 14, 15], "well": [8, 20], "send": [8, 11, 13, 18, 19, 22], "receiv": [8, 11, 22], "pattern": [8, 11, 21], "been": [8, 11, 18, 19], "achiev": [8, 11, 16], "bandwidth": [8, 10, 19], "platform": 8, "pcie": 8, "nvlink": [8, 21], "nvswitch": 8, "network": [8, 13, 16, 18, 22], "infiniband": 8, "verb": 8, "tcp": [8, 11, 22], "ip": [8, 11, 13, 22], "socket": 8, "support": [8, 11, 13, 15, 19, 22], "instal": 8, "node": [8, 12], "multi": [8, 12, 13, 14, 21], "e": [8, 12, 18, 19, 20, 21, 22], "g": [8, 18, 19, 22], "collect": [8, 13, 14, 15, 18, 21], "algorithm": [8, 11, 21], "barrier": [8, 11, 13], "allreduc": [8, 13, 21], "messag": [8, 11], "interfac": [8, 11, 13], "portabl": 8, "api": [8, 11, 12, 13, 15, 21], "via": [8, 11, 12, 21], "point": [8, 13, 18, 19, 21], "frequent": 8, "hpc": 8, "cluster": [8, 11, 15, 19], "directli": [8, 13, 16, 19], "fortran": 8, "abl": [8, 11], "divis": 10, "4": [10, 11, 12, 13, 19], "tf32": 10, "8": [10, 12, 13, 18, 21], "fp16": 10, "16": [10, 13], "int8": 10, "effici": [10, 13, 15, 21], "core": [10, 13, 18, 21], "best": [10, 11, 22], "a100": [10, 15], "32": [10, 13], "64": [10, 21], "128": [10, 18, 21], "parallel": [10, 11, 12, 14, 15, 17], "rough": [10, 18], "guidelin": 10, "neuron": 10, "count": 10, "greater": 10, "doc": [11, 13, 18, 19, 21], "packag": [11, 13, 18, 19], "torch": [11, 12, 16, 20, 21], "research": 11, "practition": 11, "easili": [11, 12, 13, 16, 20, 21], "leverag": [11, 12, 21], "semant": 11, "oppos": 11, "multiprocess": [11, 13], "restrict": 11, "init_process": 11, "ensur": [11, 15], "everi": [11, 13, 21], "coordin": 11, "master": 11, "port": 11, "rank": [11, 12, 13, 15, 19], "fn": 11, "gloo": [11, 13], "environ": [11, 13, 19, 21], "master_addr": [11, 13], "127": 11, "master_port": 11, "29500": [11, 13], "dist": [11, 13, 18], "init_process_group": [11, 13], "world_siz": [11, 13], "__name__": [11, 13], "__main__": [11, 13], "mp": [11, 13], "set_start_method": 11, "spawn": [11, 13], "arg": [11, 13], "join": [11, 13], "fine": 11, "grain": 11, "fanci": 11, "baidu": 11, "deepspeech": 11, "facebook": 11, "experi": [11, 15], "dst": 11, "block": [11, 13, 21, 22], "req": 11, "isend": 11, "els": [11, 18, 19], "recv": [11, 19], "src": 11, "irecv": 11, "wait": [11, 13], "after": [11, 13, 15, 18, 19, 21], "guarante": 11, "took": 11, "print": [11, 13, 18, 19], "communc": 11, "group": [11, 12, 13, 19], "A": [11, 13, 18, 19, 20, 22], "subset": 11, "creat": [11, 12, 13, 18, 19, 21, 22], "list": 11, "new_group": 11, "By": [11, 21], "known": [11, 21], "world": [11, 13, 21, 22], "obtain": [11, 16, 22], "all_reduc": 11, "op": [11, 13, 19], "work": [11, 12, 14, 18, 22], "element": 11, "wise": [11, 21], "reduceop": 11, "product": 11, "min": 11, "6": 11, "result": [11, 18, 21, 22], "scatter_list": 11, "ith": 11, "gather_list": 11, "all_gath": [11, 15], "tensor_list": 11, "enter": [11, 22], "stochast": 11, "script": [11, 18], "averag": [11, 13], "split": [11, 22], "converg": [11, 18, 21], "partit": [11, 19], "assum": 11, "replica": [11, 13, 15], "num_train_sampl": 11, "divid": [11, 19, 22], "maintain": [11, 15, 18, 22], "overal": [11, 19], "synchron": [11, 13, 18], "manual_se": 11, "1234": 11, "train_set": [11, 13], "bsz": 11, "partition_dataset": 11, "net": [11, 18, 22], "lr": [11, 13, 18], "01": 11, "momentum": 11, "num_batch": [11, 18], "ceil": 11, "float": [11, 18, 21], "epoch_loss": 11, "zero_grad": [11, 13, 18], "f": [11, 13, 16, 21], "nll_loss": [11, 18], "item": [11, 18], "average_gradi": 11, "get_rank": [11, 13], "get_world_s": 11, "param": [11, 13], "eleg": 11, "aspect": [11, 19], "its": [11, 12, 13, 15, 18, 19, 20, 21, 22], "abil": [11, 21], "abstract": [11, 12, 13, 21], "mention": [11, 21], "befor": [11, 12, 13, 18, 19, 21], "nccl": [11, 12, 13, 21], "mpi": 11, "cpu": [11, 13, 15, 18], "gpu": [11, 13, 15, 18, 21], "provid": [11, 13, 18, 19, 21, 22], "tool": [11, 13, 19], "field": [11, 13], "perform": [11, 12, 13, 15, 18, 21, 22], "main": [11, 13], "inspir": 11, "advantag": [11, 13], "li": 11, "avail": 11, "against": 11, "consid": [11, 19, 22], "pre": [11, 21], "built": [11, 13], "binari": 11, "four": 11, "properli": [11, 13], "connect": [11, 12, 21, 22], "about": [11, 12, 20, 22], "final": [11, 15, 16, 21], "handshak": 11, "free": 11, "host": [11, 12, 13, 19, 21, 22], "know": [11, 19, 22], "mani": [11, 18, 21], "worker": [11, 13, 15], "whether": 11, "share": [11, 13], "filesystem": 11, "access": [11, 12, 19, 20], "open": [11, 22], "everybodi": 11, "did": 11, "readili": 11, "reachabl": 11, "exchang": 11, "reach": [11, 15, 22], "higher": 12, "manag": [12, 13, 18, 19, 21, 22], "processgroup": [12, 21], "user": [12, 13, 19, 21, 22], "effortlessli": 12, "inter": [12, 13, 21], "intra": [12, 13, 21], "worri": 12, "correctli": [12, 19], "sub": [12, 21], "underli": 12, "process_group": 12, "3": [12, 13, 18], "compos": [12, 19], "imag": [12, 13], "2d": 12, "counterpart": 12, "homogen": 12, "manual": [12, 18], "quit": 12, "complic": 12, "help": [12, 13, 18], "init_device_mesh": [12, 21], "accomplish": 12, "just": [12, 13, 15, 21], "line": 12, "still": 12, "device_mesh": [12, 21], "mesh_2d": [12, 21], "mesh_dim_nam": 12, "replic": [12, 13, 14, 15, 21], "shard": [12, 13, 15, 21], "thru": 12, "get_group": 12, "replicate_group": 12, "mesh_dim": 12, "shard_group": 12, "snippet": 12, "elast": [12, 13, 22], "torchrun": 12, "nproc_per_nod": [12, 13], "2d_setup_with_device_mesh": 12, "hybrid": 12, "strategi": [12, 13], "fsdp": [12, 13, 17, 19], "ddp": [12, 17, 19, 21], "assist": 12, "toymodel": [12, 13], "super": [12, 13], "net1": [12, 13], "linear": [12, 13, 18, 20, 21], "net2": [12, 13], "meshshap": 12, "sharding_strategi": 12, "shardingstrategi": 12, "hybrid_shard": 12, "Then": [12, 13, 15, 19], "command": [12, 13], "tutori": [13, 21], "per": [13, 14, 15, 19], "buffer": [13, 19, 20], "regist": [13, 20, 21, 22], "autograd": [13, 18], "fire": 13, "signal": 13, "trigger": 13, "pleas": 13, "design": 13, "detail": 13, "recommend": [13, 18], "span": 13, "devic": [13, 15, 17, 18, 19, 21], "cannot": [13, 22], "wrap": [13, 15, 19], "clean": 13, "were": 13, "local": [13, 21, 22], "alreadi": [13, 21], "contain": [13, 16, 18, 20, 22], "basic": [13, 21], "loc": 13, "advanc": 13, "caveat": 13, "caution": 13, "construct": [13, 18, 19], "ddp_model": 13, "device_id": 13, "loss_fn": [13, 18], "mseloss": [13, 18], "001": [13, 18], "randn": [13, 18, 19], "20": 13, "nproc": 13, "wrapper": 13, "compil": 13, "graph": [13, 19], "bucket": [13, 22], "reli": 13, "c10d": 13, "henc": 13, "must": [13, 18, 19, 22], "constructor": [13, 15, 18], "state_dict": 13, "sure": [13, 18, 21], "exact": 13, "later": [13, 19], "care": 13, "organ": 13, "bucket_cap_mb": 13, "argument": [13, 18, 19], "map": [13, 20, 22], "determin": [13, 19, 21, 22], "alloc": [13, 19], "roughli": 13, "reason": 13, "becom": [13, 21], "readi": 13, "approxim": 13, "besid": 13, "find_unused_paramet": 13, "subgraph": 13, "find": [13, 22], "out": [13, 21], "travers": 13, "mark": [13, 21], "unus": 13, "reduct": [13, 18], "invok": [13, 18], "kick": 13, "off": 13, "asynchron": 13, "finish": 13, "written": 13, "perspect": 13, "sync": [13, 15], "hpp": 13, "box": 13, "name": [13, 21], "processgroupgloo": 13, "processgroupnccl": 13, "processgroupmpi": 13, "entri": [13, 20, 22], "Its": [13, 15], "_sync_param": 13, "cpp": 13, "comm": 13, "h": [13, 21], "coalesc": [13, 18], "helper": [13, 19], "autograd_hook": 13, "engin": 13, "prepare_for_backward": 13, "aotautograd": 13, "prevent": [13, 18, 22], "whole": [13, 19], "logic": 13, "boundari": 13, "goal": 13, "schedul": 13, "common": 13, "recov": [13, 15, 18], "correct": 13, "demo_checkpoint": 13, "checkpoint_path": 13, "tempfil": 13, "gettempdir": 13, "therefor": [13, 16, 18], "suffici": 13, "map_loc": 13, "load_state_dict": 13, "Not": 13, "necessari": [13, 21], "guard": 13, "delet": [13, 19], "below": [13, 18, 21, 22], "serv": [13, 18, 22], "remov": 13, "cleanup": 13, "output_devic": 13, "NOT": 13, "proper": [13, 21], "toympmodel": 13, "dev0": 13, "dev1": 13, "demo_model_parallel": 13, "mp_model": 13, "ddp_mp_model": 13, "n_gpu": 13, "device_count": 13, "assert": [13, 18, 19], "got": 13, "run_demo": 13, "demo_bas": 13, "overrid": 13, "vanilla": 13, "loop": [13, 19], "register_comm_hook": 13, "flexibl": 13, "increas": [13, 15, 18, 21], "move": 13, "id": 13, "destroy_process_group": 13, "nnode": 13, "rdzv_id": 13, "100": 13, "rdzv_backend": 13, "rdzv_endpoint": 13, "29400": 13, "elastic_ddp": 13, "export": [13, 19], "scontrol": 13, "hostnam": 13, "slurm_nodelist": 13, "head": [13, 21], "srun": 13, "torchrun_script": 13, "sh": 13, "typic": [13, 19, 21, 22], "footprint": [13, 15], "consist": [13, 19, 21, 22], "activ": [13, 15, 21, 22], "capac": 13, "accomod": 13, "full": [13, 15, 18, 19], "grow": [13, 22], "aggress": 13, "might": [13, 22], "approach": 13, "fulli": [13, 15, 21], "multinod": 13, "util": [13, 18, 19, 21, 22], "dataload": 13, "datautil": 13, "mytraindataset": 13, "distributedsampl": 13, "ddp_setup": 13, "set_devic": 13, "local_rank": 13, "trainer": 13, "train_data": 13, "save_everi": 13, "snapshot_path": 13, "str": 13, "global_rank": 13, "epochs_run": 13, "path": [13, 15], "exist": 13, "snapshot": 13, "_load_snapshot": 13, "model_st": 13, "_run_batch": 13, "cross_entropi": [13, 18], "_run_epoch": 13, "b_sz": 13, "batchsiz": 13, "sampler": 13, "set_epoch": 13, "_save_snapshot": 13, "max_epoch": 13, "load_train_obj": 13, "2048": 13, "prepare_dataload": 13, "pin_memori": 13, "shuffl": 13, "total_epoch": 13, "pt": 13, "argpars": 13, "parser": 13, "argumentpars": 13, "descript": 13, "add_argu": 13, "type": [13, 15, 21], "often": [13, 18, 19, 21, 22], "parse_arg": 13, "east": 13, "ubuntu1804": 13, "sharedstorag": 13, "mountdir": 13, "storagetyp": 13, "fsxlustr": 13, "fsxlustreset": 13, "storagecapac": 13, "1200": 13, "deploymenttyp": 13, "scratch_1": 13, "ssd": 13, "headnod": 13, "instancetyp": 13, "c5": 13, "xlarg": 13, "subnetid": 13, "subnet": [13, 22], "xxxxxxx": 13, "ssh": 13, "keynam": 13, "slurmqueu": 13, "computeresourc": 13, "p32xlarg": 13, "p3": 13, "2xlarg": 13, "mincount": 13, "maxcount": 13, "bin": 13, "bash": 13, "sbatch": 13, "ntask": 13, "task": [13, 18], "slurm_job_nodelist": 13, "nodes_arrai": 13, "head_nod": 13, "head_node_ip": 13, "echo": 13, "loglevel": 13, "multinode_torchrun": 13, "50": [13, 18], "real": 13, "mingpt": 13, "1t": [13, 15], "dataparallel": 14, "thread": 14, "distributeddataparallel": [14, 15], "usual": [14, 15, 18, 21, 22], "due": [14, 21], "gil": 14, "content": [14, 22], "addit": [14, 15, 19, 21, 22], "mar": 15, "2022": 15, "11": 15, "re": 15, "nativ": [15, 21], "heavili": 15, "borrow": 15, "fairscal": 15, "bring": [15, 22], "streamlin": 15, "realiz": 15, "84": 15, "tflop": 15, "gpt": [15, 19], "159": 15, "175b": 15, "aw": 15, "unlik": 15, "tradit": 15, "option": [15, 18, 22], "offload": 15, "layer": [15, 16, 18, 19, 20], "nest": 15, "freed": 15, "immedi": [15, 18], "peak": 15, "thu": 15, "maxim": 15, "own": [15, 22], "feasibl": 15, "fit": 15, "cost": [15, 21], "volum": 15, "intern": [15, 22], "overlap": 15, "discard": [15, 22], "reduce_scatt": [15, 21], "view": 15, "decompos": 15, "possess": 15, "subsequ": 15, "logsoftmax": 16, "softmax": [16, 18], "stackoverflow": 16, "ye": 16, "nllloss": 16, "why": 16, "log_softmax": [16, 18], "stabl": 16, "said": [16, 19, 22], "And": 16, "raw": 16, "logit": 16, "neural": 16, "last": [16, 21], "prefer": 16, "extra": 16, "mix": 17, "precis": 17, "under": [17, 18, 21], "hood": [17, 21], "dp": [17, 21], "pipelin": 17, "mesh": [17, 21], "conveni": 18, "datatyp": 18, "lower_precision_fp": 18, "half": 18, "bfloat16": 18, "tri": [18, 22], "match": 18, "convolut": [18, 20], "primarili": 18, "benefit": 18, "volta": 18, "ture": 18, "amper": 18, "recip": 18, "3x": 18, "On": 18, "kepler": 18, "maxwel": 18, "pascal": 18, "modest": 18, "greatest": 18, "satur": 18, "bound": 18, "won": 18, "chosen": 18, "particip": 18, "permit": 18, "usag": 18, "capabl": [18, 21], "in_siz": 18, "out_siz": 18, "num_lay": 18, "enough": 18, "produc": 18, "magnitud": 18, "flush": 18, "underflow": 18, "lost": 18, "word": 18, "don": 18, "attribut": 18, "unscal": 18, "interfer": 18, "addbmm": 18, "bmm": 18, "chain_matmul": 18, "multi_dot": 18, "conv1d": 18, "conv2d": 18, "conv3d": 18, "grucel": 18, "lstmcell": 18, "mm": 18, "mv": 18, "prelu": 18, "rnncell": 18, "binary_cross_entropy_with_logit": 18, "cosine_similar": 18, "cumsum": 18, "l1_loss": 18, "layer_norm": 18, "mse_loss": 18, "norm": [18, 19, 21], "normal": 18, "pow": 18, "soft_margin_loss": 18, "softmin": 18, "softplu": 18, "dtype": 18, "stabil": 18, "cast": 18, "addcdiv": 18, "addcmul": 18, "bilinear": 18, "dot": [18, 22], "grid_sampl": 18, "scatter_add": 18, "tensordot": 18, "gc": 18, "start_tim": 18, "measur": 18, "report": 18, "yet": [18, 19], "pick": 18, "synchronis": 18, "global": [18, 21, 22], "empty_cach": 18, "reset_max_memory_alloc": 18, "end_timer_and_print": 18, "local_msg": 18, "end_tim": 18, "3f": 18, "sec": 18, "format": 18, "byte": 18, "max_memory_alloc": 18, "make_model": 18, "_": 18, "sequenti": 18, "tupl": 18, "try": 18, "256": [18, 21, 22], "513": 18, "4096": 18, "is_avail": 18, "set_default_devic": 18, "trial": 18, "opt": 18, "zip": 18, "set_to_non": 18, "modestli": 18, "context": 18, "device_typ": 18, "exit": 18, "chose": 18, "scaler": 18, "onc": 18, "dedic": 18, "fresh": 18, "lightweight": 18, "otherwis": 18, "skip": 18, "demonstr": 18, "use_amp": 18, "unscale_": 18, "max_norm": 18, "clip_grad_norm_": 18, "effect": [18, 19, 21], "batch_per_it": 18, "iters_to_accumul": 18, "num_proc": 18, "calibr": 18, "check": 18, "found": 18, "granular": 18, "remain": 18, "constant": 18, "imposs": 18, "enumer": [18, 21], "commonli": 18, "matter": 18, "rule": 18, "thumb": 18, "oom": 18, "excess": [18, 21], "friendli": 18, "disabl": 18, "persist": 18, "introduct": 19, "primit": [19, 21], "deep": 19, "micro": 19, "concurr": [19, 21], "infer": 19, "promis": 19, "difficult": 19, "intrus": 19, "complex": 19, "toolkit": 19, "easi": [19, 21], "frontend": 19, "stage": 19, "rich": 19, "gpipe": 19, "1f1b": 19, "interleav": 19, "bf": 19, "infrastrutur": 19, "custom": [19, 22], "pp": 19, "interconnect": 19, "peer": 19, "consum": 19, "static": [19, 22], "schedulegpip": 19, "n_microbatch": 19, "in_dim": 19, "microbatch": 19, "relev": 19, "meta": 19, "num_stag": 19, "transform": [19, 21], "stage_index": 19, "prepar": 19, "del": 19, "elif": 19, "tok_embed": [19, 21], "input_arg": 19, "example_input_microbatch": 19, "worth": 19, "splitpoint": 19, "longtensor": 19, "pipe": 19, "mod": 19, "mb_arg": 19, "split_spec": 19, "certain": [19, 21], "submodul": 19, "similarli": 19, "graphmodul": 19, "submod_0": 19, "emb": 19, "interpretermodul": 19, "lin": 19, "submod_1": 19, "lm": [19, 21], "proj": 19, "reconstruct": 19, "hierarchi": [19, 22], "root": [19, 22], "Such": 19, "replai": 19, "fashion": [19, 21], "turn": 19, "direct": [19, 22], "acycl": 19, "dag": 19, "convent": 19, "children": 19, "cut": 19, "extend": [19, 22], "pipelineschedulesingl": 19, "pipelineschedulemulti": 19, "style": [19, 21], "learnabl": 20, "bias": 20, "dictionari": 20, "alter": 20, "restor": 20, "great": 20, "deal": 20, "modular": 20, "batchnorm": 20, "running_mean": 20, "hyperparamet": 20, "tp": 21, "propos": 21, "megatron": 21, "paper": 21, "sp": 21, "parallelstyl": 21, "parallelize_modul": 21, "swap": 21, "dtensor": 21, "foward": 21, "layout": 21, "allgath": 21, "embed": 21, "howev": 21, "quantiti": 21, "challeng": 21, "aris": 21, "exceed": 21, "domin": 21, "ring": 21, "latenc": [21, 22], "consequ": 21, "decreas": 21, "hit": 21, "ballpark": 21, "yield": 21, "flop": 21, "billion": 21, "trillion": 21, "token": 21, "month": 21, "thousand": 21, "alwai": 21, "llama": 21, "70b": 21, "2k": 21, "35": 21, "dai": 21, "quickli": 21, "constraint": 21, "1k": 21, "offer": 21, "configur": [21, 22], "colwiseparallel": 21, "rowwiseparallel": 21, "row": 21, "sequenceparallel": 21, "dropout": 21, "rmsnormpython": 21, "preparemoduleinput": 21, "preparemoduleoutput": 21, "program": 21, "spmd": 21, "devicemesh": 21, "transformerblock": 21, "look": 21, "simpler": 21, "swiglu": 21, "mlp": 21, "w2": 21, "silu": 21, "w1": 21, "w3": 21, "project": 21, "colwis": 21, "rowwis": 21, "parallelize_plan": 21, "layer_tp_plan": 21, "feed_foward": 21, "feed_forward": 21, "wq": 21, "wk": 21, "wv": 21, "q": 21, "wo": 21, "intend": 21, "plan": 21, "insid": 21, "hook": 21, "layer_id": 21, "transformer_block": 21, "adjust": 21, "attn_lay": 21, "n_head": 21, "tp_mesh": 21, "n_kv_head": 21, "illustr": 21, "feed": [21, 22], "residu": 21, "attention_norm": 21, "ffn_norm": 21, "input_layout": 21, "desired_input_layout": 21, "output_layout": 21, "relat": [21, 22], "consumpt": 21, "speed": 21, "pictur": 21, "briefli": 21, "use_local_output": 21, "incur": 21, "fast": 21, "channel": 21, "fullyshardeddataparallel": 21, "submesh": 21, "dp_mesh": 21, "tp_plan": 21, "model_tp": 21, "model_2d": 21, "use_orig_param": 21, "separ": [21, 22], "microsoft": 22, "amazon": 22, "servic": 22, "human": 22, "readabl": 22, "www": 22, "com": 22, "numer": 22, "192": 22, "internet": 22, "phone": 22, "book": 22, "request": 22, "browser": 22, "foundat": 22, "peopl": 22, "hierarch": 22, "variou": 22, "form": 22, "tree": 22, "mydomain": 22, "figur": 22, "author": 22, "client": 22, "resolv": 22, "unnam": 22, "indic": 22, "countri": 22, "busi": 22, "commerci": 22, "tld": 22, "edu": 22, "org": 22, "gov": 22, "subdomain": 22, "depart": 22, "geograph": 22, "locat": 22, "leaf": 22, "identifi": 22, "leftmost": 22, "cheat": 22, "sheet": 22, "ttl": 22, "long": 22, "expir": 22, "inherit": 22, "minimum": 22, "hour": 22, "soa": 22, "compet": 22, "diagram": 22, "overview": 22, "recurs": 22, "authorit": 22, "mere": 22, "sent": 22, "forc": 22, "respond": 22, "failur": 22, "contact": 22, "zone": 22, "escal": 22, "outsid": 22, "attempt": 22, "isp": 22, "portion": 22, "among": 22, "primari": 22, "secondari": 22, "stub": 22, "belong": 22, "made": 22, "superus": 22, "planet": 22, "essenti": 22, "13": 22, "organis": 22, "around": 22, "prefix": 22, "letter": 22, "upto": 22, "nearli": 22, "120": 22, "technic": 22, "backbon": 22, "ddo": 22, "attck": 22, "down": 22, "govern": 22, "privat": 22, "compani": 22, "googl": 22, "opendn": 22, "stuff": 22, "registrar": 22, "namecheap": 22, "icann": 22, "charg": 22, "registr": 22, "fee": 22, "cctld": 22, "tk": 22, "internation": 22, "idn": 22, "latin": 22, "charact": 22, "gtld": 22, "aero": 22, "arpa": 22, "protocol": 22, "automat": 22, "mask": 22, "gatewai": 22, "pool": 22, "leas": 22, "rather": 22, "perman": 22, "realloc": 22, "http": 22, "cloudn": 22, "blog": 22, "vpc": 22, "outpost": 22, "rack": 22, "premis": 22, "polici": 22, "failov": 22, "passiv": 22, "geoloc": 22, "geoproxim": 22, "shift": 22, "multivalu": 22, "eight": 22, "healthi": 22, "proport": 22, "expos": 22, "public": 22, "visitor": 22, "outag": 22, "elb": 22, "integr": 22, "load": 22, "balanc": 22, "alia": 22, "cloudfront": 22, "s3": 22, "cidr": 22, "24": 22, "ipv4": 22, "48": 22, "ipv6": 22, "contigu": 22, "act": 22, "intermediari": 22, "bar": 22, "goe": 22, "ec2": 22, "virtual": 22, "cloud": 22, "234": 22, "prepend": 22, "account": 22, "seattl": 22, "submit": 22}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"home": 0, "natur": 1, "languag": 1, "process": 1, "recurr": 2, "neural": 2, "network": 2, "task": 2, "loss": [2, 18, 21], "function": [2, 11], "cross": 2, "entropi": 2, "optim": 2, "ml": 2, "model": [2, 3, 13, 19, 21], "initialis": 2, "ad": [2, 18], "layer": [2, 10, 21], "fit": 2, "train": [2, 8, 9, 11, 13, 18], "batch": 2, "test": 2, "forward": 2, "pass": 2, "backward": 2, "predict": [2, 7], "rnn": 2, "activ": [2, 8], "sigmoid": 2, "softmax": [2, 3], "dataset": 2, "build": [2, 19], "evalu": 2, "summari": [2, 3], "refer": [2, 3, 15, 18, 19, 21, 22], "word2vec": 3, "notat": 3, "intuit": 3, "code": [3, 13, 18, 19], "structur": 3, "learn": [3, 8], "algorithm": 3, "stochast": 3, "gradient": [3, 18], "descent": 3, "naiv": 3, "wrt": 3, "center": 3, "word": 3, "vector": 3, "outsid": 3, "neg": 3, "sampl": [3, 13, 18, 19], "matrix": 3, "skip": 3, "gram": 3, "accumul": [3, 18], "over": 3, "an": [3, 13], "entir": 3, "context": 3, "window": 3, "us": [3, 12, 13, 19], "numpi": 3, "result": 3, "visualis": 3, "ada": 4, "ecom": 5, "past": 6, "experi": 6, "analyt": 7, "iot": 7, "distribut": [8, 9, 11, 13, 19], "resourc": [8, 22], "checkpoint": [8, 13], "singl": 8, "gpu": 8, "automat": [8, 18, 19], "mix": [8, 18], "precis": [8, 18], "static": 8, "graph": 8, "torch": [8, 13, 18, 19], "compil": 8, "how": [8, 12, 13, 15, 19, 21, 22], "work": [8, 13, 15, 21], "torchdynamo": [8, 13], "fx": 8, "multipl": [8, 13], "data": [8, 13], "parallel": [8, 13, 19, 21], "deepspe": 8, "glossari": 8, "nccl": 8, "gloo": 8, "mpi": 8, "pytorch": [9, 17], "optimis": 10, "linear": 10, "checklist": 10, "ddp": [11, 13, 14, 15], "under": 11, "hood": 11, "point": 11, "commun": [11, 13], "collect": 11, "replic": [11, 22], "distributeddataparallel": [11, 13], "backend": 11, "initi": [11, 13], "method": 11, "devic": 12, "mesh": 12, "what": [12, 19, 22], "i": [12, 13, 18, 19, 22], "devicemesh": 12, "why": [12, 19, 21], "hsdp": 12, "implement": [13, 19], "processgroup": 13, "ddpoptim": 13, "overlap": 13, "comput": [13, 24], "save": 13, "load": 13, "combin": 13, "hook": 13, "run": 13, "torchrun": 13, "when": [13, 21], "enough": 13, "node": 13, "option": [13, 19], "slurm": 13, "configur": 13, "set": 13, "up": 13, "aw": [13, 22], "cluster": 13, "script": 13, "launch": 13, "job": 13, "further": 13, "read": 13, "dp": 14, "v": [14, 15], "fsdp": [15, 21], "gener": 16, "scale": 18, "cuda": 18, "op": 18, "specif": 18, "behavior": 18, "some": 18, "can": 18, "autocast": 18, "float16": 18, "float32": 18, "promot": 18, "widest": 18, "input": 18, "type": [18, 22], "With": 18, "default": 18, "gradscal": 18, "typic": 18, "penalti": 18, "troubleshoot": 18, "speedup": 18, "amp": 18, "minor": 18, "inf": 18, "nan": 18, "pipelin": 19, "step": 19, "1": 19, "pipelinestag": 19, "2": 19, "pipelineschedul": 19, "execut": 19, "split": 19, "manual": 19, "doe": [19, 22], "api": 19, "your": [19, 22], "own": 19, "schedul": 19, "state_dict": 20, "tensor": 21, "you": 21, "should": 21, "appli": 21, "llama2": 21, "feedforward": 21, "attent": 21, "sequenc": 21, "layernorm": 21, "rmsnorm": 21, "domain": 22, "name": 22, "system": 22, "dn": 22, "namespac": 22, "organ": 22, "record": 22, "time": 22, "live": 22, "rout": 22, "traffic": 22, "To": 22, "web": 22, "applic": 22, "queri": 22, "databas": 22, "cach": 22, "befor": 22, "hit": 22, "infrastructur": 22, "who": 22, "control": 22, "server": 22, "dhcp": 22, "53": 22, "featur": 22, "concept": 22, "imag": 23, "segment": 23, "vision": 24}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 58}, "alltitles": {"Home": [[0, "home"]], "Natural Language Processing": [[1, "natural-language-processing"]], "Recurrent Neural Networks": [[2, "recurrent-neural-networks"]], "Task": [[2, "task"]], "Loss Function: Cross Entropy Loss": [[2, "loss-function-cross-entropy-loss"]], "Optimizers": [[2, "optimizers"]], "ML Model": [[2, "ml-model"]], "Model: Neural Network": [[2, "model-neural-network"]], "Initialise": [[2, "initialise"], [2, "id1"]], "Adding layers": [[2, "adding-layers"]], "Fit the model": [[2, "fit-the-model"]], "Train on a batch": [[2, "train-on-a-batch"]], "Test on a batch": [[2, "test-on-a-batch"]], "Forward Pass": [[2, "forward-pass"], [2, "id2"]], "Backward Pass": [[2, "backward-pass"], [2, "id3"]], "Predict": [[2, "predict"]], "Layers: RNN": [[2, "layers-rnn"]], "Activation: Sigmoid": [[2, "activation-sigmoid"]], "Activation: Softmax": [[2, "activation-softmax"]], "Dataset": [[2, "dataset"]], "Build and fit the Model": [[2, "build-and-fit-the-model"]], "Evaluation": [[2, "evaluation"]], "Summary": [[2, "summary"], [3, "summary"]], "References": [[2, "references"], [3, "references"], [15, "references"], [18, "references"], [18, "id1"], [19, "references"], [21, "references"], [22, "references"]], "Word2Vec": [[3, "word2vec"]], "Word2Vec Model": [[3, "word2vec-model"]], "Notation": [[3, "notation"]], "Model": [[3, "model"]], "Intuition": [[3, "intuition"]], "Code structuring": [[3, "code-structuring"]], "Learning Algorithm: Stochastic Gradient Descent": [[3, "learning-algorithm-stochastic-gradient-descent"]], "Naive-Softmax: Gradient wrt Center word vector": [[3, "naive-softmax-gradient-wrt-center-word-vector"]], "Naive-Softmax: Gradient wrt outside word vectors": [[3, "naive-softmax-gradient-wrt-outside-word-vectors"]], "Negative Sampling": [[3, "negative-sampling"]], "Negative-Sampling: Gradient wrt Center word vector": [[3, "negative-sampling-gradient-wrt-center-word-vector"]], "Negative-Sampling: Gradient wrt Outside word Matrix": [[3, "negative-sampling-gradient-wrt-outside-word-matrix"]], "Skip-gram: Accumulated Gradients over an entire context window": [[3, "skip-gram-accumulated-gradients-over-an-entire-context-window"]], "Code: Word2vec using Numpy": [[3, "code-word2vec-using-numpy"]], "Results: Visualisation": [[3, "results-visualisation"]], "ADAS": [[4, "adas"]], "Ecom": [[5, "ecom"]], "Past Experiences": [[6, "past-experiences"]], "Predictive Analytics in IoT": [[7, "predictive-analytics-in-iot"]], "Distributed Training": [[8, "distributed-training"]], "Learning Resources": [[8, "learning-resources"]], "Activation checkpointing": [[8, "activation-checkpointing"]], "Single GPU": [[8, "single-gpu"]], "Automatic Mixed Precision": [[8, "automatic-mixed-precision"]], "Static Graphs with Torch.Compile": [[8, "static-graphs-with-torch-compile"]], "How torch.compile works ?": [[8, "how-torch-compile-works"]], "TorchDynamo and FX Graphs": [[8, "torchdynamo-and-fx-graphs"]], "Multiple GPUs": [[8, "multiple-gpus"]], "Distributed Data Parallel": [[8, "distributed-data-parallel"], [13, "distributed-data-parallel"]], "DeepSpeed": [[8, "deepspeed"]], "Glossary": [[8, "glossary"]], "NCCL": [[8, "nccl"]], "Gloo": [[8, "gloo"]], "MPI": [[8, "mpi"]], "PyTorch, Distributed Training": [[9, "pytorch-distributed-training"]], "Optimising Linear Layers": [[10, "optimising-linear-layers"]], "Checklist": [[10, "checklist"]], "DDP: Under the Hood": [[11, "ddp-under-the-hood"]], "Point-to-point communication": [[11, "point-to-point-communication"]], "Collective communication": [[11, "collective-communication"]], "Distributed Training:": [[11, "distributed-training"]], "Replicate the functionality of DistributedDataParallel": [[11, "replicate-the-functionality-of-distributeddataparallel"]], "Communication Backends": [[11, "communication-backends"]], "Initialization Methods": [[11, "initialization-methods"]], "Device Mesh": [[12, "device-mesh"]], "What is DeviceMesh ?": [[12, "what-is-devicemesh"]], "Why DeviceMesh is Useful ?": [[12, "why-devicemesh-is-useful"]], "How to use DeviceMesh with HSDP ?": [[12, "how-to-use-devicemesh-with-hsdp"]], "DistributedDataParallel (DDP)": [[13, "distributeddataparallel-ddp"]], "Code Sample": [[13, "code-sample"], [18, "code-sample"], [19, "code-sample"]], "How it works ?": [[13, "how-it-works"]], "Implementation": [[13, "implementation"]], "ProcessGroup": [[13, "processgroup"]], "DistributedDataParallel": [[13, "distributeddataparallel"]], "TorchDynamo DDPOptimizer: Overlap communications with compute": [[13, "torchdynamo-ddpoptimizer-overlap-communications-with-compute"]], "Save and Load Checkpoints": [[13, "save-and-load-checkpoints"]], "Combining DDP with Model Parallelism": [[13, "combining-ddp-with-model-parallelism"]], "DDP Communication Hooks": [[13, "ddp-communication-hooks"]], "Initialize DDP with torch.distributed.run/torchrun": [[13, "initialize-ddp-with-torch-distributed-run-torchrun"]], "When is DDP not enough?": [[13, "when-is-ddp-not-enough"]], "DDP on multiple nodes using Torchrun (and optionally Slurm)": [[13, "ddp-on-multiple-nodes-using-torchrun-and-optionally-slurm"]], "Configuration to set up an AWS cluster": [[13, "configuration-to-set-up-an-aws-cluster"]], "Slurm script to launch the training job": [[13, "slurm-script-to-launch-the-training-job"]], "Further Reading": [[13, "further-reading"]], "DP vs DDP": [[14, "dp-vs-ddp"]], "FSDP": [[15, "fsdp"]], "How FSDP Works": [[15, "how-fsdp-works"]], "FSDP VS DDP": [[15, "fsdp-vs-ddp"]], "General": [[16, "general"]], "Pytorch": [[17, "pytorch"]], "Mixed Precision": [[18, "mixed-precision"]], "Gradient Scaling": [[18, "gradient-scaling"]], "CUDA Op-Specific Behavior": [[18, "cuda-op-specific-behavior"]], "Some of the CUDA Ops that can autocast to float16": [[18, "some-of-the-cuda-ops-that-can-autocast-to-float16"]], "Some of the CUDA Ops that can autocast to float32": [[18, "some-of-the-cuda-ops-that-can-autocast-to-float32"]], "Some of the CUDA Ops that promote to the widest input type": [[18, "some-of-the-cuda-ops-that-promote-to-the-widest-input-type"]], "With Default Precision": [[18, "with-default-precision"]], "Adding torch.autocast": [[18, "adding-torch-autocast"]], "Adding GradScaler": [[18, "adding-gradscaler"]], "Typical Automatic Mixed Precision Training": [[18, "typical-automatic-mixed-precision-training"]], "Gradient accumulation with Scaled Gradients": [[18, "gradient-accumulation-with-scaled-gradients"]], "Gradient penalty with Scaled Gradients": [[18, "gradient-penalty-with-scaled-gradients"]], "Troubleshooting": [[18, "troubleshooting"]], "Speedup with Amp is minor": [[18, "speedup-with-amp-is-minor"]], "Loss is inf/NaN": [[18, "loss-is-inf-nan"]], "Pipeline Parallelism": [[19, "pipeline-parallelism"]], "Why Pipeline Parallel?": [[19, "why-pipeline-parallel"]], "What is torch.distributed.pipelining?": [[19, "what-is-torch-distributed-pipelining"]], "Step 1: build PipelineStage": [[19, "step-1-build-pipelinestage"]], "Step 2: use PipelineSchedule for execution": [[19, "step-2-use-pipelineschedule-for-execution"]], "Options for Splitting a Model": [[19, "options-for-splitting-a-model"]], "Option 1: splitting a model manually": [[19, "option-1-splitting-a-model-manually"]], "Option 2: splitting a model automatically": [[19, "option-2-splitting-a-model-automatically"]], "How does the pipeline API split a model?": [[19, "how-does-the-pipeline-api-split-a-model"]], "Implementing Your Own Schedule": [[19, "implementing-your-own-schedule"]], "state_dict": [[20, "state-dict"]], "Tensor parallelism": [[21, "tensor-parallelism"]], "How Tensor Parallel works?": [[21, "how-tensor-parallel-works"]], "When and Why you should apply Tensor Parallel ?": [[21, "when-and-why-you-should-apply-tensor-parallel"]], "How to apply Tensor Parallel ?": [[21, "how-to-apply-tensor-parallel"]], "Tensor Parallelism on Llama2 model": [[21, "tensor-parallelism-on-llama2-model"]], "Feedforward layer": [[21, "feedforward-layer"]], "Attention layer": [[21, "attention-layer"]], "Apply Sequence Parallel to LayerNorm/RMSNorm layers": [[21, "apply-sequence-parallel-to-layernorm-rmsnorm-layers"]], "Apply Loss Parallel": [[21, "apply-loss-parallel"]], "Tensor Parallel with FSDP": [[21, "tensor-parallel-with-fsdp"]], "Domain name system": [[22, "domain-name-system"]], "What is DNS ?": [[22, "what-is-dns"]], "How the DNS domain namespace is organized ?": [[22, "how-the-dns-domain-namespace-is-organized"]], "Types of DNS domain names": [[22, "types-of-dns-domain-names"]], "Record Types": [[22, "record-types"]], "Time-to-Live for resource records": [[22, "time-to-live-for-resource-records"]], "How Does DNS Route Traffic To Your Web Application?": [[22, "how-does-dns-route-traffic-to-your-web-application"]], "Querying the database": [[22, "querying-the-database"]], "Caching before hitting the DNS infrastructure": [[22, "caching-before-hitting-the-dns-infrastructure"]], "Replicating the DNS database": [[22, "replicating-the-dns-database"]], "Who controls the DNS servers?": [[22, "who-controls-the-dns-servers"]], "DHCP ?": [[22, "dhcp"]], "AWS DNS: Route 53 features": [[22, "aws-dns-route-53-features"]], "DNS concepts": [[22, "dns-concepts"]], "Image Segmentation": [[23, "image-segmentation"]], "Computer Vision": [[24, "computer-vision"]]}, "indexentries": {}})